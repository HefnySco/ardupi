define("modules/clean/frame_messenger/frame_messenger_client",["require","exports","tslib","modules/clean/frame_messenger/frame_messenger_base","modules/clean/frame_messenger/frame_messenger_logger"],function(e,t,n,r,o){"use strict";function a(e,t){return t.indexOf(e)>=0}Object.defineProperty(t,"__esModule",{value:!0});var i=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._trustedOriginForPosting=null,t._validActions=[],t._parentMessageQueue=[],t._onParentReady=null,t}return n.__extends(t,e),t.prototype.configureParentMessaging=function(e,t,n){void 0===n&&(n=null),this._trustedOriginForPosting=null,this._validActions=t,this._trustedMessageHandler=e,this._onParentReady=n},t.prototype.startListening=function(){e.prototype.startListening.call(this),this.requestParentOrigin()},t.prototype.postMessageToParent=function(e,t){void 0===t&&(t={});var n=this.packagePostMessage(e,t);null===this._trustedOriginForPosting?this._parentMessageQueue.push(n):this.getWindow().parent.postMessage(n,this._trustedOriginForPosting)},t.prototype.dispatchMessage=function(e,t){o.logFrameMessage("frame_messenger_client",{event:e,messageJson:t}),"parent-ready"===t.action&&this.updateParentOrigin(e.origin),a(t.action,this._validActions)&&null!==this._trustedMessageHandler&&this._trustedMessageHandler(t)},t.prototype.resetOriginsForPosting=function(){this._trustedOriginForPosting=null},t.prototype.updateParentOrigin=function(e){var t=this._trustedOriginForPosting;if(!this.isOriginAllowed(e))return!1;if(this._trustedOriginForPosting=e,this._parentMessageQueue.length>0){for(var n=0;n<this._parentMessageQueue.length;n++){var r=this._parentMessageQueue[n],o=JSON.parse(r);this.postMessageToParent(o.action,o.parameters)}this._parentMessageQueue=[]}return null!=this._trustedOriginForPosting&&null==t&&null!==this._onParentReady&&this._onParentReady(),!0},t.prototype.requestParentOrigin=function(){var e=this;this.getWindow().parent.postMessage('{"action": "child-requesting-parent-origin"}',"*");var n=function(){null===e._trustedOriginForPosting&&e.requestParentOrigin()};this.getWindow().setTimeout(n,t._REQUEST_PARENT_ORIGIN_POLL_DELAY)},t._REQUEST_PARENT_ORIGIN_POLL_DELAY=100,t})(r.FrameMessengerBase);t.FrameMessengerClient=i}),define("modules/clean/react/file_viewer/frame_interface",["require","exports","tslib","modules/clean/react/file_viewer/interface","modules/clean/react/previews/frame_messenger_host","modules/clean/frame_messenger/frame_messenger_logger"],function(e,t,n,r,o,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=["annotation-end-drag","annotation-enter","annotation-hidden","annotation-leave","annotation-placed","annotation-start-drag","annotation-ui-click","annotation-ui-enter","annotation-ui-leave","annotation-ui-over","mouse-up","on-keydown","page-change","page-rendered","scale-change","scroll","doc-metadata-load"],s=(function(e){function t(n){var r=e.call(this,n)||this;return r.handleMessageFromFrame=function(e){r.eventEmitter.emit(e.action,e.parameters)},t.frameMessengerFactory?r.frameMessenger=t.frameMessengerFactory():r.frameMessenger=new o.PreviewFrameMessengerHost,r.frameMessenger.configureChildMessaging('iframe[name="preview-content"]',r.handleMessageFromFrame,i),r.frameMessenger.startListening(),r}return n.__extends(t,e),t.prototype.dispatchEvent=function(e,t){a.logFrameMessage("frame_interface",{eventName:e,data:t}),this.frameMessenger.postMessageToChildren(e,t)},t.prototype.destroy=function(){this.frameMessenger.stopListening()},t.setFrameMessengerFactory=function(e){t.frameMessengerFactory=e},t})(r.FileViewerInterface);t.FileViewerFrameInterface=s}),define("modules/clean/react/file_viewer/interface",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(function(){function e(e){this.eventEmitter=e}return e.prototype.destroy=function(){},e})();t.FileViewerInterface=n}),define("modules/clean/react/file_viewer/sidebar_helpers",["require","exports","modules/clean/react/file_viewer/constants","modules/clean/react/size_class/utils"],function(e,t,n,r){"use strict";function o(e,t,o){return!(r.isSmallerThanLarge(t)||o||e!==n.DocType.ppt&&e!==n.DocType.pdf)}Object.defineProperty(t,"__esModule",{value:!0}),t.isSidebarEnabled=o}),define("modules/clean/react/previews/pdf_viewer/event_emitter",["require","exports","tslib","external/eventemitter3"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r=n.__importDefault(r),t.eventEmitter=new r.default}),define("modules/clean/react/previews/pdf_viewer/font",["require","exports"],function(e,t){"use strict";function n(e){var t=e.n.lastIndexOf(",");return{fontFamily:'"'+(t>-1?e.n.substr(0,t):e.n)+'", '+(1&e.f?"monospace":"serif"),isBold:(e.f&1<<18)>0,isItalic:(64&e.f)>0}}Object.defineProperty(t,"__esModule",{value:!0});t.renderFont=n}),define("modules/clean/react/previews/pdf_viewer/frame_messenger",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FRAME_MESSAGES_FROM_PARENT=["open-file","page-up","page-down","set-current-page","file-feedback-ui-ready","update-annotations","focus-annotation","hover-annotation","enable-annotation-creation","disable-annotation-creation","enable-region-creation","disable-region-creation","zoom-in","zoom-out","print","remove-all-annotations","scroll-to-annotation","clear-annotation-selection","request-doc-metadata","place-default-annotation","hide-annotation"],t.WT_EVENT_PAGE_RENDERED="page-rendered"}),define("modules/clean/react/previews/pdf_viewer/frame_messenger_shims",["require","exports","tslib","external/eventemitter3","modules/clean/frame_messenger/frame_messenger_client","modules/clean/frame_messenger/frame_messenger_host"],function(e,t,n,r,o,a){"use strict";function i(){return{parentEmitter:new r.default,childEmitter:new r.default}}Object.defineProperty(t,"__esModule",{value:!0}),r=n.__importDefault(r);t.makeChannel=i;var s=(function(e){function t(t){var n=e.call(this,[])||this;return n.eventListener=function(e){n.validActions.indexOf(e.action)>-1&&n.handler(e)},n.channel=t,n}return n.__extends(t,e),t.prototype.configureChildMessaging=function(e,t,n){this.handler=t,this.validActions=n},t.prototype.startListening=function(){this.channel.childEmitter.on("message",this.eventListener)},t.prototype.stopListening=function(){this.channel.childEmitter.off("message",this.eventListener)},t.prototype.postMessageToChildren=function(e,t){void 0===t&&(t={}),this.channel.parentEmitter.emit("message",{action:e,parameters:t})},t})(a.FrameMessengerHost);t.FrameMessengerHostShim=s;var l=(function(e){function t(t){var n=e.call(this,[])||this;return n.eventListener=function(e){n.validActions.indexOf(e.action)>-1&&n.handler(e)},n.channel=t,n}return n.__extends(t,e),t.prototype.configureParentMessaging=function(e,t,n){void 0===n&&(n=null),this.validActions=t,this.handler=e},t.prototype.postMessageToParent=function(e,t){void 0===t&&(t={}),this.channel.childEmitter.emit("message",{action:e,parameters:t})},t.prototype.startListening=function(){this.channel.parentEmitter.on("message",this.eventListener)},t.prototype.stopListening=function(){this.channel.parentEmitter.off("message",this.eventListener)},t})(o.FrameMessengerClient);t.FrameMessengerClientShim=l}),define("modules/clean/react/previews/pdf_viewer/keyboard_bindings",["require","exports","modules/clean/react/keyboard_binding/keyboard_binding","modules/clean/keycode"],function(e,t,n,r){"use strict";function o(e){var o=e.pageUp,a=e.pageDown,i=e.zoomIn,s=e.zoomOut,l=e.print;return[n.hydrateKeyboardBinding({keyboardEventCriteria:{altKey:!1,which:r.KeyCode.SPACE},callback:a})].concat(t.getPageUpPageDownKeyboardBindings(o,a),t.getUpDownKeyboardBindings(o,a),t.getLeftRightKeyboardBindings(o,a),n.getEqualsKeyBindings(i),n.getMinusKeyBindings(s),n.getPrintKeyBindings(l))}function a(e){var o=e.isFullScreen,a=e.keyUp,i=e.keyDown,s=e.pageUp,l=e.pageDown,d=e.zoomIn,c=e.zoomOut,u=e.print,p=o?t.getUpDownKeyboardBindings(s,l):t.getUpDownKeyboardBindings(a,i),g=n.hydrateKeyboardBinding({keyboardEventCriteria:{altKey:!0,which:r.KeyCode.UP},callback:s}),m=n.hydrateKeyboardBinding({keyboardEventCriteria:{altKey:!0,which:r.KeyCode.DOWN},callback:l}),f=n.hydrateKeyboardBinding({keyboardEventCriteria:{altKey:!1,which:r.KeyCode.SPACE},callback:l}),h=o?t.getLeftRightKeyboardBindings(s,l).slice():[];return p.concat([g,m,f],t.getPageUpPageDownKeyboardBindings(s,l),h,n.getEqualsKeyBindings(d),n.getMinusKeyBindings(c),n.getPrintKeyBindings(u))}Object.defineProperty(t,"__esModule",{value:!0}),t.getLeftRightKeyboardBindings=function(e,t){return[n.hydrateKeyboardBinding({keyboardEventCriteria:{which:r.KeyCode.LEFT},callback:e}),n.hydrateKeyboardBinding({keyboardEventCriteria:{which:r.KeyCode.RIGHT},callback:t})]},t.getUpDownKeyboardBindings=function(e,t){return[n.hydrateKeyboardBinding({keyboardEventCriteria:{which:r.KeyCode.UP},callback:e}),n.hydrateKeyboardBinding({keyboardEventCriteria:{which:r.KeyCode.DOWN},callback:t})]},t.getPageUpPageDownKeyboardBindings=function(e,t){return[n.hydrateKeyboardBinding({keyboardEventCriteria:{which:r.KeyCode.PAGE_UP},callback:e}),n.hydrateKeyboardBinding({keyboardEventCriteria:{which:r.KeyCode.PAGE_DOWN},callback:t})]},t.getSinglePageKeyboardBindings=o,t.getContinuousPageKeyboardBindings=a}),define("modules/clean/react/previews/pdf_viewer/layers",["require","exports","tslib","react","file-viewer/preview_doc","modules/clean/react/comments2/components/annotations/loadable","modules/clean/referrer_cleansing_redirect","file-viewer/preview_doc","modules/clean/react/watermarking/watermarking_layer","modules/clean/react/workflows/markup/markup_layer"],function(e,t,n,r,o,a,i,s,l,d){"use strict";function c(e){return void 0===e&&(e=[]),e.map(function(e){return e.a&&s.isLinkUrl(e.a)&&!e.a.ur.startsWith("mailto:")?n.__assign({},e,{a:n.__assign({},e.a,{ur:i.get_redirect_uri(o.normalizeUrl(e.a.ur)).toString()})}):e})}Object.defineProperty(t,"__esModule",{value:!0}),r=n.__importDefault(r),i=n.__importStar(i),t._cleanseLinks=c,t.createGenerateLayersFn=function(e,t,i){return function(s){return function(c){var u=s.config.load_image_only,p=s.filePreviewUiData.zoomScaleFactor,g=void 0===p?0:p,m=c.data,f=m.dimension,h=m.pageIndex,v={width:f[0]*g,height:f[1]*g},w=[r.default.createElement("div",{className:"c-loader",key:"loader"})],_=h+1;w.push(r.default.createElement(o.ImgLayer,n.__assign({},s,c,{key:"imgLayer"})));var b=null,P=null;return u||(b=r.default.createElement(o.TextLayer,n.__assign({},s,c,{key:"textLayer"})),P=r.default.createElement(o.LinksLayer,n.__assign({},s,c,{key:"linksLayer"}))),e?w.push(r.default.createElement(a.AnnotationViewLayer,{key:"annotationViewLayer",page:_}),r.default.createElement(a.AnnotationConductorLayer,{key:"annotationConductorLayer",page:_,layerSize:v},r.default.createElement(a.AnnotationInstructionalTooltipPane,{layerSize:v},t&&r.default.createElement(l.WatermarkingLayer,{layerSize:v,pageDimensions:{width:f[0],height:f[1]}}),i&&r.default.createElement(d.MarkupLayer,{page:h,layerSize:v,pageDimensions:{width:f[0],height:f[1]}}),b,P))):(t?w.push(r.default.createElement(l.WatermarkingLayer,{layerSize:v,pageDimensions:{width:f[0],height:f[1]}})):i&&w.push(r.default.createElement(d.MarkupLayer,{page:h,layerSize:v,pageDimensions:{width:f[0],height:f[1]}})),w.push(b,P)),w}}}}),define("modules/clean/react/previews/pdf_viewer/transform",["require","exports","tslib","modules/clean/react/previews/pdf_viewer/font","file-viewer/preview_doc","modules/clean/referrer_cleansing_redirect","modules/core/exception"],function(e,t,n,r,o,a,i){"use strict";function s(e,t,n){return n.map(function(e){return e.coordinates.map(function(e){return{x:e.x,y:t-e.y}})})}function l(e,t,n,r,o,a,i){return i.map(function(i){return{coordinates:i.map(function(e){return{x:(e.x-t)/a,y:o-(e.y-n)/a}}),page:e,page_size:{width:r,height:o}}})}function d(e){try{var t=o.transformText(e);return n.__assign({},t,{str:t.str.map(function(e){if(e.type===o.TextNodeType.link)try{return n.__assign({},e,{href:a.get_redirect_uri(e.text).toString()})}catch(e){}return e})})}catch(e){i.reportException({err:new Error("PDF Text transformation failed"),tags:["pdfPreviews"],severity:i.SEVERITY.NONCRITICAL})}return{dir:o.TextDir.ltr,str:[]}}function c(e){return e&&e.pages?Object.keys(e.pages).reduce(function(t,n){return t[n]=(e.pages[n]||[]).map(function(e){var t=d(e.t);return{d:e.d,t:e.t,r:e.r,h:e.h,rawText:e.t,transformedText:t.str,dir:t.dir,font:r.renderFont(e.font)}}),t},{}):{}}Object.defineProperty(t,"__esModule",{value:!0}),a=n.__importStar(a),i=n.__importStar(i),t.transformPdfCoordinates=s,t.transformViewportCoordinates=l,t.transformPdfgenText=c}),define("modules/clean/react/previews/pdf_viewer/utils",["require","exports"],function(e,t){"use strict";function n(e){if(i===e)return s;var t=[];return e.forEach(function(e){for(var n=e[0],r=e[1],o=e[2],a=0;a<o;a++)t.push([n,r])}),i=e,s=t,t}function r(e,t){for(var r=n(e),o=[],a=0;a<r.length;a++){var i=r[a],s=i[0],l=i[1];o.push(t(a,s,l))}return o}function o(e){(new Image).src=e}function a(e,t){void 0===t&&(t={});var n=e[0],r=e[1],o=t.maxWidth,a=t.maxHeight;if(void 0!==o&&void 0!==a){var i=Math.min(o/n,a/r);return[i*n,i*r]}return void 0!==o?[o,o/n*r]:void 0!==a?[a/r*n,a]:e}Object.defineProperty(t,"__esModule",{value:!0});var i,s;t.expandDimensions=n,t.mapPages=r,t.prefetchImage=o,t.scaleDimension=a}),define("modules/clean/react/previews/pdf_viewer/zoom",["require","exports","modules/clean/previews/util","modules/core/browser_detection"],function(e,t,n,r){"use strict";function o(){return d.FIT_PAGE}function a(e){return n.isPptExtension(e)&&!r.is_mobile_or_tablet()?p.SINGLE_PAGE:p.CONTINUOUS}function i(e,t,n,r){var o=1;if(e===d.FIT_PAGE){for(var a=0,i=0,s=0,l=t;s<l.length;s++){var c=l[s],p=c[0],g=c[1];i=Math.max(p,i),a=Math.max(g,a)}o=Math.min(n/a,r/i)}else e===d.FIT_TO_WIDTH&&(o=r/t[0][0]);return Math.min(o,u)}function s(e,t){return 2048/Math.max(e,t)}function l(e,t){if(t){var n=t.originalHeight;if(s(t.originalWidth,n)>e)return 0}for(var r=0,o=c;r<o.length;r++){var a=o[r];if(a>=e)return a}return u}Object.defineProperty(t,"__esModule",{value:!0});var d,c=[1,2,4],u=Math.max.apply(Math,c);(function(e){e[e.NONE=0]="NONE",e[e.FIT_TO_WIDTH=1]="FIT_TO_WIDTH",e[e.FIT_PAGE=2]="FIT_PAGE"})(d=t.FittingMode||(t.FittingMode={}));var p;(function(e){e[e.CONTINUOUS=0]="CONTINUOUS",e[e.SINGLE_PAGE=1]="SINGLE_PAGE"})(p=t.ScrollMode||(t.ScrollMode={})),t.fullscreenFittingMode=o,t.defaultScrollMode=a,t.computeClientScaleFactor=i,t.calculatedFetchedScaleFactor=l}),define("modules/clean/react/previews/powerpoint/frame_messenger_provider",["require","exports","tslib","react","modules/clean/react/previews/pdf_viewer/frame_messenger_shims","modules/clean/react/file_viewer/frame_interface","modules/clean/react/previews/pdf_viewer/event_emitter"],function(e,t,n,r,o,a,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r=n.__importDefault(r);var s=(function(e){function t(t){var n=e.call(this,t)||this;n.onMessage=function(e){i.eventEmitter.emit(e.action,e.parameters)};var r=n.props,s=r.invalidate,l=r.messages;return n.channel=o.makeChannel(),n.host=new o.FrameMessengerHostShim(n.channel),n.client=new o.FrameMessengerClientShim(n.channel),n.client.configureParentMessaging(n.onMessage,l),n.client.startListening(),a.FileViewerFrameInterface.setFrameMessengerFactory(function(){return new o.FrameMessengerHostShim(n.channel)}),"function"==typeof s&&s(),n}return n.__extends(t,e),t.prototype.componentWillUnmount=function(){this.client.stopListening()},t.prototype.render=function(){return this.props.children(this.client,this.host)},t})(r.default.Component);t.FrameMessengerProvider=s}),define("modules/clean/react/previews/powerpoint/with_frame_messenger",["require","exports","tslib","react","hoist-non-react-statics","modules/clean/react/helpers","modules/clean/react/previews/powerpoint/frame_messenger_provider"],function(e,t,n,r,o,a,i){"use strict";function s(e){return function(t){var s=(function(o){function s(){var e=null!==o&&o.apply(this,arguments)||this;return e.displayName="WithFrameMessenger("+a.getDisplayName(t),e}return n.__extends(s,o),s.prototype.render=function(){var o=this;return r.default.createElement(i.FrameMessengerProvider,{messages:e,invalidate:this.props.invalidateFrameMessenger},function(e,a){return r.default.createElement(t,n.__assign({},o.props,{frameMessengerClient:e,frameMessengerHost:a}))})},s})(r.default.PureComponent);return o.default(s,t)}}Object.defineProperty(t,"__esModule",{value:!0}),r=n.__importDefault(r),o=n.__importDefault(o),t.withFrameMessenger=s}),define("modules/clean/react/previews/preview_pdf",["require","exports","tslib","react","modules/core/i18n","external/lodash","external/lodash","external/react-redux","external/classnames","modules/clean/react/previews/constants","file-viewer/core","modules/clean/react/file_viewer/location_utils","modules/clean/react/file_viewer/constants","modules/clean/react/previews/pdf_viewer/event_emitter","modules/clean/react/size_class/constants","modules/clean/react/file_viewer/data/selectors","modules/clean/previews/data/selectors","modules/clean/previews/data/actions","modules/clean/react/previews/preview_toolbar","modules/clean/web_timing_logger","modules/clean/react/previews/pdf_viewer/transform","modules/clean/react/previews/loading_indicator","modules/clean/react/previews/pdf_viewer/utils","modules/clean/react/file_viewer/sidebar_helpers","modules/clean/react/file_viewer/full_screen_helpers","modules/clean/react/previews/pdf_viewer/zoom","spectrum/dimensions","modules/clean/react/comments2/data/actions","modules/clean/react/comments2/data/selectors","modules/clean/react/keyboard_binding/keyboard_binding_connector","modules/core/browser","modules/clean/react/keyboard_binding/keyboard_binding","modules/clean/react/previews/pdf_viewer/keyboard_bindings","modules/clean/react/previews/pdf_viewer/urls","modules/clean/react/previews/pdf_viewer/frame_messenger","modules/clean/react/previews/powerpoint/with_frame_messenger","file-viewer/preview_doc","file-viewer/strings","file-viewer/core","modules/clean/i18n/formatters","modules/clean/react/previews/pdf_viewer/layers","modules/core/browser_detection","modules/clean/react/file_viewer/data/actions","modules/clean/react/file_viewer/data/actions","modules/clean/react/previews/preview_toolbar_button","file-viewer/toolbar","modules/clean/react/file_viewer/logging","file-viewer/assets-metaserver","modules/clean/react/previews/print_helpers","modules/clean/previews/actions","file-viewer/polyfills"],function(e,t,n,r,o,a,i,s,l,d,c,u,p,g,m,f,h,v,w,_,b,P,y,M,S,T,E,F,D,I,C,A,x,U,O,L,k,N,B,R,W,K,z,G,V,j,Z,H,q,Q){"use strict";function Y(){}function J(e){var t=e.imageUrlTmpl,n=e.useCanned,r=e.docMetadata,o=void 0===r?{}:r,i=o.metadata,s=void 0===i?void 0:i,l=o.text,d=void 0===l?{}:l;if(!s||!d||!s.page_count)return[];var c=y.expandDimensions(s.dimensions),u=b.transformPdfgenText(d);return a.range(0,s.page_count).map(function(e){return{pageIndex:e,dimension:c[e],textboxes:u&&u[e]||[],links:d.links&&d.links[e]||[],thumbnailUrl:U.imageUrl(t,e,0,n),imgUrls:{"1x":U.imageUrl(t,e,0,n),"4x":U.imageUrl(t,e,400,n)}}})}Object.defineProperty(t,"__esModule",{value:!0}),r=n.__importDefault(r),a=n.__importStar(a),l=n.__importDefault(l),_=n.__importStar(_),C=n.__importStar(C),K=n.__importStar(K);var X=F.Actions.setPendingNumberedAnnotationMayBeOffscreen,$=R.createFormatters("en",N.strings,R.createI18nCache()),ee=B.resolveAsset.bind(null,H.assets),te=["pdf"],ne=(function(e){function t(t){var n=e.call(this,t)||this;n.downloadSucceedLogged=!1,n.renderSucceededLogged=!1,n.renderer=null,n.onPageMouseDown=function(e){n.renderer&&n.renderer.updatePageOffset()},n.submitPassword=function(e){n._refreshBlob(e)},n.dismissPassword=function(){n.props.onError&&n.props.onError(d.ErrorType.PasswordProtectedError)},n._refreshBlob=function(e){var t=n.props,r=t.refreshBlobAction,o=t.revisionId,a=n.props,i=a.imageUrlTmpl,s=a.textUrlTmpl,l=a.refreshUrl;"function"==typeof r&&r(o,l||"",{image_url_tmpl:i,text_url_tmpl:s,refresh_url:l},e)},n._onScrollToPage=function(e){n.props.updateCurrentPageIndex(e),n.props.setPendingNumberedAnnotationMayBeOffscreen();var t=50*Math.floor(e/50);t+50-e<15&&(t+=50),n.fetchDataForPage(t)},n.onMetadataLoad=function(e){n.props.frameMessengerClient.postMessageToParent("doc-metadata-load",{metadata:e})},n.logRenderSuccess=function(){n.downloadSucceedLogged||(n.downloadSucceedLogged=!0,n.logFilePreviewEvent(p.EventType.FilePreviewDownloadSucceeded)),n.renderSucceededLogged||(n.renderSucceededLogged=!0,n.logFilePreviewEvent(p.EventType.FilePreviewRenderSucceeded),"function"==typeof n.props.setRenderStatusSuccess&&n.props.setRenderStatusSuccess(),n.props.frameMessengerClient.postMessageToParent(O.WT_EVENT_PAGE_RENDERED)),n.setState({pageRendered:!0})},n.logTTI=function(){_.mark_time_to_view(),_.mark_time_to_interactive(),n.props.filePreviewSession&&n.props.filePreviewSession.markPrimaryEvent()},n.sendIdleMouse=i.debounce(function(){n.props.frameMessengerClient.postMessageToParent("idle-mouse")},1500),n.onMouseMove=i.throttle(function(){n.props.frameMessengerClient.postMessageToParent("active-mouse"),n.sendIdleMouse()},16),n.onToolbarShow=function(){n.setState({isToolbarVisible:!0})},n.onToolbarHide=function(){n.setState({isToolbarVisible:!1})},n.onError=function(e){n.setState({error:e})},n.onImageError=function(){n.setState({error:o._("Some pages failed to load")})},n.onReload=function(){C.reload(!0)},n.handlePageChange=function(e){var t=n.state.currentPageIndex,r=n.props.docMetadata;!r||!r.metadata||e<0||e>=r.metadata.page_count||(n.setState({currentPageIndex:e}),n._onScrollToPage(e),g.eventEmitter.emit("page-set-to",e,t))},n._jumpToPage=function(e){n.renderer&&n.renderer.jumpToPage(e)},n.pageDown=function(){n.renderer&&n.renderer.pageDown()},n.pageUp=function(){n.renderer&&n.renderer.pageUp()},n.scrollDown=function(){n.renderer&&n.renderer.scrollDown()},n.scrollUp=function(){n.renderer&&n.renderer.scrollUp()},n.zoomIn=function(){var e=Math.min(1.1*n.state.scaleFactor,10);n.setState({scaleFactor:e,fittingMode:T.FittingMode.NONE})},n.zoomOut=function(){var e=Math.max(n.state.scaleFactor/1.1,.1);n.setState({scaleFactor:e,fittingMode:T.FittingMode.NONE})},n.jumpToPageWithToolbarLogging=Z.wrapToolbarActionWithLogging(n._jumpToPage,p.UserAction.PageChange),n.handlePageUpWithToolbarLogging=Z.wrapToolbarActionWithLogging(n.pageUp,p.UserAction.PageUp),n.handlePageDownWithToolbarLogging=Z.wrapToolbarActionWithLogging(n.pageDown,p.UserAction.PageDown),n.handleZoomInWithToolbarLogging=Z.wrapToolbarActionWithLogging(n.zoomIn,p.UserAction.ZoomIn),n.handleZoomOutWithToolbarLogging=Z.wrapToolbarActionWithLogging(n.zoomOut,p.UserAction.ZoomOut),n.isPrintable=function(){return q.canPrint(n.props.sharePermission)&&!!n.props.autoprintUrl},n.print=function(e){n.isPrintable()&&n.props.autoprintUrl&&(Q.docPrint(n.props.autoprintUrl),Z.logUserAction(p.UserAction.Print,e))},n.onPageUp=Z.wrapKeyboardActionWithLogging(A.withPreventDefault(n.pageUp),p.UserAction.PageUp),n.onPageDown=Z.wrapKeyboardActionWithLogging(A.withPreventDefault(n.pageDown),p.UserAction.PageDown),n.onScrollUp=Z.wrapKeyboardActionWithLogging(A.withPreventDefault(n.scrollUp),p.UserAction.ScrollUp),n.onScrollDown=Z.wrapKeyboardActionWithLogging(A.withPreventDefault(n.scrollDown),p.UserAction.ScrollDown),n.onZoomIn=Z.wrapKeyboardActionWithLogging(A.withPreventDefault(n.zoomIn),p.UserAction.ZoomIn),n.onZoomOut=Z.wrapKeyboardActionWithLogging(A.withPreventDefault(n.zoomOut),p.UserAction.ZoomOut),n.onPrintKeyPressed=A.withPreventDefault(function(){return n.print(p.UserActionContext.Keyboard)}),n.docFullScreenKeyboardBindings=x.getContinuousPageKeyboardBindings({isFullScreen:!0,keyUp:n.onScrollUp,keyDown:n.onScrollDown,pageUp:n.onPageUp,pageDown:n.onPageDown,zoomIn:n.onZoomIn,zoomOut:n.onZoomOut,print:n.onPrintKeyPressed}),n.docSidebarFocusedKeyboardBindings=x.getContinuousPageKeyboardBindings({isFullScreen:!1,keyUp:n.pageUp,keyDown:n.onPageDown,pageUp:n.onPageUp,pageDown:n.onPageDown,zoomIn:n.onZoomIn,zoomOut:n.onZoomOut,print:n.onPrintKeyPressed}),n.docKeyboardBindings=x.getContinuousPageKeyboardBindings({isFullScreen:!1,keyUp:n.onScrollUp,keyDown:n.onScrollDown,pageUp:n.onPageUp,pageDown:n.onPageDown,zoomIn:n.onZoomIn,zoomOut:n.onZoomOut,print:n.onPrintKeyPressed}),n.getDocKeyboardBindings=function(e){return e?n.docFullScreenKeyboardBindings:n.renderer&&n.renderer.state&&n.renderer.state.isSidebarFocused?n.docSidebarFocusedKeyboardBindings:n.docKeyboardBindings},n.handlePageScroll=function(){n.props.setPendingNumberedAnnotationMayBeOffscreen()},n.renderLayers=function(){return W.createGenerateLayersFn(n.props.annotationAllowed,n.props.isWatermarkingMode,n.props.isMarkupMode)},n.onDismissError=function(){n.setState({error:void 0})};var r=t.isFullscreen?T.fullscreenFittingMode():T.FittingMode.FIT_TO_WIDTH,a={passwordRetryAttempt:0,showPasswordPrompt:!1,fittingMode:r,currentPageIndex:0,isSidebarFocused:!1,scaleFactor:1,pages:[],isToolbarVisible:!1,persistToolbar:!1};return n.logFilePreviewEvent(p.EventType.FilePreviewSupportConfirmed),n.logFilePreviewEvent(p.EventType.FilePreviewDownloadAttempted),t.docMetadata&&t.docMetadata.metadata&&Array.isArray(t.docMetadata.metadata.dimensions)&&t.docMetadata.metadata.dimensions.length&&(a.scaleFactor=t.height&&t.width?T.computeClientScaleFactor(r,t.docMetadata.metadata.dimensions,t.height,t.width-24-16):1,a.pages=J(t)),n.state=a,n}return n.__extends(t,e),Object.defineProperty(t.prototype,"startPage",{get:function(){if(this.props.location){var e=u.getPageQuery(this.props.location);if(e)return e-1}return 0},enumerable:!0,configurable:!0}),t.prototype.adjustWidth=function(e){return e-24-16-(this.isSidebarOpen()?k.SIDEBAR_WIDTH:0)},t.prototype.componentDidMount=function(){var e=this;"function"==typeof this.props.fetchDocMetadata&&this.props.fetchDocMetadata(this.props.revisionId,this.props.textUrlTmpl),this.refreshIntervalId=window.setInterval(function(){e._refreshBlob()},108e5),g.eventEmitter.on("error",this.onError);var t=this.props.docMetadata,n=(void 0===t?{}:t).metadata,r=void 0===n?void 0:n;r&&this.startPage&&this.startPage>=0&&this.startPage<r.page_count&&this._jumpToPage(this.startPage)},t.prototype.componentWillUnmount=function(){g.eventEmitter.off("error",this.onError),window.clearInterval(this.refreshIntervalId),u.updatePageQuery(null),this.props.updateCurrentPageIndex(0)},t.prototype.componentDidUpdate=function(e){var t=e.documentRectangleToMakeVisible,n=e.docMetadata,r=(void 0===n?{}:n).metadata,o=void 0===r?void 0:r,a=this.props,i=a.documentRectangleToMakeVisible,s=a.docMetadata,l=(void 0===s?{}:s).metadata,d=void 0===l?void 0:l,c=a.height,u=a.width;if(i&&t!==i){var p=i.page;if(p!==this.state.currentPageIndex)return void this._jumpToPage(p)}if(!o&&d&&this.startPage&&this.startPage>=0&&this.startPage<d.page_count&&this._jumpToPage(this.startPage),e.isFullscreen!==this.props.isFullscreen){var g=e.isFullscreen?T.FittingMode.FIT_TO_WIDTH:T.FittingMode.FIT_PAGE;this.setState({fittingMode:g})}var m=this.isSidebarOpen(),f=this.isSidebarOpen(e);this.state.fittingMode!==T.FittingMode.NONE&&(e.height!==this.props.height||e.width!==this.props.width||m!==f)&&d&&Array.isArray(d.dimensions)&&d.dimensions.length&&this.setState({scaleFactor:T.computeClientScaleFactor(this.state.fittingMode,d.dimensions,c,this.adjustWidth(u))}),this.props.isEditMode&&!e.isEditMode&&d&&this.setState({fittingMode:T.FittingMode.FIT_PAGE,scaleFactor:T.computeClientScaleFactor(T.FittingMode.FIT_PAGE,d.dimensions,c,this.adjustWidth(u))}),!this.props.isEditMode&&e.isEditMode&&d&&this.setState({fittingMode:T.FittingMode.FIT_TO_WIDTH,scaleFactor:T.computeClientScaleFactor(T.FittingMode.FIT_TO_WIDTH,d.dimensions,c,this.adjustWidth(u))})},t.prototype.componentWillReceiveProps=function(e){var t=e.docMetadata,n=e.revisionId,r=e.fileExtension,o=e.isVirtualPreview,a=e.onLoad,i=e.textUrlTmpl,s=e.fetchDocMetadata,l=this.props,d=l.isVirtualPreview,u=l.revisionId,g=l.docMetadata,m=l.textUrlTmpl,f=this.state.fittingMode;if(this.props.isFullscreen!==e.isFullscreen&&(f=e.isFullscreen?T.fullscreenFittingMode():T.FittingMode.FIT_TO_WIDTH,this.setState({fittingMode:f})),n!==u||i!==m||o!==d)this.logFilePreviewEvent(p.EventType.FilePreviewSupportConfirmed),this.logFilePreviewEvent(p.EventType.FilePreviewDownloadAttempted),this.setState({pageRendered:!1,passwordRetryAttempt:0,showPasswordPrompt:!1}),this.downloadSucceedLogged=!1,this.renderSucceededLogged=!1,"function"==typeof s&&s(n,i);else if(t&&t!==g){var h=t.error,v=t.metadata;!h||g&&h===g.error?v?(g&&v===g.metadata||(v.page_count?g&&g.metadata||this.handleMetadataLoad(t,a):this.handleError(c.RivieraStatus.Unknown)),this.setState({pages:J(e)})):this.handleError(c.RivieraStatus.Unknown,r):this.handleError(h.statusCode,r)}},t.prototype.logFilePreviewEvent=function(e,t){void 0===t&&(t={}),this.props.filePreviewSession&&this.props.filePreviewSession.recordEvent(e,t)},t.prototype.handleError=function(e,t){var n=this.props.onError;e===c.RivieraStatus.PasswordProtected?t&&te.includes(t)?this.setState({showPasswordPrompt:!0,passwordRetryAttempt:this.state.passwordRetryAttempt+1}):"function"==typeof n&&n(d.ErrorType.PasswordProtectedError,e):(this.logFilePreviewEvent(p.EventType.FilePreviewDownloadFailed,{rivieraStatusCode:e?e.toString():""}),"function"==typeof n&&n(d.ErrorType.LoadError,e))},t.prototype.handleMetadataLoad=function(e,t){e&&(this.onMetadataLoad(e.metadata),"function"==typeof t&&t(),this.setState({showPasswordPrompt:!1}))},t.prototype.fetchDataForPage=function(e){if(e%50!==0)throw new Error("invalid page lower bound "+e);var t=this.props,n=t.revisionId,r=t.textUrlTmpl,o=t.docMetadata,a=t.fetchDataForPageAction;if("function"==typeof a){if(o){var i=o.metadata,s=o.text;if(i&&i.page_count<=e)return;if(s&&s.pages&&s.pages[e])return}a(n,r,e,e+50)}},t.prototype.isSidebarOpen=function(e){void 0===e&&(e=this.props);var t=e.isSidebarOpen,n=e.sizeClass,r=e.isFullscreen;return!(!M.isSidebarEnabled(p.DocType.pdf,n,!!r)||!(t||{})[p.DocType.pdf])},t.prototype.renderCloseFullscreenButton=function(){return this.props.isFullscreen?r.default.createElement("div",{className:"close-x"},r.default.createElement("button",{onClick:this.props.onExitFullscreen,className:"close-x-button","aria-label":o._("Close")},"✕")):null},t.prototype.render=function(){var e=this,t=this.props,n=t.currentMode,a=t.docMetadata,i=t.height,s=t.isArchiveFile,d=t.isEditMode,u=t.isFullscreen,g=t.isSidebarOpen,f=t.isVirtualPreview,h=t.onSidebarClose,v=t.onSidebarOpen,_=t.previewMetadata,b=t.revisionId,y=t.sharePermission,T=t.sizeClass,E=t.width,F=this.state,D=F.scaleFactor,C=F.pages,A=F.currentPageIndex,x=F.pageRendered,U=F.passwordRetryAttempt,O=F.showPasswordPrompt,L=F.isToolbarVisible,N=F.error,B=a&&a.metadata&&a.metadata.page_count||0,R=this.renderCloseFullscreenButton(),W={"viewer-container":!0,"sidebar-visible":this.isSidebarOpen()},z=x?null:r.default.createElement(P.LoadingIndicator,{className:"loading-indicator"});return r.default.createElement("div",{className:"preview-content preview-pdf preview-pdf-ssr",onMouseMove:this.onMouseMove,onTouchStart:this.onMouseMove,onTouchMove:this.onMouseMove},O?r.default.createElement(k.PasswordModal,{className:"file-viewer-modal-overlay",intl:$,onSubmit:this.submitPassword,onDismiss:this.dismissPassword,enteredWrongPassword:U>1,onComponentDidMount:this.logTTI}):null,r.default.createElement("div",{className:l.default(W)},z,r.default.createElement(I.KeyboardBindingConnector,{keyboardBindings:this.getDocKeyboardBindings(!!this.props.isFullscreen)}),R,r.default.createElement(k.PreviewPDF,{fileMetadata:{file_id:b+(f?"-virtual":""),file_name:""},fileInfo:{file_id:b+(f?"-virtual":""),ns_id:0,sj_id:0,bootstrapped:!0},filePreviewUiData:{currentPageIndex:A,zoomScaleFactor:D,fitScaleFactor:0,isSidebarOpen:!1},coreFileViewerUiData:{isDocSidebarOpen:this.isSidebarOpen()},
fileViewerId:"",previewMetadata:_,className:l.default("pdf-viewer",{fullscreen:this.props.isFullscreen}),intl:$,height:i,isEditMode:d,currentMode:n,onPageChange:this.handlePageChange,onInteractive:this.logTTI,onPageImageError:this.onImageError,onRenderFailed:Y,onRenderSucceeded:this.logRenderSuccess,onMouseDown:this.onPageMouseDown,onScroll:this.handlePageScroll,pageClassName:"page",data:C,config:c.DEFAULT_CONFIG,pagesClassName:l.default("viewer-container__sizer","page-container","pdf-viewer__pages",{"ios-enable-inertial-scroll":K.iOS}),ref:function(t){return e.renderer=t},width:E,dispatch:Y,layerRenderFn:this.renderLayers(),resolveAsset:ee}),N?r.default.createElement(k.ErrorSnackbar,{intl:$,className:L?"pdf-snackbar__toolbar-visible":"",error:N,onSubmit:this.onReload,onCancel:this.onDismissError}):null),a&&a.metadata&&a.metadata.page_count>0?r.default.createElement(w.PreviewToolbar,{isFullscreen:!!u,onToolbarShow:this.onToolbarShow,onToolbarHide:this.onToolbarHide,stayVisible:this.state.persistToolbar},M.isSidebarEnabled(p.DocType.pdf,T,!!u)?r.default.createElement(j.SidebarToggleButton,{className:"toolbar-button-entry",intl:$,isSidebarOpen:g&&!!g[p.DocType.pdf],onSidebarOpen:function(){return v(p.DocType.pdf,p.UserActionContext.Toolbar)},onSidebarClose:function(){return h(p.DocType.pdf,p.UserActionContext.Toolbar)}}):null,T!==m.SizeClass.Small?r.default.createElement(V.PreviewToolbarButton,{disabled:A<=0,spriteGroup:"web",spriteName:"up",tooltip:o._("Page up"),onClick:this.handlePageUpWithToolbarLogging}):null,r.default.createElement(j.PageIndicator,{className:"toolbar-button-entry",currentPageIndex:A||0,intl:$,id:"preview-toolbar-page-indicator",onBlur:function(){return e.setState({persistToolbar:!1})},onFocus:function(){return e.setState({persistToolbar:!0})},onPageNumberUpdated:this.jumpToPageWithToolbarLogging,pageCount:B||1,shouldShowPageCount:T!==m.SizeClass.Small}),T!==m.SizeClass.Small?r.default.createElement(V.PreviewToolbarButton,{disabled:A>=B-1,spriteGroup:"web",spriteName:"down",tooltip:o._("Page down"),onClick:this.handlePageDownWithToolbarLogging}):null,T===m.SizeClass.Small||d?null:[r.default.createElement(j.ZoomOutButton,{className:"toolbar-button-entry",disabled:D<=.1,intl:$,onClick:this.handleZoomOutWithToolbarLogging}),r.default.createElement(j.ZoomInButton,{className:"toolbar-button-entry",disabled:D>=10,intl:$,onClick:this.handleZoomInWithToolbarLogging}),r.default.createElement(j.FullScreenButton,{className:"toolbar-button-entry",intl:$,onClick:function(){return S.toggleFullScreen(!!u,p.UserActionContext.Toolbar)}}),s?null:r.default.createElement(V.PreviewToolbarButton,{"data-test":"print",disabled:!this.isPrintable(),spriteGroup:"web",spriteName:"print",tooltip:q.getPrintTooltip(y),onClick:function(){return e.print(p.UserActionContext.Toolbar)}})]):null)},t})(r.default.PureComponent);t._PreviewPDF=ne;var re=function(e,t){return{docMetadata:h.getDocMetadataByRevisionId(e,t.revisionId),isSidebarOpen:f.getIsSidebarOpen(e),documentRectangleToMakeVisible:D.getDocumentRectangleToMakeVisibleIfComments2Ready(e),previewMetadata:h.getApiDataForRevisionId(e,t.revisionId),isVirtualPreview:h.getIsVirtualRevisionId(e,t.revisionId),annotationAllowed:f.getAnnotationAllowed(e),isWatermarkingMode:f.getIsWatermarkingMode(e),isMarkupMode:f.getIsMarkupMode(e),isEditMode:f.getIsEditMode(e)}},oe={refreshBlobAction:v.refreshBlobAction,fetchDocMetadata:v.fetchDocMetadata,fetchDataForPageAction:v.fetchDataForPage,updateCurrentPageIndex:z.updateCurrentPageIndex,setPendingNumberedAnnotationMayBeOffscreen:X,onSidebarOpen:G.openSidebar,onSidebarClose:G.closeSidebar},ae=i.flow([L.withFrameMessenger(O.FRAME_MESSAGES_FROM_PARENT),s.connect(re,oe)])(ne),ie=function(e){return r.default.createElement(E.Dimensions,{className:"flex-preview-container"},function(t){var o=t.width,a=t.height;return r.default.createElement(ae,n.__assign({},e,{width:o,height:a}))})};t.PreviewPDF=ie}),define("modules/clean/react/previews/preview_ppt",["require","exports","tslib","react","external/classnames","modules/core/i18n","external/lodash","external/react-redux","file-viewer/core","modules/clean/react/file_viewer/constants","modules/clean/react/size_class/constants","modules/clean/react/keyboard_binding/keyboard_binding_connector","modules/clean/react/previews/loading_indicator","modules/clean/react/keyboard_binding/keyboard_binding","modules/clean/react/file_viewer/data/selectors","modules/clean/react/previews/preview_toolbar","modules/clean/react/file_viewer/location_utils","modules/clean/react/previews/pdf_viewer/utils","modules/clean/react/previews/pdf_viewer/transform","modules/clean/react/previews/pdf_viewer/urls","modules/clean/react/previews/pdf_viewer/keyboard_bindings","file-viewer/preview_doc","modules/clean/react/previews/powerpoint/close_button","modules/clean/react/previews/pdf_viewer/event_emitter","modules/clean/react/file_viewer/full_screen_helpers","modules/clean/react/previews/powerpoint/with_frame_messenger","modules/clean/web_timing_logger","modules/clean/react/previews/powerpoint/with_document_metadata","modules/core/browser","modules/clean/react/previews/pdf_viewer/frame_messenger","file-viewer/strings","modules/clean/react/comments2/data/actions","modules/clean/react/comments2/data/selectors","modules/clean/react/previews/pdf_viewer/layers","file-viewer/core","spectrum/dimensions","modules/clean/react/file_viewer/data/actions","modules/clean/i18n/formatters","modules/clean/previews/data/selectors","modules/clean/react/file_viewer/sidebar_helpers","modules/clean/react/file_viewer/data/actions","modules/clean/react/previews/preview_toolbar_button","file-viewer/toolbar","modules/clean/react/file_viewer/logging","file-viewer/assets-metaserver","modules/clean/react/previews/print_helpers","modules/clean/previews/actions","file-viewer/polyfills"],function(e,t,n,r,o,a,i,s,l,d,c,u,p,g,m,f,h,v,w,_,b,P,y,M,S,T,E,F,D,I,C,A,x,U,O,L,k,N,B,R,W,K,z,G,V,j,Z){"use strict";function H(){}Object.defineProperty(t,"__esModule",{value:!0}),r=n.__importDefault(r),o=n.__importDefault(o),E=n.__importStar(E),D=n.__importStar(D);var q=A.Actions.setPendingNumberedAnnotationMayBeOffscreen,Q=N.createFormatters("en",C.strings,N.createI18nCache()),Y=l.resolveAsset.bind(null,V.assets),J=(function(e){function t(t){var n=e.call(this,t)||this;return n.downloadSucceedLogged=!1,n.renderSucceededLogged=!1,n.state={isSidebarFocused:!1,clientScaleFactor:0,showSidebar:!0,persistToolbar:!1},n.renderer=null,n.onPageMouseDown=function(e){n.renderer&&n.renderer.updatePageOffset()},n.sendIdleMouse=i.debounce(function(){n.props.frameMessengerClient.postMessageToParent("idle-mouse")},1500),n.onMouseMove=i.throttle(function(){n.props.frameMessengerClient.postMessageToParent("active-mouse"),n.sendIdleMouse()},16),n.reload=function(){D.reload(!0)},n.dismissError=function(){n.setState({error:void 0})},n.setPage=function(e,t,r){var o=(void 0===r?n.props:r).docMetadata;o&&o.metadata&&(e<0||e>=o.metadata.page_count||(n.onPageChange(e),n.props.updateCurrentPageIndex(e)))},n.logRenderSuccess=function(){n.downloadSucceedLogged||(n.downloadSucceedLogged=!0,n.logFilePreviewEvent(d.EventType.FilePreviewDownloadSucceeded)),n.setState({pageRendered:!0}),n.renderSucceededLogged||(n.renderSucceededLogged=!0,n.logFilePreviewEvent(d.EventType.FilePreviewRenderSucceeded),"function"==typeof n.props.setRenderStatusSuccess&&n.props.setRenderStatusSuccess(),n.props.frameMessengerClient.postMessageToParent(I.WT_EVENT_PAGE_RENDERED))},n.onPageChange=function(e){var t=n.props,r=t.onPageChange,o=t.setPendingNumberedAnnotationMayBeOffscreen;r&&r(e),o()},n.logTTI=function(){E.mark_time_to_view(),E.mark_time_to_interactive();var e=n.props.filePreviewSession;e&&e.markPrimaryEvent()},n.pageDown=function(){var e=n.props;e.currentPageIndex<e.docMetadata.metadata.page_count-1&&n.props.pageDown()},n.pageUp=function(){n.props.currentPageIndex>0&&n.props.pageUp()},n.updateCurrentPageIndexWithToolbarLogging=G.wrapToolbarActionWithLogging(function(e){n.props.updateCurrentPageIndex(e)},d.UserAction.PageChange),n.handlePageUpWithToolbarLogging=G.wrapToolbarActionWithLogging(n.pageUp,d.UserAction.PageUp),n.handlePageDownWithToolbarLogging=G.wrapToolbarActionWithLogging(n.pageDown,d.UserAction.PageDown),n.onError=function(e){n.setState({error:e})},n.onToolbarShow=function(){n.setState({isToolbarVisible:!0})},n.onToolbarHide=function(){n.setState({isToolbarVisible:!1})},n.setupToolbar=function(){M.eventEmitter.on("error",n.onError)},n.teardownToolbar=function(){M.eventEmitter.off("error",n.onError)},n.zoomIn=function(){if(!n.props.isFullscreen){var e=Math.min(1.1*n.state.clientScaleFactor,10);n.setState({clientScaleFactor:e})}},n.zoomOut=function(){if(!n.props.isFullscreen){var e=Math.max(n.state.clientScaleFactor/1.1,.1);n.setState({clientScaleFactor:e})}},n.handleZoomInWithToolbarLogging=G.wrapToolbarActionWithLogging(n.zoomIn,d.UserAction.ZoomIn),n.handleZoomOutWithToolbarLogging=G.wrapToolbarActionWithLogging(n.zoomOut,d.UserAction.ZoomOut),n.isPrintable=function(){return j.canPrint(n.props.sharePermission)&&!!n.props.autoprintUrl},n.print=function(e){n.isPrintable()&&n.props.autoprintUrl&&(Z.docPrint(n.props.autoprintUrl),G.logUserAction(d.UserAction.Print,e))},n.onPageUp=G.wrapKeyboardActionWithLogging(g.withPreventDefault(n.pageUp),d.UserAction.PageUp),n.onPageDown=G.wrapKeyboardActionWithLogging(g.withPreventDefault(n.pageDown),d.UserAction.PageDown),n.onZoomIn=G.wrapKeyboardActionWithLogging(g.withPreventDefault(n.zoomIn),d.UserAction.ZoomIn),n.onZoomOut=G.wrapKeyboardActionWithLogging(g.withPreventDefault(n.zoomOut),d.UserAction.ZoomOut),n.onPrintKeyPressed=g.withPreventDefault(function(){return n.print(d.UserActionContext.Keyboard)}),n.getPages=function(){var e=n.props,t=e.docMetadata,r=void 0===t?{}:t,o=r.metadata,a=void 0===o?void 0:o,s=r.text,l=void 0===s?{}:s,d=e.imageUrlTmpl,c=e.useCanned;if(!a||!l||!a.page_count)return[];var u=v.expandDimensions(a.dimensions),p=w.transformPdfgenText(l);return i.range(0,a.page_count).map(function(e){return{pageIndex:e,dimension:u[e]||[0,0],textboxes:p[e]||[],links:l.links&&l.links[e]||[],thumbnailUrl:_.imageUrl(d,e,0,c),imgUrls:{"1x":_.imageUrl(d,e,0,c),"4x":_.imageUrl(d,e,400,c)}}})},n.renderLayers=function(){return U.createGenerateLayersFn(n.props.annotationAllowed,!1,!1)},n.logFilePreviewEvent(d.EventType.FilePreviewSupportConfirmed),t.docMetadata&&t.docMetadata.metadata&&n.logFilePreviewEvent(d.EventType.FilePreviewDownloadAttempted),n}return n.__extends(t,e),t.prototype.logFilePreviewEvent=function(e,t){void 0===t&&(t={});var n=this.props.filePreviewSession;n&&n.recordEvent(e,t)},t.prototype.componentDidMount=function(){this.logFilePreviewEvent(d.EventType.FilePreviewDownloadAttempted),this.setupToolbar();var e=this.props,t=e.docMetadata,n=e.startPage;t&&t.metadata&&n&&n>=0&&n<t.metadata.page_count&&this.setPage(n,l.UserActionContext.DocReset)},t.prototype.componentWillReceiveProps=function(e){var t=e.sizeClass,n=e.isFullscreen,r=e.isSidebarOpen,o=e.activatedAnnotationRectangle,a=e.docMetadata,i=R.isSidebarEnabled(d.DocType.ppt,t,!!n)&&!!(r||{})[d.DocType.ppt];if(this.setState({showSidebar:i}),o&&this.props.activatedAnnotationRectangle!==o&&this.setPage(o.page,l.UserActionContext.DocReset,e),a&&!a.error&&a.metadata){var s=a.metadata.dimensions;if(e.height!==this.props.height||e.width!==this.props.width||a!==this.props.docMetadata){var c=O.calculateFitBox(e.width-(r?P.SIDEBAR_WIDTH:0)-32,e.height,s[0][0]/s[0][1])[0];this.setState({clientScaleFactor:c/s[0][0]})}}},t.prototype.componentDidUpdate=function(e){e.currentPageIndex!==this.props.currentPageIndex&&this.onPageChange(this.props.currentPageIndex)},t.prototype.componentWillUnmount=function(){this.teardownToolbar(),h.updatePageQuery(null),this.props.updateCurrentPageIndex(0)},t.prototype.render=function(){var e=this,t=this.props,n=t.docMetadata,i=t.isArchiveFile,s=t.isFullscreen,g=t.isSidebarOpen,m=t.onExitFullscreen,h=t.sharePermission,v=t.sizeClass,w=t.revisionId,_=t.width,M=t.height,T=t.currentMode,E=t.currentPageIndex,F=t.onSidebarClose,D=t.onSidebarOpen,I=t.previewMetadata,C=this.state,A=C.clientScaleFactor,x=C.showSidebar,U=C.error,O=C.isToolbarVisible,L=C.pageRendered;if(!n||!n.metadata)return null;var k=n.metadata,N=k&&k.page_count>0,B=b.getSinglePageKeyboardBindings({pageUp:this.onPageUp,pageDown:this.onPageDown,zoomIn:this.onZoomIn,zoomOut:this.onZoomOut,print:this.onPrintKeyPressed}),W=this.getPages(),G=null!=g&&!!g[d.DocType.ppt];return r.default.createElement("div",{className:"preview-content preview-pdf preview-pdf-ssr",onMouseMove:this.onMouseMove,onTouchStart:this.onMouseMove,onTouchMove:this.onMouseMove},r.default.createElement("div",{className:o.default({"viewer-container":!0,"sidebar-visible":x})},L?null:r.default.createElement(p.LoadingIndicator,{className:"loading-indicator"}),s?r.default.createElement(y.CloseButton,{onClick:m}):null,r.default.createElement(u.KeyboardBindingConnector,{keyboardBindings:B}),r.default.createElement(P.PreviewPPT,{fileMetadata:{file_id:w,file_name:""},fileInfo:{file_id:w,ns_id:0,sj_id:0,bootstrapped:!0},filePreviewUiData:{zoomScaleFactor:A,currentPageIndex:E,fitScaleFactor:0,isSidebarOpen:!1},coreFileViewerUiData:{isDocSidebarOpen:G},currentMode:T,previewMetadata:I,fileViewerId:"",className:"pdf-viewer",pageClassName:"page",ref:function(t){return e.renderer=t},data:W,intl:Q,onPageMouseDown:this.onPageMouseDown,onInteractive:this.logTTI,onRenderFailed:H,onRenderSucceeded:this.logRenderSuccess,onPageChange:this.setPage,width:_,height:M,dispatch:H,layerRenderFn:this.renderLayers(),config:l.DEFAULT_CONFIG,resolveAsset:Y}),N?r.default.createElement(f.PreviewToolbar,{isFullscreen:s,onToolbarShow:this.onToolbarShow,onToolbarHide:this.onToolbarHide,stayVisible:this.state.persistToolbar},R.isSidebarEnabled(d.DocType.ppt,v,!!s)?r.default.createElement(z.SidebarToggleButton,{className:"toolbar-button-entry",intl:Q,isSidebarOpen:G,onSidebarOpen:function(){return D(d.DocType.ppt,d.UserActionContext.Toolbar)},onSidebarClose:function(){return F(d.DocType.ppt,d.UserActionContext.Toolbar)}}):null,v!==c.SizeClass.Small?r.default.createElement(K.PreviewToolbarButton,{disabled:E<=0,spriteGroup:"web",spriteName:"up",tooltip:a._("Previous slide"),onClick:this.handlePageUpWithToolbarLogging}):null,r.default.createElement(z.PageIndicator,{className:"toolbar-button-entry",currentPageIndex:E||0,intl:Q,id:"preview-toolbar-page-indicator",onBlur:function(){return e.setState({persistToolbar:!1})},onFocus:function(){return e.setState({persistToolbar:!0})},onPageNumberUpdated:this.updateCurrentPageIndexWithToolbarLogging,pageCount:W.length||1,shouldShowPageCount:v!==c.SizeClass.Small}),v!==c.SizeClass.Small?[r.default.createElement(K.PreviewToolbarButton,{disabled:E>=W.length-1,spriteGroup:"web",spriteName:"down",tooltip:a._("Next slide"),onClick:this.handlePageDownWithToolbarLogging}),r.default.createElement(z.ZoomOutButton,{className:"toolbar-button-entry",disabled:A<=.1,intl:Q,onClick:this.handleZoomOutWithToolbarLogging}),r.default.createElement(z.ZoomInButton,{className:"toolbar-button-entry",disabled:A>=10,intl:Q,onClick:this.handleZoomInWithToolbarLogging}),r.default.createElement(z.FullScreenButton,{className:"toolbar-button-entry",intl:Q,onClick:function(){return S.toggleFullScreen(!!s,d.UserActionContext.Toolbar)}}),i?null:r.default.createElement(K.PreviewToolbarButton,{"data-test":"print",disabled:!this.isPrintable(),spriteGroup:"web",spriteName:"print",tooltip:j.getPrintTooltip(h),onClick:function(){return e.print(d.UserActionContext.Toolbar)}})]:null):null,U?r.default.createElement(P.ErrorSnackbar,{intl:Q,className:O?"pdf-snackbar__toolbar-visible":"",error:U,onSubmit:this.reload,onCancel:this.dismissError}):null))},t})(r.default.PureComponent);t._PreviewPPT=J;var X=function(e,t){return{activatedAnnotationRectangle:x.getDocumentRectangleToMakeVisibleIfComments2Ready(e),currentPageIndex:m.getCurrentPageIndex(e)||0,isSidebarOpen:m.getIsSidebarOpen(e),previewMetadata:B.getApiDataForRevisionId(e,t.revisionId),annotationAllowed:m.getAnnotationAllowed(e)}},$={pageDown:k.pageDown,pageUp:k.pageUp,updateCurrentPageIndex:k.updateCurrentPageIndex,setPendingNumberedAnnotationMayBeOffscreen:q,onSidebarOpen:W.openSidebar,onSidebarClose:W.closeSidebar},ee=i.flow([F.withDocumentMetadata,T.withFrameMessenger(I.FRAME_MESSAGES_FROM_PARENT),s.connect(X,$)])(J),te=function(e){return r.default.createElement(L.Dimensions,{className:"flex-preview-container"},function(t){var o=t.width,a=t.height;return r.default.createElement(ee,n.__assign({},e,{width:o,height:a}))})};t.PreviewPPT=te});
//# sourceMappingURL=pkg-file_viewer_pdf.min.js-vflDqEY26.map