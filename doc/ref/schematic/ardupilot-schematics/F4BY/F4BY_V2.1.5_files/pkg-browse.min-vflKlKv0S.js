define("comments2/components/folder_overview_utils/description_utils",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isEmptyDescription=function(e){return!e||(0===e.blocks.length||!(e.blocks.length>1)&&("unstyled"===e.blocks[0].type&&0===e.blocks.map(function(e){return e.text}).join("\n").replace(/%u200B/g,"").trim().length))}}),define("comments2/components/folder_overview_utils",["require","exports","comments2/components/folder_overview_utils/description_utils"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isEmptyDescription=r.isEmptyDescription}),define("comments2/l10n",["require","exports"],function(e,t){"use strict";function r(e,t){var r=Date.now()-e.getTime();return r>31536e6?t.formatMessage({id:"1MIdr",defaultMessage:"{number, plural, one {# year ago} other {# years ago}}"},{number:r/31536e6|0}):r>2592e6?t.formatMessage({id:"34Osr",defaultMessage:"{number, plural, one {# month ago} other {# months ago}}"},{number:r/2592e6|0}):r>6048e5?t.formatMessage({id:"1B6qQ",defaultMessage:"{number, plural, one {# week ago} other {# weeks ago}}"},{number:r/6048e5|0}):r>864e5?t.formatMessage({id:"2iioX",defaultMessage:"{number, plural, one {# day ago} other {# days ago}}"},{number:r/864e5|0}):r>36e5?t.formatMessage({id:"1yEvs",defaultMessage:"{number, plural, one {# hour ago} other {# hours ago}}"},{number:r/36e5|0}):r>6e4?t.formatMessage({id:"1L0GZ",defaultMessage:"{number, plural, one {# min ago} other {# mins ago}}"},{number:r/6e4|0}):t.formatMessage({id:"2cOfN",defaultMessage:"Just now"})}function o(e){var t=e.formatDateTime;return{mentionMsg:e.formatMessage({id:"1HPSR",defaultMessage:"@mention someone to share this file"}),mentionButtonLabel:e.formatMessage({id:"zdkp-",defaultMessage:"@mention someone"}),searchingMsg:e.formatMessage({id:"hH4zI",defaultMessage:"Searching contacts…"}),noUsersFoundMsg:e.formatMessage({id:"33XxC",defaultMessage:"No Users Found"}),inviteMsg:function(t){return e.formatMessage({id:"1EHcH",defaultMessage:"Invite {user_name}"},{user_name:t})},editPostLabel:e.formatMessage({id:"3BKNX",defaultMessage:"Save"}),editCancelLabel:e.formatMessage({id:"2Jfhd",defaultMessage:"Cancel"}),commentDeletedMsg:e.formatMessage({id:"ioyQ2",defaultMessage:"This comment was deleted."}),commentEditLabel:e.formatMessage({id:"1bMft",defaultMessage:"Edit"}),commentDeleteLabel:e.formatMessage({id:"1ddoD",defaultMessage:"Delete"}),markAsReadLabel:e.formatMessage({id:"1g51C",defaultMessage:"Mark as read"}),markAsUnreadLabel:e.formatMessage({id:"3RQUH",defaultMessage:"Mark as unread"}),markedAsResolvedLabel:e.formatMessage({id:"1Xu7U",defaultMessage:"Marked as resolved"}),olderVersionLabel:e.formatMessage({id:"124aN",defaultMessage:"On older version"}),replyHintLabel:e.formatMessage({id:"2Wm7z",defaultMessage:"Reply…"}),streamEditorPlaceholder:e.formatMessage({id:"2enZ9",defaultMessage:"Comment"}),streamPostLabel:e.formatMessage({id:"3R968",defaultMessage:"Post"}),streamCancelLabel:e.formatMessage({id:"2Jfhd",defaultMessage:"Cancel"}),threadRestoreLabel:e.formatMessage({id:"SvXtJ",defaultMessage:"Restore"}),threadResolveLabel:e.formatMessage({id:"1hWLR",defaultMessage:"Resolve"}),threadPostLabel:e.formatMessage({id:"3R968",defaultMessage:"Post"}),threadCancelLabel:e.formatMessage({id:"2Jfhd",defaultMessage:"Cancel"}),threadEditorPlaceholder:e.formatMessage({id:"1LPWG",defaultMessage:"Reply"}),viewHistoryLabel:e.formatMessage({id:"15HlI",defaultMessage:"View version history"}),pageLabel:function(t){return e.formatMessage({id:"5iv8V",defaultMessage:"Page {page}"},{page:t})},threadCollapsedCommentsText:function(t){return e.formatMessage({id:"DbGm_",defaultMessage:"{count} comments"},{count:t})},unreadComments:function(t){return e.formatMessage({id:"JkeVi",defaultMessage:"{count} unread"},{count:t})},ago:function(t){return r(t,e)},niceDateWithMonthName:function(e,r){return t(e,{year:r?"numeric":void 0,day:"numeric",month:"short"})},a11yCommentThreadLabel:e.formatMessage({id:"2diM1",defaultMessage:"Comment thread"}),a11yUnreadCommentThreadLabel:e.formatMessage({id:"sHIhB",defaultMessage:"Unread comment thread"}),a11yPrevStickerSet:e.formatMessage({id:"BOghH",defaultMessage:"Previous sticker set"}),a11yNextStickerSet:e.formatMessage({id:"2-vdP",defaultMessage:"Next sticker set"}),a11yStickerMenu:e.formatMessage({id:"UaYQ_",defaultMessage:"Sticker menu"}),a11yStickerAltText:function(t){return e.formatMessage({id:"3WMDi",defaultMessage:"Sticker: {description}"},{description:t})},a11ySelectStickerSet:function(t){return e.formatMessage({id:"1O7Rw",defaultMessage:"Select {description}"},{description:t})},a11yInsertSticker:function(t){return e.formatMessage({id:"uEtdY",defaultMessage:"Insert {description}"},{description:t})},markedAsResolvedByUserLabel:function(t){return e.formatMessage({id:"dzqht",defaultMessage:"Marked as resolved by {name}"},{name:t})},getActingTime:function(t){return r(t,e)},clickAndDragToComment:e.formatMessage({id:"2Hok5",defaultMessage:"Select an area to comment on"}),a11yFolderOverviewLabel:e.formatMessage({id:"5Vrlb",defaultMessage:"Type notes, list, to-dos, and links here"})}}Object.defineProperty(t,"__esModule",{value:!0});t.getCommentsStrings=o}),define("comments2/strings",["require","exports","modules/core/i18n"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.strings={"1MIdr":{token:"number",message:function(e){return r.ungettext("%(number)s year ago","%(number)s years ago",e,{comment:"label for comment that was left a few years ago"})}},"34Osr":{token:"number",message:function(e){return r.ungettext("%(number)s month ago","%(number)s months ago",e,{comment:"label for comment that was left a few months ago"})}},"1B6qQ":{token:"number",message:function(e){return r.ungettext("%(number)s week ago","%(number)s weeks ago",e,{comment:"label for comment that was left a few weeks ago"})}},"2iioX":{token:"number",message:function(e){return r.ungettext("%(number)s day ago","%(number)s days ago",e,{comment:"label for comment that was left a few days ago"})}},"1yEvs":{token:"number",message:function(e){return r.ungettext("%(number)s hour ago","%(number)s hours ago",e,{comment:"label for comment that was left a few hours ago"})}},"1L0GZ":{token:"number",message:function(e){return r.ungettext("%(number)s min ago","%(number)s mins ago",e,{comment:"label for comment that was left a few mins ago"})}},"2cOfN":r._("Just now",{comment:"label for comment that was left less than a min ago"}),"1HPSR":r._("@mention someone to share this file",{comment:"mention instruction message"}),"zdkp-":r._("@mention someone",{comment:"mention btn label"}),hH4zI:r._("Searching contacts…",{comment:"message displayed while search is processed"}),"33XxC":r._("No Users Found",{comment:"No Users Found"}),"1EHcH":r._("Invite %(user_name)s",{comment:"invite message"}),"3BKNX":r._("Save",{comment:"edit button label"}),"2Jfhd":r._("Cancel",{comment:"Cancel button label"}),ioyQ2:r._("This comment was deleted.",{comment:"message after comment is deleted"}),"1bMft":r._("Edit",{comment:"edit button label"}),"1ddoD":r._("Delete",{comment:"delete button label"}),"1g51C":r._("Mark as read",{comment:"Mark as read button label"}),"3RQUH":r._("Mark as unread",{comment:"Mark as unread button label"}),"1Xu7U":r._("Marked as resolved",{comment:"Marked as resolved button label"}),"124aN":r._("On older version",{comment:"message displayed when user is viewing an older version of the file"}),"2Wm7z":r._("Reply…",{comment:"Reply affordance shown when hovering a collapsed thread"}),"2enZ9":r._("Comment",{comment:"Placeholder for Comment Editor"}),"3R968":r._("Post",{comment:"Post button label"}),SvXtJ:r._("Restore",{comment:"Restore button label"}),"1hWLR":r._("Resolve",{comment:"Resolve button label"}),"1LPWG":r._("Reply",{comment:"Reply button label"}),"15HlI":r._("View version history",{comment:"View version history button label"}),"5iv8V":r._("Page %(page)s",{comment:"page number where comment was left on"}),DbGm_:r._("%(count)s comments",{comment:"number of comments left"}),JkeVi:r._("%(count)s unread",{comment:"number of unread comments"}),"2diM1":r._("Comment thread",{comment:"Comment thread accessbility label"}),sHIhB:r._("Unread comment thread",{comment:"Unread comment thread accessbility label"}),BOghH:r._("Previous sticker set",{comment:"Prev sticker set accessbility label"}),"2-vdP":r._("Next sticker set",{comment:"Next sticker set accessbility label"}),UaYQ_:r._("Sticker menu",{comment:"Sticker menu accessbility label"}),"3WMDi":r._("Sticker: %(description)s",{comment:"Sticker in a comment. Example: Sticker: Wizard jumping with joy"}),"1O7Rw":r._("Select %(description)s",{comment:"Select specific sticker set accessibility label"}),uEtdY:r._("Insert %(description)s",{comment:"Insert specific sticker accessibility label"}),dzqht:r._("Marked as resolved by %(name)s",{comment:"Action label to mark a resolved thread"}),"2Hok5":r._("Select an area to comment on",{comment:"label when making a comment using click/drag"}),"5Vrlb":r._("Type notes, list, to-dos, and links here",{comment:"a11y label for folder comment"})}}),define("modules/clean/browse/browse_bolt_client",["require","exports","modules/clean/bolt","modules/clean/react/browse/constants","modules/clean/api_v2/user_client","modules/core/exception"],function(e,t,r,o,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(){function e(e){var t=this;this.startLiveUpdate=function(e){void 0===e&&(e=null),e&&(t.handleUpdate=e),t.updateBoltClient(),t.status=o.BrowseBoltClientStatus.Live},this.onBoltRefresh=function(){t.updateBoltClient(),t.status=o.BrowseBoltClientStatus.Live},this.onBoltUpdate=function(){t.handleUpdate&&t.handleUpdate()},this.updateBoltClient=function(){var e=t.boltData.map(function(e){return new r.SignedChannelState("sfj",e.bolt_unique_id,e.latest_sjid.toString(),e.bolt_token)});t.boltClient?t.boltClient.update_states(e):(t.boltClient=new r.BoltClient(e,t.onBoltUpdate,t.onBoltRefresh),t.boltClient.start())},this.userId=e,this.status=o.BrowseBoltClientStatus.NotReady,this.boltData=[]}return e.prototype.isReady=function(){return this.status!==o.BrowseBoltClientStatus.NotReady},e.prototype.setInitialBoltData=function(e){this.boltData=e,this.status=o.BrowseBoltClientStatus.NotLive},e.prototype.fetchInitialBoltData=function(e){var t=this;this.initialBoltDataRequest&&this.initialBoltDataRequest.abort(),(new n.UserApiV2Client).ns("files").rpc("get_browse_bolt_data",{},{subjectUserId:this.userId}).then(function(r){void 0===r.bolt_token_response&&i.reportException({err:new Error("Receieve empty bolt token response from /get_browse_bolt_data"),severity:"non-critical",tags:["js:browse"]});var o=r.bolt_token_response||[],n=[];o.forEach(function(e){n.push({bolt_token:e.bolt_token||"",bolt_unique_id:e.bolt_unique_id||"",latest_sjid:(e.latest_sjid||0).toString()})}),t.setInitialBoltData(n),e()},function(e){t.status=o.BrowseBoltClientStatus.NotReady,i.reportException({err:new Error("Error getting bolt data from /get_browse_bolt_data"),severity:"non-critical",tags:["js:browse"]})}).finally(function(){delete t.initialBoltDataRequest})},e.prototype.handleUpdateBoltClient=function(e){this.boltData=e,this.updateBoltClient()},e.prototype.getNsMap=function(){var e={};return this.boltData.forEach(function(t){e[t.bolt_unique_id]=parseInt(t.latest_sjid,10)}),e},e.prototype.stopLiveUpdate=function(){this.status=o.BrowseBoltClientStatus.NotLive,this.boltClient&&this.boltClient.unsubscribe()},e})();t.BrowseBoltClient=s}),define("modules/clean/cloud_docs/create_api",["require","exports","tslib","modules/clean/api_v2/user_client","modules/clean/cloud_docs/constants","modules/clean/cloud_docs/create_pointer_modal","modules/clean/cloud_docs/event_logging","modules/clean/cloud_docs/types","modules/clean/filepath","modules/clean/logging/hive/schemas/web-modal-activity","modules/clean/react/async_file_modal_controller","modules/clean/react/folder_dialog/async","modules/clean/react/modal","modules/clean/react/snackbar","modules/clean/react/browse/api","modules/clean/react/browse/action_logger","modules/clean/web_user_action_events","modules/core/browser","modules/core/cookies","modules/core/i18n","spectrum/util/uuid_generator"],function(e,t,r,o,n,i,s,a,l,c,d,u,p,f,_,m,h,S,g,v,E){"use strict";var w=this;Object.defineProperty(t,"__esModule",{value:!0}),l=r.__importStar(l),d=r.__importStar(d),u=r.__importStar(u),_=r.__importStar(_),S=r.__importStar(S);var b=v._("Create file in..."),T=v._("Create shortcut in..."),F=v._("Create");t.CloudDocSnackbarId="create-cloud-doc",t.getDepthFromPath=function(e){return(e.replace(/\/$/,"").match(/\//g)||[]).length},t.logCreateFileAttempt=function(e,t){s.logUserAction({actionEvent:a.UserActionEventType.PRE_CREATE,userId:t.userId,actionSource:t.action_source,data:{webOpenId:e}})},t.logCreateFileSuccessCallback=function(e){var t=e.ts,r=e.openId,o=e.selection_mode,n=e.empty_folder;return function(e){m.logFileCreateSuccess({uid:e.userId,document_type:e.documentType,time_elapsed:Date.now()-t,open_id:r,selection_mode:o,empty_folder:n}),s.logUserAction({actionEvent:a.UserActionEventType.CREATE,userId:e.userId,docPathOrId:e.fq_path,actionSource:e.action_source,data:{webOpenId:r}})}},t.showAsyncFolderDialog=function(e){var r=e.user,o=e.source,i=e.documentType,s=e.selection_mode,a=e.empty_folder,l=n.isPointerFileType(i)?T:b;u.showFolderDialog({modalName:c.ModalName.CLOUD_DOCS_CREATE,user:r,title:l,primaryActionLabel:F,onSuccess:function(e,n){var l=e?e:"/";m.logFileCreateClick({uid:r.id,source:o,action:h.WebUserActionLogEvent.FILE_CREATE_HOME_FOLDER_SELECTED,depth_folder_selected:t.getDepthFromPath(l),selection_mode:s,empty_folder:a}),t.createNewFile({user:r,path:l,documentType:i,source:o,selection_mode:s,empty_folder:a})}})},t.createNewFile=function(o){var a=o.user,l=o.path,c=o.documentType,d=o.source,u=o.selection_mode,p=o.empty_folder;return r.__awaiter(w,void 0,Promise,function(){return r.__generator(this,function(o){return[2,Promise.all([new Promise(function(t,r){e(["modules/clean/account/email"],t,r)}).then(r.__importStar),new Promise(function(t,r){e(["modules/clean/account/email_verify_reasons"],t,r)}).then(r.__importStar)]).then(function(e){var r=e[0].EmailVerification,o=e[1].CLOUD_DOCS;if(r.get_for_user(a).verified_or_show(o)){var f=E.generateUUID("web-create");if(n.isMicrosoftFileType(c)){t.logCreateFileAttempt(f,{userId:a.id,action_source:s.getActionSourceFromNewFileMenuType(d)});var _=t.logCreateFileSuccessCallback({ts:Date.now(),openId:f,selection_mode:u,empty_folder:p});y({userId:a.id,path:l,documentType:c,logSuccessCallback:_,source:d})}else if(n.isPointerFileType(c))i.CreatePointerModal.showInstance({createOnSubmit:function(e){t.logCreateFileAttempt(f,{userId:a.id,action_source:s.getActionSourceFromNewFileMenuType(d)});var r=t.logCreateFileSuccessCallback({ts:Date.now(),openId:f,selection_mode:u,empty_folder:p});t.createNewPointer({userId:a.id,pathName:l,name:e.pointerData.name,url:e.pointerData.url,onError:e.onError,logSuccessCallback:r,source:d})}});else{t.logCreateFileAttempt(f,{userId:a.id,action_source:s.getActionSourceFromNewFileMenuType(d)});var _=t.logCreateFileSuccessCallback({ts:Date.now(),openId:f,selection_mode:u,empty_folder:p});t.createNewCloudOnlyDoc({userId:a.id,pathName:l,title:v._("Untitled",{comment:"The default name for a new Cloud Doc, e.g. Untitled.gdoc"}),documentType:c,logSuccessCallback:_,source:d,openId:f,selection_mode:u,empty_folder:p})}}})]})})};var y=function(e){var r=e.userId,o=e.path,n=e.documentType,i=e.logSuccessCallback,a=e.source,l={fq_path:o,extension:n,action_source:t.getCreateActionSource(a),_subject_uid:String(r),t:g.Cookies.read("__Host-js_csrf")},c=t.constructFormForCreateNewMicrosoftFile(l);document.body.appendChild(c),c.submit(),i({userId:r,documentType:n,action_source:s.getActionSourceFromNewFileMenuType(a)})};t.constructFormForCreateNewMicrosoftFile=function(e){var t=document.createElement("form");t.action="/ow/msft/create_new_file",t.method="POST",t.target="_blank";for(var r=0,o=Object.keys(e);r<o.length;r++){var n=o[r],i=document.createElement("input");i.type="hidden",i.name=n,i.value=e[n],t.appendChild(i)}return t},t.createNewCloudOnlyDoc=function(e){var r=e.userId,o=e.pathName,i=e.title,a=e.documentType,l=e.logSuccessCallback,c=e.source,u=e.openId,p=e.selection_mode,m=e.empty_folder,h=v._("Creating new file…"),g=v._("File created!"),E=function(e){return e.preventDefault(),e.returnValue="",""};window.addEventListener("beforeunload",E);var w=n.LOADING_PAGE_URL+o,b=S.unsafe_open_tab(w),T=function(e){f.Snackbar.sync(h,!0,t.CloudDocSnackbarId),_.createCloudDoc({pathName:o,title:i,documentType:a,userId:r,onSuccess:function(e){var o=(e.changesets,e.createdFile),n=e.failureDetails;if(n){var i=function(){l=t.logCreateFileSuccessCallback({ts:Date.now(),openId:u,selection_mode:p,empty_folder:m}),b=S.unsafe_open_tab(w),T(!1)};b.close(),f.Snackbar.close(t.CloudDocSnackbarId),window.removeEventListener("beforeunload",E),d.showFileSystemWarningsModal({fsws:n,confirmText:v._("Create"),onFinalAccept:i})}else if(f.Snackbar.complete(g,t.CloudDocSnackbarId),window.removeEventListener("beforeunload",E),null!==o&&(l({userId:r,documentType:a,fq_path:o.fq_path,action_source:s.getActionSourceFromNewFileMenuType(c)}),b)){var _=o.open_to_url;try{var h=new URL(_);h.searchParams.set("web_open_id",u),_=h.toString()}catch(e){}b.location.replace(_)}},onError:function(e){f.Snackbar.fail(e,t.CloudDocSnackbarId),window.removeEventListener("beforeunload",E)},checkFSWs:e})};T(!0)},t.createNewPointer=function(e){var t=e.userId,r=e.pathName,i=e.name,c=e.url,d=e.onError,u=e.logSuccessCallback,_=e.source,m=new o.UserApiV2Client,h=v._("Creating new shortcut"),S=v._("Created shortcut");return f.Snackbar.sync(h,!0,"create-cloud-shortcut"),m.ns("cloud_docs").rpc("create",{to_path:l.normalize(r)||"/",title:i,cloud_doc_type:a.SimplePointer,pointer_url:c},{subjectUserId:t}).then(function(e){u({userId:t,documentType:n.PointerFileTypes.SIMPLE_POINTER,fq_path:e.result_path,action_source:s.getActionSourceFromNewFileMenuType(_)}),p.Modal.close(),f.Snackbar.complete(S+' "'+l.filename(e.result_path)+'"',"create-cloud-shortcut")}).catch(function(e){d(),f.Snackbar.fail(v._("Oops, something went wrong. Please try again later."),"create-cloud-shortcut")})},t.getCreateActionSource=function(e){switch(e){case n.NewFileMenuFromType.BROWSE:return n.ActionSourceValue.WEB_BROWSE;case n.NewFileMenuFromType.HOME:return n.ActionSourceValue.WEB_HOME;default:return n.ActionSourceValue.WEB}}}),define("modules/clean/cloud_docs/create_pointer_modal",["require","exports","tslib","react","modules/clean/cloud_docs/pointers_common","modules/clean/react/css","modules/clean/react/modal","modules/core/i18n","spectrum/button","spectrum/modal"],function(e,t,r,o,n,i,s,a,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o);var d=a._("Create a new shortcut"),u=a._("Create"),p=a._("Creating..."),f=a._("Cancel"),_=a._("Name"),m=a._("URL"),h=a._("Invalid URL"),S=(function(e){function t(t){var r=e.call(this,t)||this;return r.onChange=function(e){r.setState({pointerData:e})},r.handleCreateOnClick=function(){r.setState({creationInProgress:!0}),r.props.createOnSubmit({pointerData:{name:r.state.pointerData.name.trim(),url:r.state.pointerData.url.trim()},onError:r.handleSubmitError})},r.handleSubmitError=function(){r.setState({creationInProgress:!1})},r.renderCreateButton=function(){var e=n.CreatePointerFields.canSubmit(r.state.pointerData)&&!r.state.creationInProgress;return o.default.createElement(l.Button,{variant:"primary",disabled:!e,onClick:r.handleCreateOnClick},r.state.creationInProgress?p:u)},r.renderCancelButton=function(){return o.default.createElement(l.Button,{variant:"secondary",onClick:s.Modal.close},f)},r.state={pointerData:{name:"",url:""},creationInProgress:!1},r}return r.__extends(t,e),t.prototype.render=function(){return o.default.createElement(c.UtilityModal,{title:d,ariaLabel:"Shortcut Creation Modal",primaryAction:this.renderCreateButton,secondaryAction:this.renderCancelButton,open:!0,shouldRequestCloseOnActions:!1,overlayClickClose:!0,variant:"regular"},o.default.createElement(n.CreatePointerFields,{name:this.state.pointerData.name,url:this.state.pointerData.url,onChange:this.onChange,onSubmit:this.handleCreateOnClick,nameLabel:_,urlLabel:m,urlValidationMessage:h}))},t.showInstance=function(e){return s.Modal.showInstance(o.default.createElement(g,r.__assign({},e)))},t})(o.default.Component);t.CreatePointerModal=S;var g=i.requireCssWithComponent(S,["/static/css/spectrum/index.web-vfl81nbBN.css","/static/css/cloud_docs/create_pointer_modal-vflATc8Dt.css"])}),define("modules/clean/cloud_docs/event_logging",["require","exports","tslib","modules/clean/api_v2/user_client","modules/clean/cloud_docs/types","modules/clean/web_timing_logger","modules/clean/web_user_action_events","modules/clean/logging/hive/schemas/web-user-action","modules/clean/logging/telemetry","modules/constants/python","modules/clean/cloud_docs/constants","modules/core/browser","modules/clean/perf_tools/web_timing_utils","modules/core/exception"],function(e,t,r,o,n,i,s,a,l,c,d,u,p,f){"use strict";function _(e,t,r){var n={".tag":r},i={shared_link_details:{url:t}},s={file_info:i,platform_type:n},a={file_views:[s]};(new o.UserApiV2Client).ns("seen_state").rpc("log_file_view",a,{subjectUserId:e})}function m(e,t,r,s,a,l){var c=l||[];c.push({key:"time_on_page_with_redirect",value:i.time_since_start().toString()}),c.some(function(e){return"time_now"===e.key})||c.push({key:"time_now",value:Date.now().toString()}),(new o.UserApiV2Client).ns("cloud_docs").rpc("log_client_event",{client:n.docTypeToClient[r],doc_id:t,event_name:s,auth_token:a,time_on_page:p.WebTimingUtil.getNow()-v(),extras:c},{subjectUserId:e})}function h(e){var t,r=(new o.UserApiV2Client).ns("cloud_docs");e.hasOwnProperty("docPathOrId")&&e.docPathOrId&&(t={".tag":"path_or_id",path_or_id:e.docPathOrId});var n=e.data&&e.data.webOpenId,i=e.data&&e.data.origDest,s=e.data&&e.data.routingDest;r.rpc("log_user_action",{action:e.actionEvent,doc_id:t,source:e.actionSource,open_id:n,orig_dest:i,routing_dest:s},{subjectUserId:e.userId})}function S(e,t,r,o,n){(new l.HiveLogger).log(new a.WebUserActionRow({user_id:e,event_name:s.WebUserActionLogEvent.FILE_OPEN_PROMPT_ACTION,extra:{file_type:t,integration_name:r,prompt_action:o,ask_again:n}}))}Object.defineProperty(t,"__esModule",{value:!0}),i=r.__importStar(i),l=r.__importStar(l),u=r.__importStar(u);var g=void 0,v=function(){try{g=g||u.performance().timing.fetchStart}catch(e){f.reportStack("Unable to get fetchStart from browser.",{severity:f.SEVERITY.NONCRITICAL}),g=i.start_time()}return g};t.logViewEvent=_,t.logClientEvent=m,t.logUserAction=h,t.getActionSourceFromSurface=function(e){return"search"===e?n.UserActionSourceType.WEB_SEARCH:"previews"===e?n.UserActionSourceType.WEB_PREVIEW:"home_recent"===e||"home_starred"===e?n.UserActionSourceType.WEB_HOME:"browse"===e||"sidebar"===e?n.UserActionSourceType.WEB_BROWSE:n.UserActionSourceType.WEB},t.getActionSourceFromSourceArgs=function(e){return e.fileViewAction===c.FileViewActionType.SEARCH||e.fileViewOrigin===c.FileViewOriginType.SEARCH?n.UserActionSourceType.WEB_SEARCH:e.fileViewOrigin===c.FileViewOriginType.BROWSE?n.UserActionSourceType.WEB_BROWSE:e.fileViewOrigin===c.FileViewOriginType.HOME?n.UserActionSourceType.WEB_HOME:n.UserActionSourceType.WEB},t.getActionSourceFromNewFileMenuType=function(e){switch(e){case d.NewFileMenuFromType.BROWSE:return n.UserActionSourceType.WEB_BROWSE;case d.NewFileMenuFromType.HOME:return n.UserActionSourceType.WEB_HOME;default:return n.UserActionSourceType.WEB}},t.logFileOpenPromptAction=S}),define("modules/clean/cloud_docs/new_file_menu",["require","exports","tslib","external/classnames","react","modules/constants/page_load","spectrum/button","spectrum/icon_partners","spectrum/popover","spectrum/tertiary_link","modules/clean/cloud_docs/constants","modules/clean/cloud_docs/create_api","modules/clean/react/browse/action_logger","modules/clean/react/css","modules/clean/web_user_action_events","modules/core/i18n"],function(e,t,r,o,n,i,s,a,l,c,d,u,p,f,_,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),n=r.__importDefault(n),i=r.__importStar(i),t.LongNewFileCreateLabel=m._("Create new file"),t.ShortNewFileCreateLabel=m._("Create",{comment:"Button to create a new file"});var h=m._("Google Docs"),S=m._("Google Sheets"),g=m._("Google Slides"),v=m._("Microsoft Excel"),E=m._("Microsoft PowerPoint"),w=m._("Microsoft Word"),b=m._("Dropbox Paper"),T=m._("Dropbox Paper Template"),F=m._("Dropbox Binder (Beta)",{comment:'Branded Feature - do not localize "Binder".'}),y=m._("Shortcut");t.handleNewFileSelection=function(e){e.handleClick()};var C=function(e){switch(e){case d.MicrosoftFileTypes.WORD:return _.WebUserActionLogEvent.FILE_CREATE_WORD;case d.MicrosoftFileTypes.EXCEL:return _.WebUserActionLogEvent.FILE_CREATE_EXCEL;case d.MicrosoftFileTypes.POWERPOINT:return _.WebUserActionLogEvent.FILE_CREATE_POWERPOINT;case d.GoogleFileTypes.GOOGLE_DSS_DOC:return _.WebUserActionLogEvent.FILE_CREATE_GOOGLE_DOC;case d.GoogleFileTypes.GOOGLE_DSS_SHEET:return _.WebUserActionLogEvent.FILE_CREATE_GOOGLE_SHEET;case d.GoogleFileTypes.GOOGLE_DSS_SLIDES:return _.WebUserActionLogEvent.FILE_CREATE_GOOGLE_SLIDES;case d.PaperNewFileTypes.PAPER:return _.WebUserActionLogEvent.FILE_CREATE_PAPER;case d.PaperNewFileTypes.PAPER_TEMPLATE:return _.WebUserActionLogEvent.FILE_CREATE_PAPER_TEMPLATE;case d.PaperNewFileTypes.PAPER_BINDER:return _.WebUserActionLogEvent.FILE_CREATE_BINDER;case d.PointerFileTypes.SIMPLE_POINTER:return _.WebUserActionLogEvent.FILE_CREATE_SIMPLE_POINTER}},I=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.renderIcon=function(){return n.default.createElement(a.IconPartners,{name:this.props.item.iconName,width:"24px",height:"24px"})},t.prototype.render=function(){return n.default.createElement(l.PopoverContentItem,{key:this.props.item.displayName,value:this.props.item,className:this.props.item.className},n.default.createElement("div",{className:"newfile-popover--item"},this.renderIcon(),n.default.createElement("div",{className:"newfile-popover--item-text"},this.props.item.displayName)))},t})(n.default.Component);t.NewFileTypeRow=I;var O=(function(e){function a(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleCreateNewFile=function(e){return function(){var r=t.props,o=r.selection_mode,n=r.empty_folder;p.logFileCreateClick({uid:t.props.user.id,source:t.props.source,action:C(e),depth_folder_selected:t.props.path?u.getDepthFromPath(t.props.path):void 0,selection_mode:o,empty_folder:n}),t.props.path?u.createNewFile({user:t.props.user,path:t.props.path,documentType:e,source:t.props.source,selection_mode:o,empty_folder:n}):u.showAsyncFolderDialog({user:t.props.user,source:t.props.source,documentType:e,selection_mode:o,empty_folder:n})}},t.logTriggerClick=function(){var e=t.props,r=e.empty_folder,o=e.selection_mode,n=e.path,i=e.user,s=e.source;p.logFileCreateClick({uid:i.id,source:s,action:_.WebUserActionLogEvent.FILE_CREATE_OPEN_MENU,depth_folder_selected:n?u.getDepthFromPath(n):void 0,selection_mode:o,empty_folder:r})},t}return r.__extends(a,e),a.prototype.getNewFileTypeSections=function(){var e=[],t=[];this.props.showPaper&&(t.push({displayName:b,iconName:"dropbox_paper",className:"action-create-file-paper-doc",handleClick:this.handleCreateNewFile(d.PaperNewFileTypes.PAPER)}),t.push({displayName:T,iconName:"dropbox_paper_template",className:"action-create-file-paper-template",handleClick:this.handleCreateNewFile(d.PaperNewFileTypes.PAPER_TEMPLATE)})),this.props.showBinder&&t.push({displayName:F,iconName:"dropbox_paper_binder",className:"action-create-file-paper-binder",handleClick:this.handleCreateNewFile(d.PaperNewFileTypes.PAPER_BINDER)}),t.push({displayName:y,iconName:"shortcut",className:"action-create-simple-pointer",handleClick:this.handleCreateNewFile(d.PointerFileTypes.SIMPLE_POINTER)}),t.length>0&&e.push(t);var r=[];if(r.push({displayName:w,iconName:"microsoft_docx",className:"action-create-file-word",handleClick:this.handleCreateNewFile(d.MicrosoftFileTypes.WORD)}),r.push({displayName:v,iconName:"microsoft_xlsx",className:"action-create-file-excel",handleClick:this.handleCreateNewFile(d.MicrosoftFileTypes.EXCEL)}),r.push({displayName:E,iconName:"microsoft_pptx",className:"action-create-file-powerpoint",handleClick:this.handleCreateNewFile(d.MicrosoftFileTypes.POWERPOINT)}),e.push(r),this.props.showGdd){var o=[];o.push({displayName:h,iconName:"google_gdoc",className:"action-create-file-google-doc",handleClick:this.handleCreateNewFile(d.GoogleFileTypes.GOOGLE_DSS_DOC)}),o.push({displayName:S,iconName:"google_gsheet",className:"action-create-file-google-sheet",handleClick:this.handleCreateNewFile(d.GoogleFileTypes.GOOGLE_DSS_SHEET)}),o.push({displayName:g,iconName:"google_gslides",className:"action-create-file-google-slides",handleClick:this.handleCreateNewFile(d.GoogleFileTypes.GOOGLE_DSS_SLIDES)}),e.push(o)}return e},a.prototype.renderTrigger=function(){var e=0===i.USER_LOCALE.indexOf("en"),r=e||this.props.forceLongLabel?t.LongNewFileCreateLabel:t.ShortNewFileCreateLabel;return this.props.primaryButton?n.default.createElement(s.Button,{key:t.LongNewFileCreateLabel,onClick:this.logTriggerClick,disabled:this.props.disabled,className:o.default("primary-action-menu__button","action-create-file"),tagName:"span"},r):n.default.createElement(c.TertiaryLink,{key:t.LongNewFileCreateLabel,icon:"create",onClick:this.logTriggerClick,disabled:this.props.disabled,className:o.default("secondary-action-menu__button","action-create-file"),tagName:"span"},t.LongNewFileCreateLabel)},a.prototype.renderSection=function(e,t){return n.default.createElement("div",{className:"newfile-popover--section",key:t},e.map(function(e){return n.default.createElement(I,{item:e,key:e.displayName})}))},a.prototype.render=function(){var e=this.props.attachment;return n.default.createElement(l.Popover,{onSelection:t.handleNewFileSelection},n.default.createElement(l.PopoverTrigger,{disabled:this.props.disabled,className:"newfile-popover--trigger"},this.renderTrigger()),n.default.createElement(l.PopoverContent,{attachment:e,isRevealed:!this.props.disabled&&void 0},n.default.createElement("div",{className:"newfile-popover"},this.getNewFileTypeSections().map(this.renderSection))))},a.defaultProps={attachment:"right"},a})(n.default.Component),R=f.requireCssWithComponent(O,["/static/css/spectrum/index.web-vfl81nbBN.css","/static/css/cloud_docs/new_file_menu-vflmmvtj0.css","/static/css/cloud_docs/create_pointer_modal-vflATc8Dt.css"]);t.NewFileMenu=R}),define("modules/clean/cloud_docs/open_with_utils",["require","exports","tslib","modules/clean/filepath","modules/core/browser","modules/clean/cloud_docs/constants","modules/clean/cloud_docs/event_logging","modules/clean/cloud_docs/types","modules/clean/referrer_cleansing_redirect","modules/clean/cloud_docs/constants","modules/core/uri","modules/clean/cloud_docs/utils","modules/clean/open_with","spectrum/util/uuid_generator","modules/core/browser_detection"],function(e,t,r,o,n,i,s,a,l,c,d,u,p,f,_){"use strict";function m(){return r.__awaiter(this,void 0,Promise,function(){var t;return r.__generator(this,function(o){switch(o.label){case 0:return[4,new Promise(function(t,r){e(["modules/clean/api_v2/user_client"],t,r)}).then(r.__importStar)];case 1:return t=o.sent().UserApiV2Client,[2,(new t).ns("cloud_docs")]}})})}function h(e){if(void 0!==e&&void 0!==e.error&&void 0!==e.error[".tag"])return e.error[".tag"]}function S(e){switch(h(e)){case"invalid_file_id":case"permission_denied":case"other":return;default:return}}function g(e,t,r,o,i,l,c){var u=f.generateUUID("web_open_id"),p=d.URI.parse(e.cloud_editor_url).updateQuery({cloud_editor:i,web_open_id:u});l&&p.updateQuery({ignore_lock:"1"});var _=p.toString()
;_&&(void 0===c&&(c=a.UserActionSourceType.WEB),s.logUserAction({actionEvent:a.UserActionEventType.PRE_OPEN,userId:o.id,docPathOrId:r.file_id,actionSource:c,data:{webOpenId:u}}),null!=t?n.redirect(_,t):n.open_tab(_))}function v(e){return[".gdoc",".gsheet",".gslides"].indexOf(u.getFileExt(e))>=0}function E(e){return".web"===u.getFileExt(e)}function w(e){return!!v(e)||!!E(e)}function b(e,t){for(var r=u.getFileExt(e),o=0,n=Object.keys(c.DSS_TYPE_TO_SUPPORTED_EXTS);o<n.length;o++){var i=n[o],s=i;if(c.DSS_TYPE_TO_SUPPORTED_EXTS[s].indexOf(r)>=0)return s}switch(r){case".gdoc":return c.GoogleFileTypes.GOOGLE_DSS_DOC;case".gsheet":return c.GoogleFileTypes.GOOGLE_DSS_SHEET;case".gslides":return c.GoogleFileTypes.GOOGLE_DSS_SLIDES}return null}var T=this;Object.defineProperty(t,"__esModule",{value:!0}),l=r.__importStar(l),p=r.__importDefault(p),_=r.__importStar(_);var F;t.getCloudEditorUrlCached=function(e,o){return r.__awaiter(T,void 0,Promise,function(){return r.__generator(this,function(r){return F||(F=t.getCloudEditorUrl(e,o)),[2,F]})})},t.getCloudEditorUrl=function(e,t){return r.__awaiter(T,void 0,Promise,function(){var o;return r.__generator(this,function(r){switch(r.label){case 0:return[4,m()];case 1:return o=r.sent(),[2,o.rpc("get_cloud_editor_url",{file_id:t},{subjectUserId:e})]}})})},t.decodeAPIError=h,t.handleError=S,t.isInEdgeIframe=function(){var e=!1;if(_.edge||_.msie||_.edgeChromium())try{e=window.self!==window.top}catch(t){e=!0}return e},t.openWithCloudEditor=function(e,r,o,i,s){var a,l=c.LOADING_PAGE_URL;t.isInEdgeIframe()?t.getCloudEditorUrlCached(r.id,e.file_id).then(function(t){g(t,null,e,r,o,i,s)}).catch(function(e){S(e)}):(a=n.open_tab(l,!0),t.getCloudEditorUrl(r.id,e.file_id).then(function(t){g(t,a,e,r,o,i,s)}).catch(function(e){S(e)}))},t.openCloudDoc=function(t,u,p){if(p||(p=a.UserActionSourceType.WEB),t.href)if(i.isPointerByExtension(t.ns_path))l.safe_open_tab_and_redirect(t.href),s.logUserAction({actionEvent:a.UserActionEventType.PRE_OPEN,userId:u.id,docPathOrId:t.file_id,actionSource:p});else{var _=f.generateUUID("web_open_id"),m=d.URI.parse(t.href).updateQuery("web_open_id",_).toString();n.open_tab(m),s.logUserAction({actionEvent:a.UserActionEventType.PRE_OPEN,userId:u.id,docPathOrId:t.file_id,actionSource:p,data:{webOpenId:_}})}else{var h=c.LOADING_PAGE_URL+o.parent_dir(t.fq_path),S=n.unsafe_open_tab(h);new Promise(function(t,r){e(["modules/clean/previews/data/actions"],t,r)}).then(r.__importStar).then(function(e){return e.fetchPreviewUrl(t,u)}).then(function(e){e&&null!==S&&l.redirect(e,S,!0)})}};var y;(function(e){e.OfficeOnline="OfficeOnline",e.GoogleDSS="GoogleDSS"})(y=t.OpenWithCloudDocProvider||(t.OpenWithCloudDocProvider={})),t.getOpenWithCloudEditorInfo=function(e,r,o,n){var i=[],s=t.getOpenWithWopiEditorInfo(e,r,n);s&&o.wopi&&i.push(s);var a=t.getOpenWithGoogleEditorInfo(e,r,n);return a&&o.gdd&&i.push(a),i},t.getOpenWithGoogleEditorInfo=function(e,r,o){var n=b(e,r);return n?{text:c.DSS_TYPE_TO_TEXT[n],iconUrl:c.DSS_TYPE_TO_OPEN_WITH_ICONS[n],handler:function(){return t.openWithCloudEditor(e,r,n,!1,o)},provider:y.GoogleDSS}:null},t.getOpenWithWopiEditorInfo=function(e,r,o){var n=p.default.getWopiOpenWithButtonInfo(e);return n?{text:n.name,spriteName:n.icon,handler:function(){return t.openWithCloudEditor(e,r,n.editor,!1,o)},provider:y.OfficeOnline}:null},t.isGoogleDoc=v,t.isShortcut=E,t.isCloudBasedDoc=w,t.getGoogleEditorType=b}),define("modules/clean/cloud_docs/pointers_common",["require","exports","tslib","modules/clean/keycode","react","spectrum/input"],function(e,t,r,o,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importStar(n);var s=(function(e){function t(){var r=null!==e&&e.apply(this,arguments)||this;return r.handleKeyPress=function(e){e.charCode===o.KeyCode.ENTER&&t.canSubmit({name:r.props.name,url:r.props.url})&&r.props.onSubmit()},r.handleNameChange=function(e){var t=e.target.value;r.props.onChange({name:t,url:r.props.url})},r.handleUrlChange=function(e){var t=e.target.value;r.props.onChange({name:r.props.name,url:t})},r.setNameFieldRef=function(e){r.nameRef=e},r}return r.__extends(t,e),t.prototype.render=function(){var e=""===this.props.url||t.isUrlValid(this.props.url),r=e?"default":"invalid",o="";return e||(o=this.props.urlValidationMessage),n.createElement("div",{className:"create-pointer--fields"},n.createElement("div",{className:"create-pointer--fieldset"},n.createElement("label",{htmlFor:"create-pointer--link_input"},this.props.urlLabel),n.createElement("div",{className:"create-pointer--fieldset-with-icon"},this.props.urlIcon,n.createElement(i.Input,{id:"create-pointer--link_input",className:"create-pointer--link_input",variant:r,onChange:this.handleUrlChange,onKeyPress:this.handleKeyPress,value:this.props.url,autoFocus:!0}))),n.createElement("div",{className:"create-pointer--url-validation-warning"},o),n.createElement("div",{className:"create-pointer--fieldset"},n.createElement("label",{htmlFor:"create-pointer--name_input"},this.props.nameLabel),n.createElement(i.Input,{id:"create-pointer--name_input",className:"create-pointer--name_input",onChange:this.handleNameChange,onKeyPress:this.handleKeyPress,forwardedRef:this.setNameFieldRef})))},t.prototype.componentDidMount=function(){return r.__awaiter(this,void 0,void 0,function(){var e;return r.__generator(this,function(t){switch(t.label){case 0:return this.props.urlPrepopulateFunction?[4,this.props.urlPrepopulateFunction()]:[3,2];case 1:e=t.sent(),e&&(this.props.onChange({name:this.props.name,url:e}),this.nameRef.focus()),t.label=2;case 2:return[2]}})})},t.isUrlValid=function(e){return/^((http|https):\/\/)?([^.:\/\\?#@!]+?\.)+[^.:\/\\?#@!]+/i.test(e.trim())},t.canSubmit=function(e){return""!==e.name&&""!==e.url&&t.isUrlValid(e.url)},t})(n.Component);t.CreatePointerFields=s}),define("modules/clean/cloud_docs/preferred_editor_constants",["require","exports","modules/core/i18n"],function(e,t,r){"use strict";var o;Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.Unknown=0]="Unknown",e[e.FileViewer=1]="FileViewer",e[e.OfficeOnline=2]="OfficeOnline",e[e.GoogleDSS=3]="GoogleDSS"})(t.PreferredEditorTypes||(t.PreferredEditorTypes={}));var n;(function(e){e.WORD="ms_word",e.EXCEL="ms_excel",e.POWERPOINT="ms_powerpoint"})(n=t.PreferredEditorDocTypes||(t.PreferredEditorDocTypes={})),t.PreferredEditorOptionsMap=(o={},o[n.WORD]={1:r._("View in dropbox.com"),2:r._("Microsoft Word Online"),3:r._("Google Docs")},o[n.EXCEL]={1:r._("View in dropbox.com"),2:r._("Microsoft Excel Online"),3:r._("Google Sheets")},o[n.POWERPOINT]={1:r._("View in dropbox.com"),2:r._("Microsoft PowerPoint Online"),3:r._("Google Slides")},o)}),define("modules/clean/cloud_docs/preferred_editor_utils",["require","exports","tslib","modules/core/i18n","modules/core/browser","modules/core/exception","modules/clean/cloud_docs/event_logging","modules/clean/cloud_docs/utils","modules/clean/cloud_docs/types","modules/clean/react_format","react","modules/clean/filepath","modules/clean/cloud_docs/constants","modules/clean/cloud_docs/open_with_utils","modules/core/uri","modules/clean/cloud_docs/cloud_doc_api_client","spectrum/util/uuid_generator","modules/clean/cloud_docs/preferred_editor_constants"],function(e,t,r,o,n,i,s,a,l,c,d,u,p,f,_,m,h,S){"use strict";function g(e){var t=a.getFileExt(e);return I.indexOf(t)>=0}function v(e,r,o,c,d){var u=a.getFileExt(r),g=o[e.id],v="";if(!g)return void c();try{var E=g[t.EXTENSION_TO_DOC_TYPE[u]],w=E===S.PreferredEditorTypes.GoogleDSS||E===S.PreferredEditorTypes.OfficeOnline,b=h.generateUUID("web_open_id");if(w){var T=n.open_tab(p.LOADING_PAGE_URL,!0);f.getCloudEditorUrl(e.id,r.file_id).then(function(t){v=_.URI.parse(t.cloud_editor_url).updateQuery("web_open_id",b).toString(),T?T.location.replace(v):c(),s.logUserAction({actionEvent:l.UserActionEventType.PRE_OPEN,userId:e.id,docPathOrId:r.file_id,actionSource:s.getActionSourceFromSourceArgs(d),data:{webOpenId:b}})}).catch(function(e){i.reportStack("Error getting cloud editor url from preferred editor open.",{severity:i.SEVERITY.CRITICAL,exc_extra:{preferred_editor_url:v,file_ext:u,preferred_editor_configs:g,error:e.message}}),T&&T.close(),c()})}else m.getPreferredUrl(e.id,r.file_id,u).then(function(t){t.preferred_editor_url&&(v=_.URI.parse(t.preferred_editor_url).updateQuery("web_open_id",b).toString(),s.logUserAction({actionEvent:l.UserActionEventType.PRE_OPEN,userId:e.id,docPathOrId:r.file_id,actionSource:s.getActionSourceFromSourceArgs(d),data:{webOpenId:b}}),n.redirect(v))}).catch(function(e){i.reportStack("Error getting preferred editor url from preferred editor open.",{severity:i.SEVERITY.CRITICAL,exc_extra:{preferred_editor_url:v,file_ext:u,preferred_editor_configs:g,error:e.message}})}),c()}catch(e){i.reportStack("Error opening docs in preferred editor.",{severity:i.SEVERITY.CRITICAL,exc_extra:{preferred_editor_url:v,file_ext:u,preferred_editor_configs:g,error:e.message}}),c()}}function E(e,t){var r="."+u.file_extension(e),n=O[t][r],i="<b>"+r+"</b>";return n?{title:c.reactFormat(o._("Would you like to open %(file_extension)s files with %(web_editor_name)s by default?").format({file_extension:i,web_editor_name:n}),{b:d.default.createElement("b",null)}),body:c.reactFormat(o._("%(web_editor_name)s will automatically be used to open your %(file_extension)s files in Dropbox. You can always update this later in your Dropbox settings.").format({file_extension:i,web_editor_name:n}),{b:d.default.createElement("b",null)})}:null}var w,b,T;Object.defineProperty(t,"__esModule",{value:!0}),d=r.__importDefault(d),t.IntegrationNameToPreferredEditorEnums=(w={},w[l.IntegrationName.GOOGLE_DSS]=S.PreferredEditorTypes.GoogleDSS,w[l.IntegrationName.OFFICE_ONLINE]=S.PreferredEditorTypes.OfficeOnline,w[l.IntegrationName.PAPER_INTEGRATION]=S.PreferredEditorTypes.Unknown,w),t.DssEditorTypeToPreferredEditorDocType=(b={},b[p.GoogleFileTypes.GOOGLE_DSS_DOC]=S.PreferredEditorDocTypes.WORD,b[p.GoogleFileTypes.GOOGLE_DSS_SHEET]=S.PreferredEditorDocTypes.EXCEL,b[p.GoogleFileTypes.GOOGLE_DSS_SLIDES]=S.PreferredEditorDocTypes.POWERPOINT,b);var F=[".docx"],y=[".xlsx"],C=[".pptx"],I=F.concat(y,C);t.EXTENSION_TO_DOC_TYPE={".docx":S.PreferredEditorDocTypes.WORD,".xlsx":S.PreferredEditorDocTypes.EXCEL,".pptx":S.PreferredEditorDocTypes.POWERPOINT},t.hasPreferredEditorSupport=g,t.openInPreferredEditor=v;var O=(T={},T[l.IntegrationName.GOOGLE_DSS]={".docx":o._("Google Docs"),".xlsx":o._("Google Sheets"),".pptx":o._("Google Slides")},T[l.IntegrationName.OFFICE_ONLINE]={".docx":o._("Microsoft Word Online"),".xlsx":o._("Microsoft Excel Online"),".pptx":o._("Microsoft PowerPoint Online")},T[l.IntegrationName.PAPER_INTEGRATION]={},T);t.getPreferredEditorPrompt=E}),define("modules/clean/cloud_docs/utils",["require","exports","modules/clean/filepath","modules/clean/sharing/constants","modules/clean/cloud_docs/types"],function(e,t,r,o,n){"use strict";function i(e){var t="";return e.hasOwnProperty("ext")?t=e.ext:e.hasOwnProperty("filename")?(t=r.file_extension(e.filename),t&&(t="."+t)):(t=r.file_extension(e),t&&(t="."+t)),t}function s(e){switch(e){case n.IntegrationName.GOOGLE_DSS:return o.SHARE_ACTION_ORIGIN_TYPE.GOOGLE_DSS;case n.IntegrationName.PAPER_INTEGRATION:return o.SHARE_ACTION_ORIGIN_TYPE.PAPER_INTEGRATION;case n.IntegrationName.OFFICE_ONLINE:return o.SHARE_ACTION_ORIGIN_TYPE.OFFICE_INTEGRATION;default:throw"No mapping for integration to share action origin: "+e}}function a(e){return e.replace(/[\/?<>:*\\]/g,"_")}Object.defineProperty(t,"__esModule",{value:!0}),t.getFileExt=i,t.integrationNameToShareActionOrigin=s,t.replaceInvalidFilenameChars=a}),define("modules/clean/file_operations/notifications",["require","exports","tslib","external/lodash","modules/clean/browse_interface","modules/clean/em_string","modules/clean/filepath","modules/clean/react/browse/api","modules/clean/undo","modules/core/html","modules/core/i18n","modules/core/notify"],function(e,t,r,o,n,i,s,a,l,c,d,u){"use strict";function p(e,t,r,o){var n=function(){return a.rollbackChangeSets({changesets:r,userId:t.id,progressText:d._("Undoing…"),onSuccess:function(){u.Notify.success(d._("Undo complete.")),o&&o()}})};l.notifyWithUndo(e,r,n)}function f(e,t){var r=n.browse_uri_for_fq_path(t,e),a=i.Emstring.em_snippet(s.filename(e),40);return{href:r,text:o.escape(a)}}function _(e,t,r,o,n){var i;if(o){var s=f(o,t);i=d.ungettext('Copied %(num_items)d item to <a href="%(dest_href)s">%(dest_name)s</a>.','Copied %(num_items)d items to <a href="%(dest_href)s">%(dest_name)s</a>.',e).format({num_items:e,dest_href:s.href,dest_name:s.text}),i=new c.HTML(i)}else i=d.ungettext("Copied %(num_items)d item.","Copied %(num_items)d items.",e).format({num_items:e});p(i,t,r,n)}function m(e,t,r,o,n){var i;if(o){var s=f(o,t);i=d.ungettext('Moved %(num_items)d item to <a href="%(dest_href)s">%(dest_name)s</a>.','Moved %(num_items)d items to <a href="%(dest_href)s">%(dest_name)s</a>.',e).format({num_items:e,dest_href:s.href,dest_name:s.text}),i=new c.HTML(i)}else i=d.ungettext("Moved %(num_items)d item.","Moved %(num_items)d items.",e).format({num_items:e});p(i,t,r,n)}function h(e,t,r,o){p(d.ungettext("Deleted %(num_items)d item.","Deleted %(num_items)d items.",e).format({num_items:e}),t,r,o)}function S(e,t,r){p(d._("Rename complete."),e,t,r)}function g(e,t,r){p(d._("Created folder %(folder_name)s.").format({folder_name:e}),t,r)}function v(e){var t=d.ungettext("Permanently deleted %(num)s item.","Permanently deleted %(num)s items.",e).format({num:e});u.Notify.success(t)}function E(e){var t,r=e.length;if(1===r){var n=o.escape(s.filename(e[0].fq_path));t=d._("Restored <strong>%(filename)s</strong>.").format({filename:n}),t=new c.HTML(t)}else t=d.ungettext("Restored %(num)s file.","Restored %(num)s files.",r).format({num:r});u.Notify.success(t,30)}Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),n=r.__importStar(n),s=r.__importStar(s),a=r.__importStar(a),l=r.__importStar(l),t.notifyCopySuccess=_,t.notifyMoveSuccess=m,t.notifyDeleteSuccess=h,t.notifyRenameSuccess=S,t.notifyFolderCreationSuccess=g,t.notifyPurgeSuccess=v,t.notifyRestoreSuccess=E}),define("modules/clean/growth/api",["require","exports","tslib","external/lodash","modules/clean/api_v2/user_client"],function(e,t,r,o,n){"use strict";function i(e){return r.__awaiter(this,void 0,Promise,function(){return r.__generator(this,function(t){return[2,(new n.UserApiV2Client).ns("onboarding_tracker").rpc("get_modules_statuses_for_tracker",{tracker:"post_setup_edu"},{subjectUserId:e.id}).then(function(e){return o.mapValues(o.keyBy(e.modules,"name"),"completed")})]})})}function s(e,t){return r.__awaiter(this,void 0,Promise,function(){return r.__generator(this,function(r){return[2,(new n.UserApiV2Client).ns("onboarding_tracker").rpc("mark_modules_complete_for_tracker",{tracker:"post_setup_edu",modules:[e]},{subjectUserId:t.id}).then(function(e){return e.errors})]})})}function a(e,t){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(r){return[2,(new n.UserApiV2Client).ns("files").rpc("get_metadata",{path:e},{subjectUserId:t.id})]})})}Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),t.fetchRichSnackbarSeenState=i,t.markRichSnackbarAsSeen=s,t.fetchMetadataForPath=a}),define("modules/clean/pagination_manager",["require","exports","tslib","modules/clean/ajax","modules/core/i18n","modules/core/notify"],function(e,t,r,o,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o);var s=(function(){function e(e){this.hasMoreItems=e}return e.prototype.areAllItemsReady=function(){return!this.hasMoreItems},e.prototype.invalidateHasMore=function(){this.hasMoreItems=!0},e.prototype.addDataToAjax=function(e){},e})(),a=(function(){function e(e){this.ajaxURL=e.ajaxURL,this.newDataCallback=e.newDataAvailableCallback,this.autoFetching=!1,this.mode=e.mode,this.keyName=e.keyName,this.items={},this.pages=[],this.nextRequestVoucher=e.firstPage.next_request_voucher,this.userID=e.userID,this.fqPathPrefix=e.fqPathPrefix?"/"+e.fqPathPrefix:"",this.addPage(e.firstPage.items)}return e.prototype.areAllItemsReady=function(){return this.mode.areAllItemsReady()},e.prototype.addPage=function(e){for(var t=[],r=[],o=0,s=e;o<s.length;o++){var a=s[o],l=a[this.keyName];if(null==l)return void i.Notify.warning(n._("Invalid server response"));null==this.items[l]&&(this.items[l]=a,r.push(a),t.push(l))}this.pages.push(t),this.newDataCallback(this,r)},e.prototype.startAutoFetching=function(){this.autoFetching=!0,this.fetchNext()},e.prototype.stopAutoFetching=function(){this.autoFetching=!1},e.prototype.reSync=function(e){void 0===e&&(e=!1),e&&(this.nextRequestVoucher=null,this.items={},this.pages=[]);var t=this.autoFetching&&this.mode.areAllItemsReady();this.mode.invalidateHasMore(),t&&this.startAutoFetching()},e.prototype.fetchNext=function(){var e=this;if(!this.mode.areAllItemsReady()){var t={};this.nextRequestVoucher&&(t.voucher=this.nextRequestVoucher),this.mode.addDataToAjax(t),o.WebRequest({url:this.ajaxURL,data:t,subject_user:this.userID,success:function(t){var r=JSON.parse(t);e.nextRequestVoucher=r.next_request_voucher,e.mode.hasMoreItems=r.has_more_items,e.autoFetching&&e.fetchNext();for(var o=0,n=r.items;o<n.length;o++){var i=n[o];i.fq_path=e.fqPathPrefix+i.fq_path}e.addPage(r.items)},error:function(){i.Notify.error(n._("There was a problem completing this request."))}})}},e.prototype.loadedPageCount=function(){return this.pages.length},e.prototype.getLoadedPage=function(e){var t=this,r=this.pages[e];return null==r?null:r.map(function(e){return t.items[e]})},e.prototype.getLastLoadedPage=function(){return this.getLoadedPage(this.loadedPageCount()-1)},e})();t.BasePaginationManager=a;var l=(function(e){function t(t){return e.call(this,r.__assign({},t,{mode:new s(t.firstPage.has_more_items)}))||this}return r.__extends(t,e),t.create=function(e){return new t(e)},t})(a);t.PaginationManager=l}),define("modules/clean/react/app_actions/education/async_extensions_edu_modal",["require","exports","tslib","react","modules/clean/react/modal"],function(e,t,r,o,n){"use strict";function i(t,i){var s=this;return new Promise(function(t){return r.__awaiter(s,void 0,void 0,function(){var s;return r.__generator(this,function(a){switch(a.label){case 0:return[4,new Promise(function(t,r){e(["modules/clean/react/app_actions/education/edu_modal_component"],t,r)}).then(r.__importStar)];case 1:return s=a.sent().AppActionsEduModal,t(n.Modal.showInstance(o.default.createElement(s,{appName:i}))),[2]}})})})}Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),t.asyncShowExtensionsEduModal=i});var __importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};define("modules/clean/react/async_fileops_modals",["require","exports"],function(e,t){"use strict";function r(t){new Promise(function(t,r){e(["modules/clean/react/fileops_modals"],t,r)}).then(__importStar).then(t)}function o(e){r(function(t){return(0,t.showCopy)(e)})}function n(e){r(function(t){return(0,t.showMove)(e)})}function i(e){r(function(t){return(0,t.showUpload)(e)})}function s(e){r(function(t){return(0,t.showAdminUpload)(e)})}function a(t){new Promise(function(t,r){e(["modules/clean/react/folder_dialog/move_dialog_modal"],t,r)}).then(__importStar).then(function(e){return e.MoveDialogModal.show(t)})}Object.defineProperty(t,"__esModule",{value:!0}),t.showCopy=o,t.showMove=n,t.showUpload=i,t.showAdminUpload=s,t.showMoveDialog=a});var __importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};define("modules/clean/react/async_onboarding_move_modal",["require","exports"],function(e,t){"use strict";function r(t){new Promise(function(t,r){e(["modules/clean/react/onboarding_folder_dialog/onboarding_move_dialog"],t,r)}).then(__importStar).then(function(e){return(0,e.showMove)(t)})}function o(t){new Promise(function(t,r){e(["modules/clean/react/onboarding_folder_dialog/onboarding_move_dialog_v2"],t,r)}).then(__importStar).then(function(e){return(0,e.showMoveDialog)(t)})}Object.defineProperty(t,"__esModule",{value:!0}),t.showOnboardingMoveDialog=r,t.showOnboardingMoveDialogV2=o}),define("modules/clean/react/browse/actions",["require","exports","tslib","external/immutable","modules/clean/cloud_docs/open_with_utils","modules/clean/cloud_docs/preferred_editor_utils","modules/clean/cloud_docs/types","modules/clean/downloads","modules/clean/file_operations/notifications","modules/clean/filepath","modules/clean/flux/dispatcher","modules/clean/history","modules/clean/react/async_file_modal_controller","modules/clean/react/browse/action_logger","modules/clean/react/browse/api","modules/clean/react/browse/constants","modules/clean/react/browse/data/action_creators","modules/clean/react/browse/data/helpers","modules/clean/react/browse/data/selectors","modules/clean/react/browse/data/store","modules/clean/react/browse/models","modules/clean/react/file_uploader/constants","modules/clean/react/file_viewer/async_controller","modules/clean/react/fileops_actions","modules/clean/react/files_view/types","modules/clean/react/share_download/api","modules/clean/react/snackbar","modules/clean/sharing/browse_exports","modules/clean/user_education/user_education_client","modules/constants/python","modules/core/i18n"],function(e,t,r,o,n,i,s,a,l,c,d,u,p,f,_,m,h,S,g,v,E,w,b,T,F,y,C,I,O,R,P){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),a=r.__importStar(a),l=r.__importStar(l),c=r.__importStar(c),u=r.__importDefault(u),p=r.__importStar(p),_=r.__importStar(_),h=r.__importStar(h),g=r.__importStar(g),T=r.__importStar(T),y=r.__importStar(y);var D=(function(){function D(){var n=this;this.initializeEverything=function(e){var t=e.path,r=e.files,i=e.paginatedTotalNumFiles,s=e.context,a=e.mountPoints,l=e.fqPathsToSelect,c=e.loadingState,u=e.teamFolders;n.reduxStore.dispatch(h.setPath({path:t})),n.reduxStore.dispatch(h.appendFiles({path:t,files:r.concat(u)})),n.reduxStore.dispatch(h.setPaginatedTotalNumFiles({paginatedTotalNumFiles:i})),n.reduxStore.dispatch(h.setMountPoints({mountPoints:a})),n.reduxStore.dispatch(h.setLoadingState({loadingState:c,path:t})),c===F.LoadingState.LOADED?n.reduxStore.dispatch(h.selectFilesByFqPath({fqPathsToSelect:l})):n.reduxStore.dispatch(h.setFilePathsToSelectOnNextUpdate({filePathsToSelectOnNextUpdate:o.Set(l)})),n.reduxStore.dispatch(h.setContext({context:s})),d.Dispatcher.dispatch({type:w.UploaderActionType.SET_PATH,data:{path:t,hasPermissionToUploadToFolder:s.isCurrentPathWriteable()}}),d.Dispatcher.dispatch({type:m.SharedWithActionType.BROWSE_FILES_LOADED,data:{parentPath:t,files:r}})},this.addFilesAndSetLoadingState=function(e){var t=e.path,r=e.loadingState,o=e.files,i=e.paginatedTotalNumFiles;n.reduxStore.dispatch(h.appendFiles({path:t,files:o})),n.reduxStore.dispatch(h.setPaginatedTotalNumFiles({paginatedTotalNumFiles:i})),n.reduxStore.dispatch(h.setLoadingState({loadingState:r,path:t})),d.Dispatcher.dispatch({type:m.SharedWithActionType.BROWSE_FILES_LOADED,data:{parentPath:t,files:o}})},this.setUrl=function(e){var t=e.path,r=e.qargs;n.reduxStore.dispatch(h.setUrl({path:t,qargs:r}))},this.nameNewFolder=function(){n.reduxStore.dispatch(h.setNewFolderCreationState({newFolderCreationState:F.NewFolderCreationState.PENDING_INPUT}))},this.createFolderPending=function(){f.logCreateFolderPending(),n.reduxStore.dispatch(h.setNewFolderCreationState({newFolderCreationState:F.NewFolderCreationState.SAVING_INPUT}))},this.cancelCreateFolder=function(){f.logCreateFolderCancel(),n.reduxStore.dispatch(h.setNewFolderCreationState({newFolderCreationState:F.NewFolderCreationState.CREATE_FOLDER_INACTIVE})),window.setTimeout(function(){O.UEClient.sendEvent("CdmNewFolderModal","maybeFinished")},2500)},this.createFolderComplete=function(){f.logCreateFolderSuccess(),n.reduxStore.dispatch(h.setNewFolderCreationState({newFolderCreationState:F.NewFolderCreationState.CREATE_FOLDER_INACTIVE})),C.Snackbar.complete(P._("Folder created."),"browse-action"),window.setTimeout(function(){O.UEClient.sendEvent("CdmNewFolderModal","maybeFinished")},2500)},this.createFolder=function(e){n.reduxStore.dispatch(h.createFolder(e))},this.createFolderInNewFolderModal=function(e){var r=e.folderName,o=e.isConfidential,i=e.user,s=e.context,a=e.redirectOnSuccess,l=e.redirectOnCancel,c=e.fqPath,d=e.selectCreatedFolder,u=s?s.currentFQPath:c,p=s?s.rootNSID:i.root_ns_id;if(o&&s&&!s.isInsideTeamFolderTree)I.asyncShowNewFolderShareModal(i,null,u,r,!1,!1,null,n.setUrl);else{var f=(i.is_cdm_member||o)&&!!s&&s.isInsideTeamFolderTree;t.browseActions.createFolder({pathName:u,folderName:r,nsId:p,checkFSWs:!1,showShareModalOnSuccess:f?n.handleShowShareModal:null,redirectOnSuccess:a,redirectOnCancel:l,selectCreatedFolder:d})}},this.handleNewFolderRedirectOnSuccess=function(e){n.setUrl({path:e})},this.doDeleteFilesWithModal=function(e){var t=e.files,o=e.expDeleteUseApiV2,i=g.user(n.reduxStore.getState()),s=g.context(n.reduxStore.getState());p.showDelete(i,t,s,c.filename(s.currentFQPath),function(){return r.__awaiter(n,void 0,void 0,function(){var e=this;return r.__generator(this,function(r){return o?this.reduxStore.dispatch(h.deleteFiles({files:t.slice(),checkFSWs:!0})):_.deleteFiles({files:t,userId:i.id,onSuccess:function(r){var o=r.changesets;l.notifyDeleteSuccess(t.length,i,o,function(){e.selectRowsFromBoltClient(t)})}}),[2]})})})},this.purgeSuccessCallback=function(e){t.browseActions.reloadCurrentPath()},this.onPurgeBatch=function(t,o){new Promise(function(t,r){e(["modules/clean/react/trash/actions"],t,r)}).then(r.__importStar).then(function(e){(0,e.purgeByPathBatch)(t,o,n.purgeSuccessCallback)})},this.doPermanentDeleteWithModal=function(e){var t=g.user(n.reduxStore.getState()),r=g.context(n.reduxStore.getState());p.showPurgeModal({userId:t.id,context:r,files:e,onPurge:n.onPurgeBatch})},this.onRestore=function(e,t,r){_.restoreFiles({files:t,userId:e,onSuccess:function(){l.notifyRestoreSuccess(t)},isSearchMode:r})},this.doRestoreFilesWithUnifiedTrashModal=function(e){var t=e.files,r=g.user(n.reduxStore.getState()),o=g.context(n.reduxStore.getState());p.showUnifiedTrashModal({userId:r.id,context:o,files:t,onRestore:function(e,t){n.onRestore(e,t,!1)}})},this.handleShowRewindPanel=function(){u.default.update_query_param(m.BrowseQueryArg.rewind,"true"),n.reduxStore.dispatch(h.showTimeline())},this.fetchFolderSizes=function(e){var t=e.file;return r.__awaiter(n,void 0,Promise,function(){var e,o,n,i,s,a,l,c,d;return r.__generator(this,function(r){switch(r.label){case 0:e=g.user(this.reduxStore.getState()),o=m.MAX_FOLDER_SIZE_ITERATIONS,r.label=1;case 1:return r.trys.push([1,7,,8]),this.reduxStore.dispatch(h.requestFolderSizes({fqPath:t.fq_path})),[4,_.fetchSharedFolderSizes(e.id,{fq_path:t.fq_path})];case 2:return n=r.sent(),this.reduxStore.dispatch(h.setFolderSizesPending({fetchFolderSizesResp:n})),i=[],[4,this.fetchAndSetSameNamespaceFolderSize(e.id,{fq_path:t.fq_path,folder_limit:m.MAX_FOLDERS_PER_CALL})];case 3:s=r.sent(),s.queue&&(i=i.concat(s.queue)),r.label=4;case 4:return i.length>0&&o>0?(o--,a=Math.min(m.MAX_FOLDER_SIZE_QUEUE_SIZE,i.length),l=i.splice(0,a),[4,this.fetchAndSetSameNamespaceFolderSize(e.id,{fq_path:t.fq_path,folder_limit:m.MAX_FOLDERS_PER_CALL,queue:l})]):[3,6];case 5:return s=r.sent(),s.queue&&i&&(i=i.concat(s.queue)),[3,4];case 6:return c=0!==o&&s.queue&&0===s.queue.length?F.FetchFolderSizeState.COMPLETE:F.FetchFolderSizeState.ERROR,this.reduxStore.dispatch(h.completeFolderSizes({fetchFolderSizeState:c})),[3,8];case 7:return d=r.sent(),this.reduxStore.dispatch(h.setFolderSizesPending({fetchFolderSizesResp:{sizes_dict:[{fq_path:t.fq_path,size:0}],queue:[]}})),this.reduxStore.dispatch(h.completeFolderSizes({fetchFolderSizeState:F.FetchFolderSizeState.ERROR})),[3,8];case 8:return[2]}})})},this.fetchMultipleFolderSizes=function(e){var t=e.files;return r.__awaiter(n,void 0,Promise,function(){var e,o,n;return r.__generator(this,function(r){switch(r.label){case 0:e=0,o=t.toArray(),r.label=1;case 1:return e<o.length?(n=o[e],[4,this.fetchFolderSizes({file:n})]):[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}})})},this.handleShowShareModal=function(e,t){var r=g.user(n.reduxStore.getState()),o=g.context(n.reduxStore.getState());I.asyncShowShareModal(r,e,{browseContext:o,origin:t},n.setUrl)},this.reduxStore=v.getStoreForBrowse()}return D.prototype.reloadCurrentPath=function(){this.setUrl({path:g.path(this.reduxStore.getState()),qargs:{reload:!0}})},D.prototype.selectRowsFromBoltClient=function(e){void 0===e&&(e=[]),this.reduxStore.dispatch(h.setFilePathsToSelectOnNextUpdate({filePathsToSelectOnNextUpdate:o.Set(e.map(function(e){return e.fq_path}))}))},D.prototype.copyFiles=function(e){T.copyFiles(e)},D.prototype.moveFiles=function(e){T.moveFiles(e)},D.prototype.selectFilesAfterUpload=function(e){var t=e.fqPathsToSelect,r=g.unsortedFilesWithFolderSizes(this.reduxStore.getState());t.every(function(e){return r.has(e)})?this.reduxStore.dispatch(h.selectFilesByFqPath({fqPathsToSelect:t})):this.reduxStore.dispatch(h.setFilePathsToSelectOnNextUpdate({filePathsToSelectOnNextUpdate:o.Set(t)}))},D.prototype.selectFilesByFqPath=function(e){var t=e.fqPathsToSelect;this.reduxStore.dispatch(h.selectFilesByFqPath({fqPathsToSelect:t}))},D.prototype.navigateToFileOrFolder=function(e){var t=this,r=e.file,o=e.shouldFocusComment,n=void 0!==o&&o,s=e.onFileViewerUnmount,a=e.fileViewAction,l=void 0===a?R.FileViewActionType.CLICK:a,c=e.fileViewOrigin,d=void 0===c?R.FileViewOriginType.BROWSE:c,u=e.preferredEditors,f=g.user(this.reduxStore.getState()),_=g.context(this.reduxStore.getState());if(r.isDeleted)this.doRestoreFilesWithUnifiedTrashModal({files:[r]});else if(r.is_dir)E.File.isNoAccessSharedFolder(r)?p.showNoAccess(f,r,_):this.setUrl({path:r.fq_path});else{var m=function(){t.openPreviewForBrowseFile(r,n,f,l,d,s)};!n&&u&&i.hasPreferredEditorSupport(r)?i.openInPreferredEditor(f,r,u,m,{fileViewAction:l,fileViewOrigin:d}):m()}},D.prototype.openPreviewForBrowseFile=function(e,t,r,o,i,a){var l=this,c=S.getIndexOfFile(e,this.reduxStore.getState()),d=c<0?[e]:g.sortedFilesWithFolderSizes(this.reduxStore.getState()).toArray();if(c<0?c=0:d[c]=e,e.is_cloud_doc)n.openCloudDoc(e,r,o===R.FileViewActionType.SEARCH?s.WebSearchSource:s.WebBrowseSource);else{var u,p=function(){b.showElementsBehindFileViewer(),l.reduxStore.dispatch(h.setIsFileViewerShown({isShown:!1})),a&&a(),u&&u.focus()},f=function(){u=document.querySelector(":focus"),b.hideElementsBehindFileViewer(),l.reduxStore.dispatch(h.setIsFileViewerShown({isShown:!0}))};b.asyncOpenPreview({containerId:m.BROWSE_FILE_VIEWER_ELEMENT_ID,files:d,indexOfPreviewFile:c,shouldFocusComment:t,user:r,onFileViewerDidMount:f,onFileViewerUnmount:p,fileViewAction:o,fileViewOrigin:i,fileViewTarget:R.FileViewTargetType.PRIVATE})}},D.prototype.navigateToResultObjectParentFolder=function(e){var t=e.file,r=e.fileViewAction;void 0===r&&R.FileViewActionType.CLICK;if(E.File.isNoAccessSharedFolder(t))p.showNoAccess(g.user(this.reduxStore.getState()),t,g.context(this.reduxStore.getState()));else{var o=c.parent_dir(t.fq_path);this.setUrl({path:o})}},D.prototype.navigateToParentFolder=function(){var e=c.parent_dir(g.path(this.reduxStore.getState()));this.setUrl({path:e})},D.prototype.setShouldShowDeletedFiles=function(e){e.shouldShowDeletedFiles?u.default.update_query_param(m.BrowseQueryArg.d,"1"):u.default.remove_query_param(m.BrowseQueryArg.d)},D.prototype.downloadFiles=function(e){var t=e.files,o=e.context,n=e.user;return r.__awaiter(this,void 0,void 0,function(){var e,i,s,l,c;return r.__generator(this,function(r){switch(r.label){case 0:return 1!==t.count()||t.first().is_dir?[3,4]:(e=t.first(),e instanceof E.FileSharedWithMe?[4,y.fetchDownloadUrl(e.href)]:[3,2]);case 1:return s=r.sent(),[3,3];case 2:s=e.href,r.label=3;case 3:
return i=s,a.get({url:i}),[2];case 4:return o.blockHash?(l=o.currentFQPath,c=t.toArray().map(function(e){return e.fq_path}),a.get_zip({fq_paths:c,subject_uid:n.id,block_hash:o.blockHash,parent_path:l}),[2]):[2]}})})},D.prototype.fetchAndSetSameNamespaceFolderSize=function(e,t){return r.__awaiter(this,void 0,Promise,function(){var o;return r.__generator(this,function(r){switch(r.label){case 0:return[4,_.fetchSameNamespaceFolderSizes(e,t)];case 1:return o=r.sent(),this.reduxStore.dispatch(h.setFolderSizesPending({fetchFolderSizesResp:o})),[2,o]}})})},D})();t.browseActions=new D}),define("modules/clean/react/browse/api",["require","exports","tslib","modules/clean/ajax","modules/clean/filepath","external/lodash","modules/core/i18n","modules/clean/react/browse/models","modules/core/html","modules/core/notify","modules/core/uri","modules/clean/api_v2/user_client"],function(e,t,r,o,n,i,s,a,l,c,d,u){"use strict";function p(e){try{return JSON.parse(e)}catch(e){if(!(e instanceof SyntaxError))throw e}return null}function f(e){var t=e.sortLabel,r=e.sortIsAscending,n=e.path,i=e.userId,s=e.onSuccess,a=e.includeDeletedFiles,l=void 0!==a&&a,c=e.sortFoldersFirst,d=void 0===c||c,u=e.onError;return o.WebRequest({data:{sort_label:t,sort_is_ascending:r.toString(),show_deleted:l||"",sort_folders_first:d,include_file_info:"True",path2:n},url:"/browse",subject_user:i,success:function(e,t,r){var o=p(e);o&&s({path:n,data:o,xhr:r})},error:function(e,t,r){u&&u(e,t,r)}})}function _(e){var t=e.files,r=e.newPath,n=e.userId,l=e.onSuccess,d=e.checkFSWs,u=t.map(function(e){return e.fq_path});return u.includes(r)?(c.Notify.error(s._("You can’t copy a folder into itself.")),null):o.WebProgressRequest({url:"/cmd/copy",data:{files:u,to_path:r,fsw_request:d?"check":void 0},subject_user:n,progress_text:s._("Copying files..."),success:function(e){try{var t=i.isString(e)?JSON.parse(e):e;l({newFiles:t.new_browse_files?t.new_browse_files.map(a.File.fromServerObject):[],destinationPath:r,changesets:t.changesets,failureDetails:t.failure_details})}catch(e){}}})}function m(e){var t=e.files,r=e.userId,n=e.onSuccess,a=t.map(function(e){return e.fq_path});return o.WebProgressRequest({url:"/cmd/delete",data:{files:a},subject_user:r,progress_text:s._("Deleting files..."),success:function(e){try{var r=i.isString(e)?JSON.parse(e):e;n({fileDeltas:t.map(function(e){return{before:e,after:null}}),changesets:r.changesets})}catch(e){}}})}function h(e,t){return r.__awaiter(this,void 0,Promise,function(){var o;return r.__generator(this,function(r){o=2;try{return"/"===e&&(e=""),[2,(new u.UserApiV2Client).ns("chronicle").rpc("can_rewind",{path:e,version:o},{subjectUserId:t})]}catch(e){return[2,{can_rewind:!1}]}return[2]})})}function S(e){var t=e.path,r=e.files,d=e.newPath,u=e.userId,p=e.onSuccess,f=e.allowOwnershipTransfer,_=e.checkFSWs;if(void 0!==t&&n.paths_are_equal(t,d))return c.Notify.error(s._("Those files already exist in that folder.")),null;var m=r.map(function(e){return e.fq_path});return m.includes(d)?(c.Notify.error(s._("You can’t move a folder into itself.")),null):o.WebProgressRequest({url:"/cmd/move",data:{files:m,to_path:d,allow_ownership_transfer:f,fsw_request:_?"check":void 0},subject_user:u,progress_text:s._("Moving files..."),skipNotifyError:!f,success:function(e){try{var r=i.isString(e)?JSON.parse(e):e;p({path:t,destinationPath:d,newFiles:r.new_browse_files?r.new_browse_files.map(a.File.fromServerObject):[],changesets:r.changesets,failureDetails:r.failure_details})}catch(e){}},error:function(t,r,o){c.Notify.error(new l.HTML(o)),e.onError&&e.onError(o)}})}function g(e){var t=e.files,r=e.userId,n=e.onSuccess,i=e.isSearchMode;return o.WebProgressRequest({url:"/cmd/restore",data:{files:t.map(function(e){return e.fq_path}),source:i?"search":"browse"},subject_user:r,dataType:"text",progress_text:s._("Restoring…"),success:function(){n()}})}function v(e){var t=e.userId,r=e.changesets,n=void 0===r?null:r,i=e.progressText,s=e.onSuccess;return o.WebProgressRequest({url:"/cmd/rollback",data:{ns_to_cs:JSON.stringify(n)},subject_user:t,progress_text:i,success:function(){s()}})}function E(e){var t=e.pathName,r=e.folderName,n=e.userId,i=e.onSuccess,s=e.onError,l=e.checkFSWs;return o.WebProgressRequest({url:new d.URI({path:"/cmd/new"+t}).toString(),data:{to_path:r,folder:"yes",fsw_request:l?"check":void 0},subject_user:n,success:function(e){var t=p(e);if(t){var r=t.new_browse_files?a.File.fromServerObject(t.new_browse_files[0]):null;i({changesets:t.changesets,createdFolder:r,failureDetails:t.failure_details})}},error:function(){s()}})}function w(e){var t=e.pathName,r=e.title,n=e.documentType,i=e.userId,s=e.onSuccess,l=e.onError,c=e.checkFSWs,u=e.actionSource,f=(t+"/"+r+"."+n).replace("//","/");return o.WebRequest({url:new d.URI({path:"/cmd/create_cloud_doc"}).toString(),subject_user:i,data:{to_path:f,title:r,fsw_request:c?"check":void 0,action_source:u},success:function(e){var t=p(e);if(t){s({changesets:null,createdFile:t.new_browse_files?a.File.fromServerObject(t.new_browse_files[0]):null,failureDetails:t.failure_details})}},error:function(e,t,r){l(r)},skipNotifyError:!0})}function b(e){var t=e.path,r=e.userId,n=e.namespaceToJournalIdMap,s=e.onSuccess,a=e.includeDeletedFiles,l="/"===t?"":t,c={fq_dir:l,ns_map:i.map(n,function(e,t){return t+"_"+e}).join(","),show_deleted:!!a};return o.WebRequest({url:"/update/list_dir",subject_user:r,data:c,dataType:"text",success:function(e){var t=p(e);t&&s(t)}})}function T(e,t){return(new u.UserApiV2Client).ns("folders").rpc("get_shared_subfolder_sizes",t,{subjectUserId:e})}function F(e,t){return(new u.UserApiV2Client).ns("folders").rpc("get_subfolder_sizes_in_same_namespace",t,{subjectUserId:e})}Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),n=r.__importStar(n),i=r.__importStar(i),t.loadPath=f,t.copyFiles=_,t.deleteFiles=m,t.isRewindButtonEnabled=h,t.moveFiles=S,t.renameFile=function(e){var t=e.file,r=e.name,n=e.user,i=e.checkFSWs;return new Promise(function(e,s){o.WebRequest({url:new d.URI({path:"/cmd/rename"+t.fq_path}).toString(),subject_user:n.id,data:{to_path:r,fsw_request:i?"check":void 0},success:function(r){var o=p(r);if(o){var n=o.new_browse_files?t.merge(o.new_browse_files[0]):"";e({changesets:o.changesets,renamedFile:n,failureDetails:o.failure_details})}else s(r)},error:s})})},t.restoreFiles=g,t.rollbackChangeSets=v,t.createNewFolder=E,t.createCloudDoc=w,t.getChangesForDirectory=b,t.fetchSharedFolderSizes=T,t.fetchSameNamespaceFolderSizes=F}),define("modules/clean/react/browse/async_extensions",["require","exports","tslib","modules/clean/web_timing_logger","modules/clean/redux/store"],function(e,t,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(){function t(){var e=this;this.initOnce=!1,this.emptyState={},this.sharingServiceInfo=function(){return e.emptyState},this.getFeatureFlags=function(){return e.emptyState},this.initializeStore=function(t,r){return e.files=r,e.user=t,n.getStoreAndRegisterReducers({})}}return t.prototype.init=function(){var e=this;this.initOnce||(o.waitForTTI().then(function(){return e.loadExtensionsStore()}),this.initOnce=!0)},t.prototype.loadExtensionsStore=function(){return r.__awaiter(this,void 0,void 0,function(){var t,o,n,i,s,a,l;return r.__generator(this,function(c){switch(c.label){case 0:return[4,Promise.all([new Promise(function(t,r){e(["modules/clean/react/extensions/data/store"],t,r)}).then(r.__importStar),new Promise(function(t,r){e(["modules/clean/react/extensions/data/selectors"],t,r)}).then(r.__importStar)])];case 1:return t=c.sent(),o=t[0],n=o.getStore,i=o.initializeStore,s=t[1],a=s.sharingServiceInfo,l=s.getFeatureFlags,n(),this.sharingServiceInfo=a,this.getFeatureFlags=l,this.initializeStore=i,this.user&&this.initializeStore(this.user,this.files),[2]}})})},t})();t.asyncExtensions=new i}),define("modules/clean/react/browse/browse",["require","exports","tslib","external/react-redux","react","modules/clean/react/browse/async_extensions","modules/clean/react/browse/controller","modules/clean/react/browse/data/action_creators","modules/clean/react/browse/data/selectors","modules/clean/react/browse/data/folder_overview_selectors","modules/clean/react/browse/data/store","modules/clean/react/files_view/data/action_creators","modules/clean/react/files_view/data/selectors","modules/clean/react/files_view/data/store","modules/clean/react/folder_overview/data/action_creators","modules/clean/react/retrieval_success_banner/data/selectors","modules/clean/react/retrieval_success_banner/data/store","modules/clean/search/search_bar/data/action_creators","modules/clean/search/search_bar/data/selectors","modules/clean/viewer","modules/clean/web_timing_logger"],function(e,t,r,o,n,i,s,a,l,c,d,u,p,f,_,m,h,S,g,v,E){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importDefault(n),a=r.__importStar(a),l=r.__importStar(l),c=r.__importStar(c),u=r.__importStar(u),p=r.__importStar(p),_=r.__importStar(_),S=r.__importStar(S),g=r.__importStar(g),E=r.__importStar(E);var w=function(e){var t=l.context,r=l.sortedFilesWithFoldersSizesWithoutTeamFolders,o=l.sortedFilesWithFolderSizes,n=l.teamFolders,s=l.path,a=l.selection,d=l.selectedFiles,u=l.shouldShowDeletedFiles,f=l.shouldShowSharedFolderInvites,_=l.newFolderCreationState,h=l.isTimelineVisible,S=l.optedInToRewind,v=l.sortOrder,E=l.urlPrefix,w=l.canDisplayFolderSizes,b=l.isQueryingFolderSizes,T=l.user,F=l.viewer,y=l.browsePostTTIExperiments,C=l.mountPoints,I=l.isFileJumping,O=l.clickTimelineTimestamp,R=c.paginatedTotalNumFiles,P=c.loadingState,D=c.shouldShowPinnedTeamFolders,N=c.folderOverviewPinnedItems,A=p.viewType,L=p.viewTypeColumns,x=g.searchSessionId,M=g.isSearchBarFocused;return i.asyncExtensions.init(),{files:o(e),filesWithoutTeamFolders:r(e),teamFolders:n(e),paginatedTotalNumFiles:R(e),loadingState:P(e),path:s(e),fileRename:p.fileRename(e),shouldShowDeletedFiles:u(e),shouldShowPinnedTeamFolders:D(e),shouldShowSharedFolderInvites:f(e),isTextSelectable:!!p.fileRename(e),createNewFolderState:_(e),isTimelineVisible:h(e),clickTimelineTimestamp:O(e),optedInToRewind:S(e),currentSort:v(e),urlPrefix:E(e),canDisplayFolderSizes:w(e),viewTypeColumns:L(e),isQueryingFolderSizes:b(e),user:T(e),viewer:F(e),browsePostTTIExperiments:y(e),browseContext:t(e),selection:a(e),selectedFiles:d(e),mountPoints:C(e),isFileJumping:I(e),searchSessionId:x(e),isSearchBarFocused:M(e),viewType:A(e),sharingServiceInfo:i.asyncExtensions.sharingServiceInfo(e),extensionsFeatureFlags:i.asyncExtensions.getFeatureFlags(e),shouldShowRetrievalSuccessBanner:m.isRetrievalSuccessBannerVisible(e),pinnedItems:N(e),contentScroll:l.shouldMainContentScroll(e),isCreateButtonMoveEnabled:!!l.isCreateButtonMoveEnabled(e),emptyFolder:c.emptyFolder(e)}},b={addFileJumpKeyCode:a.addFileJumpKeyCode,appendFiles:a.appendFiles,applyBoltUpdates:a.applyBoltUpdates,blurSearchBar:S.blurSearchBar,clearFiles:a.clearFiles,clearSearchBar:S.clearSearchBar,copyFilesToClipboard:a.copyFilesToClipboard,optInToRewind:a.optInToRewind,setIsRewindButtonEnabled:a.setIsRewindButtonEnabled,hideTimeline:a.hideTimeline,pasteFilesFromClipboard:a.pasteFilesFromClipboard,renameFile:a.renameFile,resetFileJumpFilter:a.resetFileJumpFilter,setAndStoreSortOrder:a.setAndStoreSortOrder,setBrowsePostTTIExperiments:a.setBrowsePostTTIExperiments,setBrowseScope:S.setBrowseScope,setCanDisplayFolderSizes:a.setCanDisplayFolderSizes,setFileCategories:S.setFileCategories,setFileRename:u.setFileRename,setLoadingState:a.setLoadingState,setMountPoints:a.setMountPoints,setPath:a.setPath,setPathData:a.setPathData,setSearchBarExperiments:S.setExperiments,setSearchQuery:S.setSearchQuery,setSelection:a.setSelection,setShouldShowDeletedFiles:a.setShouldShowDeletedFiles,setUrl:a.setUrl,setViewType:u.setViewType,setViewTypeColumns:u.setViewTypeColumns,setViewTypeScope:u.setViewTypeScope,showTimeline:a.showTimeline,handleFolderOverviewPrefetch:_.handlePrefetch,addFolderOverviewLoadedComponent:_.addLoadedComponent},T=o.connect(w,b)(s.BrowseController),F=(function(e){function t(t){var r=e.call(this,t)||this;E.log_js_modules_application_code_start(),f.getStoreForFilesView(),h.getStoreForSuccessBanner(),r.reduxStore=d.getStoreForBrowse();var o=v.Viewer.get_viewer(),n=o.get_user_by_id(t["user-id"]);return r.reduxStore.dispatch(u.loadViewTypes({user:n})),r.reduxStore.dispatch(u.loadViewTypeColumns({user:n})),r.reduxStore.dispatch(a.setPath({path:t["init-fq-path"]||"/"})),r.reduxStore.dispatch(a.appInit({experiments:t["exp-browse-experiments"]||{},shouldShowDeletedFiles:!!t["should-show-deleted-files"],user:n,viewer:o})),r}return r.__extends(t,e),t.prototype.render=function(){return n.default.createElement(o.Provider,{store:this.reduxStore},n.default.createElement(T,r.__assign({},this.props)))},t})(n.default.PureComponent);t.BrowseApp=F,t.RootComponent=function(e){var t=e.webTimingLoggerProps,o=r.__rest(e,["webTimingLoggerProps"]);return E.initialize_module(t),n.default.createElement(F,r.__assign({},o))}}),define("modules/clean/react/browse/browse_prefetch_loader",["require","exports","tslib","modules/core/exception","modules/clean/react/files_view/types","modules/clean/react/browse/models","modules/clean/pagination_manager","modules/core/notify","modules/clean/web_timing_logger"],function(e,t,r,o,n,i,s,a,l){"use strict";function c(e){if(0===e.indexOf("err:")){var t=e.substr("err:".length);a.Notify.error(t)}}Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),l=r.__importStar(l);var d=(function(){function e(e,t,r,a){var d=this,u=e.user,p=e.path,f=e.fqPathsToSelect,_=t.onPrefetchComplete,m=t.onPrefetchError,h=t.onLoadComplete,S=t.onPostTTIPrefetchComplete,g=t.onPostTTIPrefetchError,v=r.onInitializeEverything,E=r.onAddFilesAndSetLoadingState;void 0===a&&(a=window),this.isPrefetching=function(){return!!d.browsePreloadHandler&&!!d.firstPagePreloadHandler},this.handlePrefetch=function(){o.assert(d.isPrefetching(),"trying to handle prefetching and think we aren't prefetching at the same time.  something is wrong"),d.browsePreloadHandler(d.handlePrefetchDataSuccess,d.onPrefetchError),l.waitForTTI().then(function(){d.postTTIPreloadHandler(d.handlePostTTIDataSuccess,d.onPostTTIPrefetchError)})},this.handlePostTTIDataSuccess=function(e){var t=void 0;try{t=JSON.parse(e)}catch(e){return void d.onPostTTIPrefetchError(e)}if(!t)return void d.onPostTTIPrefetchError();d.onPostTTIPrefetchComplete(t)},this.handlePrefetchDataSuccess=function(e){var t=d.extractAjaxInitData(e);if(!t)return void d.onPrefetchError();var r=i.BrowseContext.fromServerObject(t);d.firstPagePreloadHandler(function(e){d.handleFirstPagePrefetchDataSuccess(e,t,r)},d.onPrefetchError)},this.handleFirstPagePrefetchDataSuccess=function(e,t,r){var o=d.extractAjaxFileInfo(e);if(!o)return void d.onPrefetchError();var s=[],a=0,l=n.LoadingState.LOADING_FIRST_PAGE,c=o.file_info,u=o.first_page;u?(s=[],a=u.total_num_items,l=n.LoadingState.LOADING_REMAINING_PAGES):c&&(s=c,a=s.length,l=n.LoadingState.LOADED),d.onInitializeEverything({path:d.path,files:s.map(i.File.fromServerObject),paginatedTotalNumFiles:a,context:r,mountPoints:t.ns_id_to_mount_point,fqPathsToSelect:d.fqPathsToSelect,loadingState:l,teamFolders:t.team_folders_js_info&&t.team_folders_js_info.map(i.File.fromServerObject)}),u?d.initializePaginationManager(u):d.onLoadComplete(),d.onPrefetchComplete(t)},this.extractAjaxInitData=function(e){var t=void 0;try{t=JSON.parse(e)}catch(t){c(e)}return t},this.extractAjaxFileInfo=function(e){var t=void 0;try{t=JSON.parse(e)}catch(t){c(e)}return t},this.initializePaginationManager=function(e){var t=e.total_num_items,r=s.PaginationManager.create({firstPage:e,keyName:"sjid",ajaxURL:"/browse_get_next",userID:d.user.id,newDataAvailableCallback:function(e,r){var o=e.areAllItemsReady(),s=o?n.LoadingState.LOADED:n.LoadingState.LOADING_REMAINING_PAGES;d.onAddFilesAndSetLoadingState({path:d.path,files:r.map(i.File.fromServerObject),paginatedTotalNumFiles:t,loadingState:s}),o&&(e.stopAutoFetching(),d.onLoadComplete())}});l.waitForTTI().then(function(){return r.startAutoFetching()})},this.user=u,this.path=p,this.fqPathsToSelect=f,this.onPrefetchComplete=_,this.onPrefetchError=m,this.onLoadComplete=h,this.onPostTTIPrefetchComplete=S,this.onPostTTIPrefetchError=g,this.onInitializeEverything=v,this.onAddFilesAndSetLoadingState=E,this.browsePreloadHandler=a.__REGISTER_BROWSE_PRELOAD_HANDLER,this.firstPagePreloadHandler=a.__REGISTER_BROWSE_FIRST_PAGE_PRELOAD_HANDLER,this.postTTIPreloadHandler=a.__REGISTER_BROWSE_POST_TTI_PRELOAD_HANDLER}return e})();t.BrowsePrefetchLoader=d}),define("modules/clean/react/browse/browse_view",["require","exports","tslib","classnames","external/immutable","react","modules/clean/cloud_docs/constants","modules/clean/cloud_docs/new_file_menu","modules/clean/analytics","modules/clean/browse_uri_interface","modules/clean/filepath","modules/clean/filetypes","modules/clean/react/async/loadable","modules/clean/react/browse/action_logger","modules/clean/react/browse/constants","modules/clean/react/browse/logger_util","modules/clean/react/browse/sidebar_view","modules/clean/react/browse/title","modules/clean/react/browse/uri_helper","modules/clean/react/browse/web_team_sharing_experiment","modules/clean/react/education/education_module_experiment","modules/clean/react/file_uploader/file_uploader","modules/clean/react/files_view/constants","modules/clean/react/files_view/controller","modules/clean/react/files_view/types","modules/clean/react/files_view/util","modules/clean/react/folder_overview/connected","modules/clean/react/growth/connected_checklist_banner","modules/clean/react/growth/education_module_experiment","modules/clean/react/maestro/search","modules/clean/upsell/top_notification_listener","modules/clean/react/retrieval_success_banner/constants","modules/clean/react/retrieval_success_banner/retrieval_success_browseview_banner","modules/clean/react/retrieval_success_banner/util","modules/clean/react/snackbar","modules/clean/react/snackbar_manager","modules/clean/search/types","modules/clean/sharing/access_level","modules/clean/sharing/shared_folder_invite/shared_folder_invite_async","modules/clean/user_education/user_education_client","modules/clean/web_timing_logger","modules/clean/web_user_action_events","modules/core/browser","modules/core/i18n"],function(e,t,r,o,n,i,s,a,l,c,d,u,p,f,_,m,h,S,g,v,E,w,b,T,F,y,C,I,O,R,P,D,N,A,L,x,M,U,k,B,V,H,W,q){"use strict";function G(e){var t=e.selectedFiles,r=e.context,o=e.isDraggingInternalFiles,n=e.isDraggingExternalFiles,i=e.isUploadModalOpen;return r.isInsideSharedFolder&&Y.includes(r.currentSharedFolderPermissionRole)?F.DropTargetHighlightMode.NONE:o?t.some(function(e){return e.isDeleted||e.type===u.FileTypes.TEAM_SHARED_FOLDER})?F.DropTargetHighlightMode.NONE:t.some(function(e){return e.type===u.FileTypes.SHARED_FOLDER})?r.currentNSAllowsNesting?F.DropTargetHighlightMode.NONSELECTED_FOLDERS:F.DropTargetHighlightMode.NONSELECTED_NONSHARED_FOLDERS:F.DropTargetHighlightMode.NONSELECTED_FOLDERS:n&&!i?F.DropTargetHighlightMode.ALL_FOLDERS:F.DropTargetHighlightMode.NONE}function z(){var e=document.querySelector("#embedded-app");return e?e.parentElement:null}var j=this;Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),n=r.__importStar(n),i=r.__importDefault(i),d=r.__importStar(d),f=r.__importStar(f),m=r.__importStar(m),W=r.__importStar(W);var Y=[U.NameSpaceAccess.ACCESS_NO_ACCESS,U.NameSpaceAccess.ACCESS_READER,U.NameSpaceAccess.ACCESS_READER_NO_COMMENT];t.getCurrentDropTargetHighlightMode=G;var Q=(function(p){function U(e){var t=p.call(this,e)||this;return t.scrollContainer=i.default.createRef(),t.snackbarManager=i.default.createRef(),t.handleGetOverflowMenuActions=function(e,r,o){var i=t.handleGetFileActionsForSetOfFiles(n.Set([e]),r,o,!1,!1,t.props.browsePostTTIExperiments.expRewindUpsell),s=new Array;return i.forEach(function(e){"function"!=typeof e&&s.push(e)}),[s]},t.handleGetFileActionsForSetOfFiles=function(e,r,o,n,i,s){var a=t.props,l=a.context,c=a.user,d=a.actionHandlers,u=a.isOverFreeQuota,p=a.hasExcludedNsIds,f=a.isQueryingFolderSizes,_=a.browsePostTTIExperiments,m=a.viewType,h=a.extensionsFeatureFlags,S=a.sharingServiceInfo,g=a.pinnedItems,v=a.isCreateButtonMoveEnabled,E=t.state.fileActionsModule;if(!E)return[];var w=_.expShowAddToTransfer,b=_.expShowAddFolderToTransfer,T=_.expShowTransferBrowseEntryOnboarding,F=_.expShowRequestFiles,y=_.expListSubfoldersWithOdyssey,C=_.expShowFileLocking,I=_.expDeleteUseApiV2,O=_.expMoveUseApiV2,R=_.expCopyUseApiV2,P=t.props.browseExperiments.expFolderHistoryRollbacks,D=t.props.browseExperiments,N=D.expSearchSuccessBanner,A=D.expBrowseSuccessBanner;return E.getActionsForFileCollection({files:e,context:l,user:c,viewType:m,sharingServiceInfo:S,extensionsFeatureFlags:h,canDisplayFolderSizes:r,actionHandlers:d,skipSharing:!1,isSearchMode:!1,isOverFreeQuota:u,hasExcludedNsIds:p,isQueryingFolderSizes:f,canShowUJPopup:n,isSidebar:i,responsive:o,useSearchSuccessBanner:!!N,expBrowseSuccessBanner:A,pinnedItems:g,expFolderHistoryRollbacks:P,expRewindUpsell:s,showAddToTransfer:!!w,showAddFolderToTransfer:!!b,showTransferBrowseEntryOnboarding:!!T,showRequestFiles:!!F,expListSubfoldersWithOdyssey:!!y,expShowFileLocking:C,expDeleteUseApiV2:!!I,expCopyUseApiV2:!!R,expMoveUseApiV2:!!O,isCreateButtonMoveEnabled:!!v,forceSplitShareSecondary:!0})},t.handleLocationLinkClick=function(e,r){if(!r){var o=d.parent_dir(e.fq_path);t.props.onNavigateToPath(o)}},t.handleOpenPaper=function(e){W.redirect(e.url)},t.handleUploadButtonClick=function(e){w.FileUploaderController.setPath(t.props.path),w.FileUploaderController.handleUploadButtonClick(e)},t.handleShowFileUploader=function(){w.FileUploaderController.setPath(t.props.path),w.FileUploaderController.showModal()},t.handleSelectionChange=function(e){var r=t.props.getFileByFullPath(e.selected.first());if(r){var o=r.ns_id,n=r.sjid,i=r.file_id,s=r.fq_path,a=r.bytes,l=r.ext,c=r.request_id;f.logSelectRow({uid:t.props.user.id,entity_type:r.is_dir?"folder":"file",view_type:t.props.viewType,file_nsid:o,file_sjid:n,file_id:i,file_name:d.filename(r.fq_path),file_path:s,file_size:a,file_extension:l,request_id:c})}t.props.onSelectionChange({selection:e})},t.handleFileListSortChange=function(e,r){f.logSortRecords({uid:t.props.user.id,sort_by:e,sort_direction:r,view_type:t.props.viewType}),t.props.onSortFiles({sortField:e,sortDirection:r})},t.handleStarClick=function(e,r){var o=r?H.WebUserActionLogEvent.STAR:H.WebUserActionLogEvent.REMOVE_STAR,n=t.props,i=n.user,s=n.viewType,a=n.selectedFiles,l=n.browseExperiments,c=m.countFilesAndFolders(a),d=c.num_files_selected,u=c.num_folders_selected;f.logBrowseAction({uid:i.id,source:"BROWSE",action:o,num_files_selected:d,num_folders_selected:u,view_type:s,result:e});var p=l.expSearchSuccessBanner,_=l.expBrowseSuccessBanner;t.showRetrievalSuccessBanner(!!p,!1,_,H.WebUserActionLogEvent.STAR)},t.handleFocusSearchBar=function(){document.getElementsByClassName("search__input")[0].focus()},t.renderSharedWithController=function(e,r){var o=t.props,n=o.context,s=o.user,a=t.state.sharedWithModule;if(!a)return null;if(e.type===u.FileTypes.TEAM_SHARED_FOLDER&&("archived"===e.team_folder_status||"archive_in_progress"===e.team_folder_status))return null;var l=t.props.selectedFiles,c=!!l.size,d=a.SharedWithController;return i.default.createElement("div",{className:"brws-vertically-center brws-shared-with-wrapper"},i.default.createElement(d,{file:e,browseContext:n,inSelectMode:c,user:s,tabIndex:r}))},t.getPageHeaderHeight=function(e,t){return(e.isMatchedLarge||e.isMatchedMedium?_.DEFAULT_PAGE_HEADER_HEIGHT:_.COMPACT_PAGE_HEADER_HEIGHT+40)+(t?48:0)},t.handleFixedHeaderHeightChange=function(e){t.setState({fixedHeaderHeight:e})},t.isRootFileView=function(){return d.paths_are_equal(t.props.context.currentFQPath,"/")},t.isExpGrowthTcBizChecklistUiRevampEnabled=function(){return!!t.props.browseExperiments.expGrowthTcBizChecklistUiRevamp&&t.isRootFileView()},t.showRetrievalSuccessBanner=function(e,t,r,o){e&&t?A.setSearchSuccessBannerVisible():r!==M.BrowseSuccessBannerVariants.V2||t||A.setBrowseSuccessBannerVisible(o)},t.handleSidebarContextMenuClick=function(){var e=t.props,r=e.selectedFiles,o=e.user,n=e.viewType,i=r?r.count(function(e){return e.is_dir}):0,s=r?r.count()-i:0;f.logContextMenuClick({uid:o.id,viewType:n,action_surface:H.ActionSurfaceLogValue.RIGHT_SIDEBAR,numFilesSelected:s,numFoldersSelected:i})},t.onFolderOverviewNavigateToFileOrFolder=function(e){return t.props.onNavigateToFileOrFolder(e,{actionSource:F.FilesViewActionSource.FOLDER_OVERVIEW})},t.renderFixedHeader=function(){var e=t.props.browsePostTTIExperiments,r=e.expEnableCloudDocsPaperCreate,o=e.expEnableCloudDocsBinderCreate,n=e.expEnableCloudDocsGddCreate;return[i.default.createElement(C.FolderOverview,{componentNamespace:_.BrowseFolderOverviewComponentNamespace,key:t.props.context.currentFQPath,path:t.props.context.currentFQPath,expFolderOverview:t.props.browseExperiments.expFolderOverview||"OFF",onNavigateToFileOrFolder:t.onFolderOverviewNavigateToFileOrFolder,isReadOnly:!t.props.context.isCurrentPathWriteable(),browseLoadingState:t.props.loadingState,onChangeHeight:t.handleFixedHeaderHeightChange,canShareFolder:!t.props.context.isCurrentlyInRoot&&t.props.context.canViewContainingNSMembers}),t.props.shouldShowSharedFolderInvites?i.default.createElement(k.AsyncSharedFolderInvite,{user:t.props.user,onChangeHeight:t.handleFixedHeaderHeightChange}):null,t.isExpGrowthTcBizChecklistUiRevampEnabled()?i.default.createElement(I.OnboardingChecklistBanner,{user:t.props.user,isUserEduEnabled:!!t.props.browseExperiments.currentChecklistModuleName}):null,t.props.isCreateButtonMoveEnabled&&[F.LoadingState.LOADED,F.LoadingState.LOAD_ERROR].includes(t.props.loadingState)?i.default.createElement("div",{className:"create-button-container sapphire-button"},i.default.createElement(a.NewFileMenu,{key:"new-file-menu",user:t.props.user,source:s.NewFileMenuFromType.BROWSE,disabled:!t.props.context.isCurrentPathWriteable(),path:t.props.path,showGdd:!!n,showPaper:!!r,showBinder:!!o,primaryButton:!0,attachment:"left",selection_mode:t.props.selectedFiles.count()>0?"selected":"unselected",empty_folder:t.props.emptyFolder,forceLongLabel:t.props.isCreateButtonMoveEnabled})):null]},t.renderFilesViewController=function(e){var n;if(t.props.loadingState===F.LoadingState.LOAD_ERROR)return i.default.createElement(i.default.Suspense,{fallback:i.default.createElement("div",null,q._("Something went wrong on our end."))},i.default.createElement(K,null));var s=t.props.shouldShowPinnedTeamFolders,a=s?t.props.filesWithoutTeamFolders:t.props.files,l=G({context:t.props.context,selectedFiles:t.props.selectedFiles,isDraggingExternalFiles:t.props.isDraggingExternalFiles,isDraggingInternalFiles:t.props.isDraggingInternalFiles,isUploadModalOpen:t.props.isUploadModalOpen}),d=o.default("maestro-browse-app-content",(n={},n["maestro-content-scroll"]=t.props.contentScroll,n)),u=y.getRedesignProps(t.props.browseExperiments.expBrowseWebFilesViewRedesignVariants),p=u.clickToSelect,f=u.highDensityBrowse;return i.default.createElement("div",{className:d,ref:t.scrollContainer},i.default.createElement(N.RetrievalSuccessBrowseviewBanner,{user:t.props.user,displayContext:D.SearchSuccessDisplayContext.IN_EMBEDDED_APP,expSearchSuccessBanner:!!t.props.browseExperiments.expSearchSuccessBanner,isFilePreview:A.isFilePreview(),isSearchMode:!1}),i.default.createElement(v.WebTeamSharingModalExperiment,{context:t.props.context,user:t.props.user,path:t.props.path,selectedFiles:t.props.selectedFiles,browsePostTTIExperiments:t.props.browsePostTTIExperiments}),t.renderFixedHeader(),t.props.browseExperiments.expGrowthTcBizEducationModule&&i.default.createElement(O.EducationModuleExperiment,{user:t.props.user,initialState:t.props.browseExperiments.expGrowthTcBizEducationModule,isCurrentlyInOnboarding:!!t.props.browseExperiments.currentChecklistModuleName,vacuumingPolicyMaxDays:t.props.browseExperiments.vacuumingPolicyMaxDays||120}),t.props.browsePostTTIExperiments.expCXEducationModule&&!t.props.browseExperiments.expGrowthTcBizEducationModule&&i.default.createElement(E.CXEducationModuleExperiment,{user:t.props.user,initialState:t.props.browseExperiments.currentChecklistModuleName?"minimized":t.props.browsePostTTIExperiments.expCXEducationModule,contentType:t.props.browsePostTTIExperiments.expCXEducationModuleContentType,isCurrentlyInOnboarding:!!t.props.browseExperiments.currentChecklistModuleName,vacuumingPolicyMaxDays:t.props.browseExperiments.vacuumingPolicyMaxDays||120}),i.default.createElement(T.FilesViewController,r.__assign({},t.props.filesViewActionHandlers,{disabledMultiselect:t.props.isTimelineVisible,getOverflowMenuActions:t.handleGetOverflowMenuActions,renderSharedWithController:t.renderSharedWithController,hrefForFile:c.href_for_file,onLocationLinkClick:t.handleLocationLinkClick,onNavigateToFileOrFolder:t.props.onNavigateToFileOrFolder,onNavigateToParentFolder:t.props.onNavigateToParentFolder,onOpenFileSharedWithMe:t.props.onOpenFileSharedWithMe,onOpenPaper:t.handleOpenPaper,onFocusSearchBar:t.handleFocusSearchBar,context:t.props.context,createNewFolderState:t.props.createNewFolderState,currentSort:t.props.currentSort,dropTargetHighlightMode:l,fileRename:t.props.fileRename,items:a,responsive:e,getIsFileJumping:t.props.getIsFileJumping,isDraggingExternalFiles:t.props.isDraggingExternalFiles,isDraggingInternalFiles:t.props.isDraggingInternalFiles,isFileViewerShown:t.props.isFileViewerShown,isOverFreeQuota:t.props.isOverFreeQuota,shouldShowPinnedTeamFolders:s,arePostTTIModulesLoaded:t.props.arePostTTIModulesLoaded,sharingServiceInfo:t.props.sharingServiceInfo,extensionsFeatureFlags:t.props.extensionsFeatureFlags,isTextSelectable:t.props.isTextSelectable,loadingState:t.props.loadingState,onComponentTTI:t.props.handleComponentTTI,onSelectionChange:t.handleSelectionChange,onSortChange:t.handleFileListSortChange,onStarClick:t.handleStarClick,path:t.props.path,selectedFiles:t.props.selectedFiles,selection:t.props.selection,setFileUploaderPath:w.FileUploaderController.setPathAndPermissions,showFileUploaderModal:t.handleShowFileUploader,teamFolders:t.props.teamFolders,totalNumFiles:t.props.totalNumItems,user:t.props.user,viewType:t.props.viewType,isQueryingFolderSizes:t.props.isQueryingFolderSizes,columns:t.props.columns,viewTypeColumns:t.props.viewTypeColumns,viewTypes:b.AllViewTypes,viewTypeLabels:b.ViewTypeLabels,starredState:t.props.starredState,stickyOffsetTop:t.props.contentScroll?-1:t.getPageHeaderHeight(e,!!t.state.hasTopNotification),scrollContainer:t.props.contentScroll?t.scrollContainer:void 0,isStickyColumnHeader:!0,scrollPositionOffset:t.state.fixedHeaderHeight||0,hasResponsiveOverflowMenu:!!t.props.browsePostTTIExperiments.expResponsiveFilesOverflowMenu,selectionMethod:p?F.SelectionMethod.CLICK:F.SelectionMethod.CHECKBOX,highDensity:f,expBrowseStickyOverflowMenu:"ON"===t.props.browsePostTTIExperiments.expBrowseStickyOverflowMenu})))},t.renderSidebar=function(e){return i.default.createElement(h.BrowseSidebarView,{autoTeamGroupId:t.props.autoTeamGroupId,arePostTTIModulesLoaded:t.props.arePostTTIModulesLoaded,uploaderExperiments:t.props.uploaderExperiments,uploaderPostTTIExperiments:t.props.uploaderPostTTIExperiments,handleComponentTTI:t.props.handleComponentTTI,isNoComment:t.props.isNoComment,starredState:t.props.starredState,uploadAjaxInterceptor:t.props.uploadAjaxInterceptor,onUploadButtonClick:t.handleUploadButtonClick,onGetFileActionsForFiles:t.handleGetFileActionsForSetOfFiles,responsive:e,onContextMenuClick:t.handleSidebarContextMenuClick})},t.close=function(){t.props.onCloseTimeline()},t.onTimelineOptIn=function(){t.props.onOptInToRewind()},t.state={searchBarProps:t.getCurrentSearchBarProps(t.props)},t}return r.__extends(U,p),U.prototype.componentWillMount=function(){var e=this;this.topNotificationListener=P.createTopNotificationListener(function(t){e.setState({hasTopNotification:t})})},U.prototype.componentWillReceiveProps=function(e){
e.path!==this.props.path&&this.setState({searchBarProps:this.getCurrentSearchBarProps(e)})},U.prototype.componentDidMount=function(){return r.__awaiter(this,void 0,void 0,function(){var t,o=this;return r.__generator(this,function(n){switch(n.label){case 0:return t=this.props.browseExperiments.expBrowseSuccessBanner,t===M.BrowseSuccessBannerVariants.V1||t===M.BrowseSuccessBannerVariants.V3?A.startBrowseSuccessBannerCounter(t):t===M.BrowseSuccessBannerVariants.V2&&A.setBrowseSuccessBannerTimer(),L.Snackbar.manager=this.snackbarManager.current,[4,V.waitForTTI()];case 1:return n.sent(),Promise.all([new Promise(function(t,r){e(["modules/clean/react/browse/file_actions"],t,r)}).then(r.__importStar),new Promise(function(t,r){e(["modules/clean/react/browse/shared_with"],t,r)}).then(r.__importStar),new Promise(function(t,r){e(["modules/clean/growth/experiments/overquota_helper"],t,r)}).then(r.__importStar)]).then(function(e){var t=e[0],r=e[1],n=e[2].OverquotaHelper;o.setState({fileActionsModule:t,sharedWithModule:r}),n.maybeShowSubgrowthProOQRecurringModal("wb_oq_ups_recur_fb")}),w.FileUploaderController.loadCoreComponent(),this.props.shouldOpenUploadModal&&this.handleShowFileUploader(),B.UEClient.sendEvent("BrowseView","componentDidMount",this.props.context.toJSON()),f.logPageView(this.getPageVieworBrowseLoadedData()),this.props.browseExperiments.expGrowthTcBizEducationModuleVariant&&"OFF"!==this.props.browseExperiments.expGrowthTcBizEducationModuleVariant&&l.TeamsWebActionsLogger.log("edu_module_browser_dim",{width:window.innerWidth,height:window.innerHeight,variant:this.props.browseExperiments.expGrowthTcBizEducationModuleVariant}),[2]}})})},U.prototype.componentDidUpdate=function(e){this.props.loadingState===F.LoadingState.LOADED&&B.UEClient.sendEvent("BrowseView","componentDidUpdate",this.props.context.toJSON()),this.props.loadingState===F.LoadingState.LOADED&&e.loadingState===F.LoadingState.LOADING_FIRST_PAGE&&f.logBrowseLoaded(this.getPageVieworBrowseLoadedData())},U.prototype.getPageVieworBrowseLoadedData=function(){var e=this.props,t=e.context,r=e.user,o=e.viewType,n=t.currentFQPath.split("/").filter(function(e){return!!e}).length;return 0===n?{uid:r.id,view_type:o,url:c.get_browse_root(r)}:{uid:r.id,view_type:o,url:c.get_browse_root(r)+"/*",navigation_depth:n}},U.prototype.componentWillUnmount=function(){this.topNotificationListener.unsubscribe()},U.prototype.getCurrentSearchBarProps=function(e){return{showSearchBar:!0,currentPath:e.path,searchBarExperiments:e.searchBarExperiments,expUniversalSinglePageSearch:!0}},U.prototype.render=function(){var e=this.props,r=e.user,o=e.clickTimelineTimestamp,n=e.isDraggingExternalFiles,s=e.isDraggingInternalFiles,a=e.isUploadModalOpen,l=e.context,c=e.isTimelineVisible,d=e.optedInToRewind,u=e.browsePostTTIExperiments,p=u.expTimeline,f=u.expRewindUpsell,_=e.montanaModalProps,m=this.props.browseExperiments.expFolderHistoryRollbacks,h=g.getQueryArgs().rewind_optin,v=m||d||p||h||"OFF"!==f&&"CONTROL"!==f;return i.default.createElement("div",{className:"exp-details-pane-variants"},v&&i.default.createElement(t.AsyncDelorean,{clickBrowseButtonTimestampMs:o,user:r,fromDesktopClient:"true"===g.getQueryArgs().from_desktop_client,showRewindTab:"true"===g.getQueryArgs().rewind,browseContext:l,close:this.close,isVisible:c,expFolderHistoryRollbacks:m||d||!1,expTimeline:p||!1,rewindOptin:h,userVersionHistoryLength:this.props.userVersionHistoryLength,onOptIn:this.onTimelineOptIn,expRewindUpsell:f}),_&&i.default.createElement(t.AsyncMontanaModal,{montanaModalProps:_,user:r}),i.default.createElement(R.SearchChrome,{user:r,titleRegion:i.default.createElement(S.BrowseTitle,{isDraggingExternalFiles:n,isDraggingInternalFiles:s,isUploadModalOpen:a}),titleClass:"page-header__title-overflow",embeddedAppRegion:this.renderFilesViewController,actionSidebarRegion:this.renderSidebar,searchBarProps:this.state.searchBarProps,key:String(this.props.optedInToRewind),useHeaderPortal:!0}),i.default.createElement(x.SnackbarManager,{ref:this.snackbarManager,getParentElement:z}))},U.defaultProps={selectedFiles:n.OrderedMap(),viewType:F.ViewType.List},U})(i.default.PureComponent);t.BrowseView=Q;var K=i.default.lazy(function(){return r.__awaiter(j,void 0,void 0,function(){var t;return r.__generator(this,function(o){switch(o.label){case 0:return[4,new Promise(function(t,r){e(["modules/clean/react/browse/components/post_tti/error"],t,r)}).then(r.__importStar)];case 1:return t=o.sent().ErrorComponent,[2,{default:t}]}})})});t.AsyncDelorean=p.Loadable({loader:function(){return r.__awaiter(j,void 0,void 0,function(){var t;return r.__generator(this,function(o){switch(o.label){case 0:return[4,V.waitForTTI()];case 1:return o.sent(),[4,new Promise(function(t,r){e(["modules/clean/react/delorean/delorean"],t,r)}).then(r.__importStar)];case 2:return t=o.sent().Delorean,[2,t]}})})}}),t.AsyncMontanaModal=p.Loadable({loader:function(){return r.__awaiter(j,void 0,void 0,function(){var t;return r.__generator(this,function(o){switch(o.label){case 0:return[4,V.waitForTTI()];case 1:return o.sent(),[4,new Promise(function(t,r){e(["modules/clean/react/montana/in_product_modal/in_product_modal_post_tti_renderer"],t,r)}).then(r.__importStar)];case 2:return t=o.sent().PostTTIMontanaIPAModalRenderer,[2,t]}})})}})}),define("modules/clean/react/browse/controller",["require","exports","tslib","external/lodash","external/react-dom","react","modules/clean/analytics","modules/clean/browse/browse_bolt_client","modules/clean/css","modules/clean/em_string","modules/clean/filepath","modules/clean/filetypes","modules/clean/history","modules/clean/pagelet_logger","modules/clean/pagination_manager","modules/clean/react/app_actions/education/async_extensions_edu_modal","modules/clean/react/browse/action_logger","modules/clean/react/browse/actions","modules/clean/react/browse/api","modules/clean/react/browse/browse_prefetch_loader","modules/clean/react/browse/browse_view","modules/clean/react/browse/constants","modules/clean/react/browse/data/action_creators","modules/clean/react/browse/data/store","modules/clean/react/browse/models","modules/clean/react/browse/uri_helper","modules/clean/react/file_uploader/constants","modules/clean/react/file_uploader/file_uploader","modules/clean/react/file_uploader/store","modules/clean/react/file_uploader/utils","modules/clean/react/file_viewer/async_controller","modules/clean/react/fileops_actions","modules/clean/react/files_view/constants","modules/clean/react/files_view/types","modules/clean/react/retrieval_success_banner/util","modules/clean/react/snackbar","modules/clean/sharing/browse_exports","modules/clean/sharing/constants","modules/clean/sharing/ui_notifications_util","modules/clean/storage","modules/clean/upsell/prompt_event_emitter","modules/clean/user_education/user_education_client","modules/clean/web_timing_logger","modules/constants/python","modules/core/browser","modules/core/browser_detection","modules/core/exception","modules/core/html","modules/core/i18n","modules/core/notify","modules/core/uri"],function(e,t,r,o,n,i,s,a,l,c,d,u,p,f,_,m,h,S,g,v,E,w,b,T,F,y,C,I,O,R,P,D,N,A,L,x,M,U,k,B,V,H,W,q,G,z,j,Y,Q,K,J){"use strict";function X(e){K.Notify.success(Q._("%(file_name)s added to your Dropbox.").format({file_name:d.filename(e)}))}function Z(e){var t=Q._('Added “%(folder_name)s” <a href="%(href)s">Learn More</a>').format({folder_name:c.Emstring.em_snippet(d.filename(e),U.SNIPPET_SIZES.FILENAME),href:"/help/business/team-space-overview#acceptfolder"});K.Notify.success(new Y.HTML(t))}function $(e){var t=d.parent_dir(e);"/"!==t&&K.Notify.success(Q._("Folder is in %(path)s").format({path:c.Emstring.em_snippet(t,22)}))}function ee(e){return!!e&&e.isShown()}function te(e){var t=y.getQueryArgs();p.default.replace_state(e,o.pick.apply(o,[t,w.BrowseQueryArg.d,w.BrowseQueryArg.select,w.BrowseQueryArg.preview,w.BrowseQueryArg.activity,w.BrowseQueryArg.rewind,w.BrowseQueryArg.from_desktop_client,w.BrowseQueryArg.rewind_optin,w.BrowseQueryArg.preselected_for_showcase,w.BrowseQueryArg.folder_overview,w.BrowseQueryArg.rewind_tip].concat(w.FRAMEWORK_ARGS)))}Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),n=r.__importStar(n),i=r.__importDefault(i),d=r.__importStar(d),p=r.__importDefault(p),h=r.__importStar(h),g=r.__importStar(g),b=r.__importStar(b),R=r.__importStar(R),D=r.__importStar(D),W=r.__importStar(W),G=r.__importStar(G),z=r.__importStar(z);var re=(function(t){function c(i){var a=t.call(this,i)||this;return a.deferredCheckForMissingStarredData=o.noop,a.handlePostTTIPrefetchComplete=function(t){return r.__awaiter(a,void 0,void 0,function(){var o,n,i,s,a,l,c,d,u,p;return r.__generator(this,function(f){switch(f.label){case 0:return o=t["exp-browse-post-tti-experiments"],n=t["exp-uploader-post-tti-experiments"],i=!!t["is-over-free-quota"],s=!!t["maybe-render-team-admin-modals"],a=!!t["has-excluded-ns-ids"],l=t["montana-modal-props"],c=t["preferred-editors"],o.expShouldShowNcctPaywall&&G.redirect("/ncct-trial-end"),[4,new Promise(function(t,r){e(["modules/core/browser_detection"],t,r)}).then(r.__importStar)];case 1:return d=f.sent().is_supported_mobile_browser,u=!d()&&l,this.setState({uploaderPostTTIExperiments:n,isOverFreeQuota:i,hasExcludedNsIds:a,montanaModalProps:u?l:null,preferredEditors:c}),this.props.setBrowsePostTTIExperiments({browsePostTTIExperiments:o}),!s||u?[3,3]:[4,new Promise(function(t,r){e(["modules/clean/react/ncct/post_tti_ncct_modal"],t,r)}).then(r.__importStar)];case 2:p=f.sent().postTTINCCTReminderModal,p(),f.label=3;case 3:return[2]}})})},a.handlePostTTIPrefetchError=function(e){j.reportException({err:e||new Error("failed to load post TTI experiments")})},a.handlePreviewAndShareModalsOnLoad=function(t){var o=a.getPathFromProps(),n=a.props.user,i=!!a.props["open-preview"],s=!!a.props["show-share-modal"],l=a.props["share-prefill-email"],c=l?[l]:void 0;if(i&&!t){K.Notify.error(Q._("The file doesn’t exist"));var d=a.props.urlPrefix,u=a.getUrlForFQPath(d,o),f=y.getQueryArgs();delete f.preview,p.default.replace_state(u,f)}if(t){var _=F.File.fromServerObject(t);P.asyncOpenPreview({containerId:w.BROWSE_FILE_VIEWER_ELEMENT_ID,files:[_],fileViewAction:q.FileViewActionType.CLICK,fileViewOrigin:q.FileViewOriginType.BROWSE,fileViewTarget:q.FileViewTargetType.PRIVATE,indexOfPreviewFile:0,user:n,updateBrowserLocation:!1,onFileViewerDidMount:function(){P.hideElementsBehindFileViewer(),T.getStoreForBrowse().dispatch(b.setIsFileViewerShown({isShown:!0}))},onFileViewerUnmount:function(){P.showElementsBehindFileViewer(),T.getStoreForBrowse().dispatch(b.setIsFileViewerShown({isShown:!1})),a.restoreUrlAfterFileViewClose()}}),s&&W.waitForTTI().then(function(){a.mounted&&M.asyncShowPrefilledShareModal({user:n,sharePrefillEmails:c,content:_,setUrl:a.props.setUrl})})}else s&&a.showShareModalForCurrentPath(c);s||a.props["showing-mobile-billing-modal"]||a.props["showing-client-modal"]||W.waitForTTI().then(function(){V.promptBufferedEventEmitter.on(V.Events.ON_PROMPT_INITIALIZED,function(t){return r.__awaiter(a,void 0,void 0,function(){var o,n,i,s,a,l;return r.__generator(this,function(c){switch(c.label){case 0:return t&&(t.didMainCampaignLoad()||t.didCampaignForUserEducationLoad())?[2]:[4,new Promise(function(t,r){e(["modules/clean/react/ncct/post_tti_ncct_modal"],t,r)}).then(r.__importStar)];case 1:return o=c.sent().postTTINCCTReminderModal,[4,o()];case 2:return(n=c.sent())?[2]:(i="V1"===this.props.browsePostTTIExperiments.expEngageDesktopWebOnly,s="V1"===this.props.browsePostTTIExperiments.expEngageDesktopWebFirst,i&&this.props.user.is_team?[4,new Promise(function(t,r){e(["modules/clean/growth/experiments/install_client_modal"],t,r)}).then(r.__importStar)]:[3,4]);case 3:return a=c.sent().installClientModalExperiment,a(),[3,6];case 4:return s?[4,new Promise(function(t,r){e(["modules/clean/growth/experiments/non_unity_web_first_modal"],t,r)}).then(r.__importStar)]:[3,6];case 5:l=c.sent().nonUnityWebFirstModal,l(),c.label=6;case 6:return[2]}})})})})},a.receiveStateFromStores=function(){a.setState(a.getStateFromStores())},a.handleComponentTTI=function(e){a.browseLogger&&(!a.browseLogger.ttiLogged||"FilesViewController"!==e&&"SearchResultsTitle"!==e?a.browseLogger.componentReady(e):a.ajaxRequestWebTimer&&(a.ajaxRequestWebTimer.markTimeToInteractive(),delete a.ajaxRequestWebTimer))},a.onAllUploadsComplete=function(e){var t=e,r=t&&t.detail&&t.detail.files;if(r){var o=r.map(function(e){return d.normalize(e.path)+d.normalize(e.name)});S.browseActions.selectFilesAfterUpload({fqPathsToSelect:o})}},a.getIsFileJumping=function(){return a.props.isFileJumping},a.getFileByFullPath=function(e){return a.props.files.find(function(t){return t.fq_path===e})||null},a.getFileByFilename=function(e){return a.props.files.find(function(t){return d.filename(t.fq_path)===e})||null},a.startBoltLiveUpdate=function(){a.browseBoltClient.startLiveUpdate(function(){a.getChangesRequest&&a.getChangesRequest.abort();var e=a.props,t=e.user,r=e.path,o=e.shouldShowDeletedFiles;a.getChangesRequest=g.getChangesForDirectory({path:r,userId:t.id,namespaceToJournalIdMap:a.browseBoltClient.getNsMap(),includeDeletedFiles:o,onSuccess:function(e){delete a.getChangesRequest,r===a.props.path&&(a.props.applyBoltUpdates({updates:e,setPath:a.props.setPath}),a.browseBoltClient.handleUpdateBoltClient(e.bolt_data))}})})},a.toggleTimelineIfNecessary=function(){var e=y.getQueryArgs().activity||y.getQueryArgs().rewind;e&&!a.props.isTimelineVisible&&a.props.showTimeline(),!e&&a.props.isTimelineVisible&&a.props.hideTimeline()},a.showShareModalForCurrentPath=function(e){var t=a.props.user,r=a.getPathFromProps();W.waitForTTI().then(function(){if(a.mounted){var o=a.props["ns-id"],n=a.props["ns-path"];M.asyncShowPrefilledShareModal({user:t,sharePrefillEmails:e,content:{fqPath:r,isFolder:!0,nsId:o&&n?o:null,targetNsId:o&&!n?o:null},setUrl:a.props.setUrl})}})},a.handleFileLocationChange=function(e,t){if(e="/"+J.URI.decode(e),a.ensureFileViewerIsOpenedOrClosedIfNeeded(t),a.toggleTimelineIfNecessary(),t.share&&!a.props["show-share-modal"]&&a.showShareModalForCurrentPath(),!d.paths_are_equal(a.props.path,e)||"1"===t.d!==a.props.shouldShowDeletedFiles||t.reload){t.reload&&(delete t.reload,a.props.setUrl({path:a.props.path,qargs:t}));var o=function(){return N.SortIsFilename.includes(a.props.currentSort.sortField)?A.SortLabel.FILENAME:a.props.currentSort.sortField===A.SortField.MODIFIED?A.SortLabel.MODIFIED:A.SortLabel.SIZE};a.props.setPath({path:e}),a.props.setLoadingState({loadingState:A.LoadingState.LOADING_FIRST_PAGE,path:e}),a.props.setShouldShowDeletedFiles({shouldShowDeletedFiles:"1"===t.d}),a.browseLogger&&a.browseLogger.ttiLogged&&a.ensureTimer("browse_ajax","browse_ajax_nav");var n=!d.paths_are_equal(a.props.path,e);g.loadPath({sortLabel:o(),sortIsAscending:a.props.currentSort.sortDirection===A.SortDirection.ASCENDING,path:e,userId:a.props.user.id,sortFoldersFirst:!z.mac,includeDeletedFiles:"1"===t.d,onSuccess:function(t){var o=t.path,i=t.data,s=t.xhr;if(a.ajaxRequestWebTimer){var l=s.getResponseHeader("x-dropbox-request-id");a.ajaxRequestWebTimer.end(l?l:void 0)}if(d.paths_are_equal(e,o)&&(a.props.setIsRewindButtonEnabled({path:e,userId:a.props.user.id,userSkuHasRewind:!!a.browseExperiments.expFolderHistoryRollbacks}),!y.getQueryArgs().query)){n&&a.props.handleFolderOverviewPrefetch(r.__assign({},i.folder_overview,{path:e,expFolderOverview:a.browseExperiments.expFolderOverview,componentNamespace:w.BrowseFolderOverviewComponentNamespace})),a.props.setPath({path:e}),a.props.setMountPoints({mountPoints:i.ns_id_to_mount_point});var c=F.BrowseContext.fromServerObject(i);if(i.paginated){var u=i.first_page.total_num_items;a.props.setPathData({path:e,files:[],context:c,paginatedTotalNumFiles:u});_.PaginationManager.create({firstPage:i.first_page,keyName:"sjid",ajaxURL:"/browse_get_next",userID:a.props.user.id,newDataAvailableCallback:function(t,r){var o=t.areAllItemsReady()?A.LoadingState.LOADED:A.LoadingState.LOADING_REMAINING_PAGES;a.props.appendFiles({path:e,files:r.map(F.File.fromServerObject)}),a.props.setLoadingState({path:e,loadingState:o}),t.areAllItemsReady()&&t.stopAutoFetching()}}).startAutoFetching()}else a.props.setPathData({path:e,files:i.file_info.map(F.File.fromServerObject),paginatedTotalNumFiles:i.file_info.length,context:c}),a.props.setLoadingState({loadingState:A.LoadingState.LOADED,path:e})}},onError:function(){d.paths_are_equal(e,"/")||a.props.setUrl({path:"/"})}})}},a.getPathFromProps=function(){return a.props["init-fq-path"]||"/"},a.markTTVIfNeeded=function(){if(!a.hasTTVBeenLogged&&a.mounted&&a.prefetchComplete){var e=window.ensemble;e&&e.markPageletRenderedByDOMNode(n.findDOMNode(a)),W.mark_time_to_view(),a.hasTTVBeenLogged=!0}},a.handleFileListUpdated=function(){ee(a.state.fileViewerController)?a.props.files.isEmpty()?a.state.fileViewerController.close():a.state.fileViewerController.updateFiles(a.props.files.toJS()):a.ensureFileViewerIsOpenedOrClosedIfNeeded(y.getQueryArgs()),a.prefetchPreviewData(a.props.files.toArray(),a.props.user)},a.handleOnNavigateToPath=function(e){a.browseExperiments.expSearchSuccessBanner&&(L.setSearchSuccessBannerVisible(),L.setClickablePathData(e)),S.browseActions.setUrl({path:e})},a.handleOnNavigateToParentFolder=function(){S.browseActions.navigateToParentFolder()},a.handleDelete=function(e){var t=e.some(F.File.isTeamSharedFolder),r=e.some(function(e){return e.read_only}),o=e.every(function(e){return e.isDeleted}),n=a.props.browsePostTTIExperiments.expDeleteUseApiV2;!a.props.browseContext.isCurrentPathWriteable()||t||r?t?K.Notify.error(Q._("Team folders can’t be deleted.")):K.Notify.warning(Q._("You don’t have permission to delete files in this folder.")):o?S.browseActions.doPermanentDeleteWithModal(e):S.browseActions.doDeleteFilesWithModal({files:e,expDeleteUseApiV2:n})},a.handleOnNavigateToFileOrFolder=function(e,t){void 0===t&&(t={});var r=t.actionSource;if(a.browseExperiments.expSearchSuccessBanner&&!L.userIsOptedOutOfRetrievalSuccessBanner()){L.resetSearchResultClickKey();var o=e.is_dir;L.doSearchBarInteractionBroadcast(!1),L.doSearchResultActionClickBroadcast(!1);var n=e.fq_path,i=L.getClickablePath(),s=L.getSearchResultPath(),l=L.getSearchResultClickTimestamp(),c=L.getClickableFilePathClickTimestamp(),d=Date.now();(l&&d-l<=3e4&&L.parentPathOfFileEqualsSearchResultPath(n,s,o)||c&&d-c<=3e4&&L.parentPathOfFileEqualsSearchResultPath(n,i,o))&&L.setSearchSuccessBannerVisible()}a.props.hideTimeline();var u=window.pageYOffset;a.ensureFullFileObjectPopulated(e,function(e,t){a.completeNavigateToFileOrFolder(e,{onFileViewerUnmount:t,actionSource:r})},function(){window.scrollTo({top:u})})},a.ensureFullFileObjectPopulated=function(e,t,r){t(e,r)},a.completeNavigateToFileOrFolder=function(e,t){void 0===t&&(t={});var r=t.onFileViewerUnmount,o=t.actionSource,n=a.props,i=n.user,l=n.viewer,c=n.viewType,p=e.ns_id,f=e.sjid,_=e.file_id,m=e.fq_path,g=e.bytes,v=e.ext,E=e.request_id;h.logOpenRow({uid:i.id,entity_type:e.is_dir?"folder":"file",source:"list_browse",view_type:c,file_nsid:p,file_sjid:f,file_id:_,file_name:d.filename(e.fq_path),file_path:m,file_size:g,file_extension:v,request_id:E,action_source:o}),e.type===u.FileTypes.TEAM_SHARED_FOLDER&&(H.UEClient.sendEvent("FileItemRow","TeamFolderClicked"),s.TeamsWebActionsLogger.log("clicked_team_folder_web",{team_id:l.team_id})),S.browseActions.navigateToFileOrFolder({file:e,onFileViewerUnmount:r,fileViewAction:q.FileViewActionType.CLICK,preferredEditors:a.state.preferredEditors})},a.handleOnOpenFileSharedWithMe=function(e){G.redirect(e.href)},a.actionHandlers={onDelete:a.handleDelete,onShowRename:function(e){return a.props.setFileRename({file:e,renameState:A.RenameState.PENDING_INPUT})},onRestore:function(e){S.browseActions.doRestoreFilesWithUnifiedTrashModal({files:e})},onPermanentDelete:function(e){S.browseActions.doPermanentDeleteWithModal(e)},onShowComment:function(e){return a.onShowComment(e)}},a.handlePresentInZoom=function(e){P.asyncOpenPreview({containerId:w.BROWSE_FILE_VIEWER_ELEMENT_ID,files:[e],indexOfPreviewFile:0,shouldFocusComment:!1,user:a.props.user,onFileViewerDidMount:P.hideElementsBehindFileViewer,onFileViewerUnmount:P.showElementsBehindFileViewer,fileViewAction:q.FileViewActionType.CLICK,fileViewOrigin:q.FileViewOriginType.BROWSE,fileViewTarget:q.FileViewTargetType.PRIVATE,shouldPresentInZoom:!0})},a.filesViewActionHandlers={onDelete:a.handleDelete,onShowRename:function(e){return a.props.setFileRename({file:e,renameState:A.RenameState.PENDING_INPUT})},onCopyToClipboard:function(e){return a.props.copyFilesToClipboard({files:e})},onPasteFromClipboard:function(){return a.props.pasteFilesFromClipboard({copyFiles:D.copyFiles})},onNewFolderSubmit:function(e){return S.browseActions.createFolder({pathName:a.props.browseContext.currentFQPath,folderName:e,nsId:a.props.browseContext.rootNSID,checkFSWs:!0})},onNewFolderCancel:function(){return S.browseActions.cancelCreateFolder()},onRenameSubmit:function(e,t){return a.props.renameFile({file:e,name:t,checkFSWs:!0})},onRenameCancel:function(e){return a.props.setFileRename({file:e,renameState:null})},onSwitchViewType:function(e){h.logSwitchViewType({uid:a.props.user.id,isSearchMode:!1,viewType:e}),a.props.setViewType({user:a.props.user,viewType:e}),window.setTimeout(function(){var e=document.querySelector(".brws-view-type-column-header-menu-trigger");e&&e.focus()},0)},onColumnsChanged:function(e,t,r){a.props.setViewTypeColumns({columns:e,viewType:t,user:a.props.user}),a.props.setCanDisplayFolderSizes({canDisplayFolderSizes:r})},onCanDisplayFolderSizesChanged:function(e){return a.props.setCanDisplayFolderSizes({canDisplayFolderSizes:e})},onAddFileJumpKeyCode:function(e){return a.props.addFileJumpKeyCode({keyChar:e})},onResetFileJump:function(){return a.props.resetFileJumpFilter()},onShowShare:S.browseActions.handleShowShareModal,onPresentInZoom:a.handlePresentInZoom},a.uploadAjaxInterceptor={interceptUploadPrecheck:function(e){return e},interceptUpload:function(e,t){var o=t.ns_id_for_routing;if(!o){var n=a.props.mountPoints,i=a.props.browseContext.rootNSID;j.assert(null!=n,"mountPoints is null"),j.assert(null!=i,"rootNSID is null"),o=R.getNsId(n,i,e.dest)}return r.__assign({},t,{ns_id_for_routing:o,ns_id:o})}},a.fileViewerIsShown=function(){return ee(a.state.fileViewerController)},a.ensureFileViewerClosedIfNotPreviewing=function(e){!e.preview&&ee(a.state.fileViewerController)&&a.state.fileViewerController.close()},a.prefetchPreviewData=function(e,t){a.state.fileViewerController&&a.state.fileViewerController.prewarmPreviewData(e,t)},a.ensureFileViewerIsOpenedOrClosedIfNeeded=function(e){if(e.preview&&!ee(a.state.fileViewerController)){var t=a.getFileByFilename(e.preview);t&&S.browseActions.navigateToFileOrFolder({file:t,preferredEditors:a.state.preferredEditors})}else!e.preview&&ee(a.state.fileViewerController)&&a.state.fileViewerController.close()},a.getLearnMoreLinkHandler=function(){window.open("/help/business/unsynced-team-folder","_blank")},a.props.setSearchBarExperiments({experiments:a.searchBarExperiments}),O.uploaderStore.add_change_listener(a.receiveStateFromStores),window.addEventListener(C.ALL_UPLOADS_COMPLETE_EVENT,a.onAllUploadsComplete),a.state=r.__assign({},a.getStateFromStores(),{montanaModalProps:null,arePostTTIModulesLoaded:!1,preferredEditors:{}}),a}return r.__extends(c,t),Object.defineProperty(c.prototype,"uploaderExperiments",{get:function(){return this.props["exp-uploader-experiments"]||{}},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"uploaderPostTTIExperiments",{get:function(){return this.state.uploaderPostTTIExperiments||{}},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"searchBarExperiments",{get:function(){return this.props["exp-search-bar-experiments"]||{}},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"browseExperiments",{get:function(){return this.props["exp-browse-experiments"]||{}},enumerable:!0,configurable:!0}),c.prototype.componentWillMount=function(){var e=this,t=this.props,o=t.urlPrefix,n=t.user,i=t.viewer,s=this.props["share-link"],l=!!this.props["open-preview"],c=this.getPathFromProps(),d=["FilesViewController","AppActionsView"];this.browseLogger=new f.PageletLogger("browse",d,!0,{view_type:this.props.viewType.toLowerCase()}),s||l||te(this.getUrlForFQPath(o,c));var u=i.get_users().map(function(e){return e.id});B.UserLocalStorage.clearOtherUsers(u),this.browseBoltClient=new a.BrowseBoltClient(n.id);var _=new v.BrowsePrefetchLoader({user:n,path:c,fqPathsToSelect:this.props["select-fq-paths"]},{onPrefetchComplete:function(t){e.prefetchComplete=!0,e.handlePreviewAndShareModalsOnLoad(t.preview_file_info),"folder_overview"in t&&t.folder_overview?e.props.handleFolderOverviewPrefetch(r.__assign({},t.folder_overview,{path:c,expFolderOverview:e.browseExperiments.expFolderOverview,componentNamespace:w.BrowseFolderOverviewComponentNamespace})):e.props.addFolderOverviewLoadedComponent({componentNamespace:w.BrowseFolderOverviewComponentNamespace,component:"draftjs"}),W.log_js_modules_fetched_data_required_for_tti(),e.markTTVIfNeeded()},onPrefetchError:function(t){e.prefetchComplete=!0,j.reportException({err:t||new Error("Failed to prefetch browse data"),severity:"user-error",exc_extra:{path:c}}),e.props.setUrl({path:""}),e.props.setLoadingState({loadingState:A.LoadingState.LOAD_ERROR,path:c}),e.handleFileLocationChange("",{})},onLoadComplete:function(){},onPostTTIPrefetchComplete:this.handlePostTTIPrefetchComplete,onPostTTIPrefetchError:this.handlePostTTIPrefetchError},{onInitializeEverything:S.browseActions.initializeEverything,onAddFilesAndSetLoadingState:S.browseActions.addFilesAndSetLoadingState});_.isPrefetching()&&_.handlePrefetch(),this.browseExperiments.expSearchSuccessBanner&&(p.default.deconstruct_url(document.referrer).qargs.search_session_id&&!L.getClickedOnSearchResultsPageItem()?L.setSearchSuccessBannerVisible():L.getSearchSuccessBannerVisibleFromHome()&&L.setSearchSuccessBannerVisible());p.default.add_callback(o,this.handleFileLocationChange,!0)},c.prototype.componentDidMount=function(){var t=this;this.mounted=!0;var n=this.getPathFromProps(),i=this.props.user,s=this.props["share-link"],a=!!this.props["open-preview"],u=this.props["from-scl-sync-modal"];if(this.props.setIsRewindButtonEnabled({path:n,userId:this.props.user.id,userSkuHasRewind:!!this.browseExperiments.expFolderHistoryRollbacks}),u&&(i.is_cdm_member?Z(n):X(n)),this.props["show-share-success-snackbar"]){var p=d.filename(n);k.showInBandShareSuccessSnackbar(p)}this.shouldShowUnsyncNotification()&&this.showUnsyncNotification(),s&&!a&&i.is_cdm_member&&$(n),this.toggleTimelineIfNecessary(),this.markTTVIfNeeded(),c.mountFileViewerTarget(),W.waitForTTI().then(function(){l.require_css("/static/css/main_browse_post_tti-vflaVm6Xq.css"),t.fetchAndStartBoltUpdates();var n=function(e){var r=e[0],n=r[0],i=(r[1],r[2].SharedWithStore),s=r[3],a=s.checkForMissingStarredData,l=s.StarredStore,c=(r[4],r[5],e[1]),d=(c[0],c[1],c[2].BloodhoundContactsV2),u=c[3].EmailVerification;c[4],c[5],c[6];if(t.mounted){var p=t.props,f=p.user,_=p.path,h=p.files,S=h.toArray();i.initializeWith({path:_,files:S}),a({items:S,user:f});var g=l.addListener(function(){t.setState({starredState:l.getLoadingStates()})});t.deferredCheckForMissingStarredData=function(){return o.defer(function(){a({items:t.props.files.toArray(),user:f})})},t.removeStarredStoreListener=function(){g()},d.getOrCreateForUser(f),t.setState({arePostTTIModulesLoaded:!0,fileViewerController:n}),t.props["email-just-verified"]?u.getForRole(f.role).show_verified_modal():t.props["email-just-verified-and-changed"]?u.getForRole(f.role).show_verified_and_changed_modal():t.props["send-verification-email"]&&u.getForRole(f.role).show_sent_modal(),t.prefetchPreviewData(h.toArray(),f);var v=t.props["should-open-extensions-edu-modal"];v&&m.asyncShowExtensionsEduModal(f.id,v)}};n.perfName="browse_post_tti",Promise.all([Promise.all([new Promise(function(t,r){e(["modules/clean/react/file_viewer/controller"],t,r)}).then(r.__importStar),new Promise(function(t,r){e(["modules/clean/react/browse/file_actions"],t,r)}).then(r.__importStar),new Promise(function(t,r){e(["modules/clean/react/browse/shared_with"],t,r)}).then(r.__importStar),new Promise(function(t,r){e(["modules/clean/react/starred/browse_exports"],t,r)}).then(r.__importStar),new Promise(function(t,r){e(["modules/clean/react/file_modal_controller"],t,r)}).then(r.__importStar),new Promise(function(t,r){e(["modules/clean/sharing/share_modal_util"],t,r)}).then(r.__importStar)]),Promise.all([new Promise(function(t,r){e(["modules/clean/sharing/ui_util"],t,r)}).then(r.__importStar),new Promise(function(t,r){e(["modules/clean/sharing/wizard/wizard_modals"],t,r)}).then(r.__importStar),new Promise(function(t,r){e(["modules/clean/contacts/bloodhound_contacts_v2"],t,r)}).then(r.__importStar),new Promise(function(t,r){e(["modules/clean/account/email"],t,r)}).then(r.__importStar),new Promise(function(t,r){e(["modules/clean/unity_browse_interface"],t,r)}).then(r.__importStar),new Promise(function(t,r){e(["modules/clean/unity/features"],t,r)}).then(r.__importStar),new Promise(function(t,r){e(["modules/clean/unity/check_file_cache"],t,r)}).then(r.__importStar)])]).then(n)})},c.prototype.componentWillUpdate=function(e,t){e.files.equals(this.props.files)||o.defer(this.handleFileListUpdated)},c.prototype.componentDidUpdate=function(e){e.loadingState===A.LoadingState.LOADING_FIRST_PAGE&&this.props.loadingState!==e.loadingState&&this.markTTVIfNeeded(),e.files!==this.props.files&&this.deferredCheckForMissingStarredData()},c.prototype.componentWillUnmount=function(){this.removeStarredStoreListener&&this.removeStarredStoreListener(),c.unmountFileViewerTarget(),O.uploaderStore.remove_change_listener(this.receiveStateFromStores),window.removeEventListener(C.ALL_UPLOADS_COMPLETE_EVENT,this.onAllUploadsComplete),this.mounted=!1},c.prototype.getStateFromStores=function(){return{isDraggingInternalFiles:I.FileUploaderController.isDraggingInternalFiles(),isDraggingExternalFiles:I.FileUploaderController.isDraggingExternalFiles(),isUploadModalOpen:I.FileUploaderController.isUploadModalOpen()}},c.prototype.restoreUrlAfterFileViewClose=function(){var e,t=this.props.urlPrefix,r=this.getUrlForFQPath(t,this.props.path);e=this.props["open-preview"]?o.omit(y.getQueryArgs(),w.BrowseQueryArg.preview,w.BrowseQueryArg.select):{},p.default.replace_state(r,e)},c.prototype.getUrlForFQPath=function(e,t){return e+("/"===t?"":J.URI.encode_parts(t))},c.prototype.fetchAndStartBoltUpdates=function(){this.browseBoltClient.isReady()?this.startBoltLiveUpdate():this.browseBoltClient.fetchInitialBoltData(this.startBoltLiveUpdate)},c.prototype.ensureTimer=function(e,t){if(this.ajaxRequestWebTimer&&this.ajaxRequestWebTimer.getContextName()!==e&&(this.ajaxRequestWebTimer.abort(),W.delete_timer(this.ajaxRequestWebTimer.getContextName()),this.ajaxRequestWebTimer=void 0),this.ajaxRequestWebTimer)this.ajaxRequestWebTimer.restart();else{W.delete_timer(e),this.ajaxRequestWebTimer=W.get_timer(e);var r={requireTTI:!0,requireTTV:!1};t&&(r.url=t),this.ajaxRequestWebTimer.initialize(r)}},c.prototype.onShowComment=function(e){var t=this;e instanceof F.FileSharedWithMe?G.redirect(e.href):this.ensureFullFileObjectPopulated(e,function(e){S.browseActions.navigateToFileOrFolder({file:e,shouldFocusComment:!0,preferredEditors:t.state.preferredEditors})})},c.prototype.shouldShowUnsyncNotification=function(){return this.props["should-show-unsync-notification"]},c.prototype.showUnsyncNotification=function(){x.Snackbar.show(i.default.createElement(x.Snackbar,{variant:"generic",title:Q._("Do you also need this on your computer?",{comment:'\'"this" refers to the folder that the user is currently browsing. (limited space, please keep the phase short)'}),timeoutDelayMs:1e5,actionButtonText:Q._("Learn more"),closeButtonText:Q._("Close"),onActionClick:this.getLearnMoreLinkHandler,id:"browse-unsync"}))},c.prototype.render=function(){
var e=this.state,t=e.isUploadModalOpen,r=e.starredState,o=e.arePostTTIModulesLoaded,n=e.isDraggingExternalFiles,s=e.isDraggingInternalFiles,a=e.isOverFreeQuota,l=e.hasExcludedNsIds,c=e.montanaModalProps,d=this.props,u=d.browseContext,p=d.selection,f=d.selectedFiles,_=d.browsePostTTIExperiments,m=d.canDisplayFolderSizes,h=d.clickTimelineTimestamp,S=d.createNewFolderState,g=d.currentSort,v=d.extensionsFeatureFlags,w=d.fileRename,b=d.files,T=d.filesWithoutTeamFolders,F=d.hideTimeline,y=d.isQueryingFolderSizes,C=d.isTextSelectable,I=d.optedInToRewind,O=d.isTimelineVisible,R=d.loadingState,P=d.paginatedTotalNumFiles,D=d.path,N=d.setAndStoreSortOrder,A=d.setSelection,L=d.setUrl,x=d.shouldShowDeletedFiles,M=d.shouldShowPinnedTeamFolders,U=d.shouldShowSharedFolderInvites,k=d.showTimeline,B=d.optInToRewind,V=d.teamFolders,H=d.user,W=d.viewType,q=d.viewTypeColumns,G=d.sharingServiceInfo,z=d.shouldShowRetrievalSuccessBanner,j=d.pinnedItems,Y=d.contentScroll,Q=d.emptyFolder;return i.default.createElement(E.BrowseView,{autoTeamGroupId:this.props["auto-team-group-id"],userVersionHistoryLength:this.props["user-version-history-length"],actionHandlers:this.actionHandlers,filesViewActionHandlers:this.filesViewActionHandlers,onNavigateToParentFolder:this.handleOnNavigateToParentFolder,onNavigateToPath:this.handleOnNavigateToPath,onNavigateToFileOrFolder:this.handleOnNavigateToFileOrFolder,onOpenFileSharedWithMe:this.handleOnOpenFileSharedWithMe,clickTimelineTimestamp:h,context:u,createNewFolderState:S,currentSort:g,ensureFileViewerClosedIfNotPreviewing:this.ensureFileViewerClosedIfNotPreviewing,fileRename:w,files:b,filesWithoutTeamFolders:T,getIsFileJumping:this.getIsFileJumping,getFileByFullPath:this.getFileByFullPath,handleComponentTTI:this.handleComponentTTI,isDraggingExternalFiles:n,isDraggingInternalFiles:s,isFileViewerShown:this.fileViewerIsShown,isTextSelectable:C,isTimelineVisible:O,optedInToRewind:I,isUploadModalOpen:t,loadingState:R,path:D,selectedFiles:f,selection:p,shouldOpenUploadModal:this.props["should-open-upload-modal"],shouldShowDeletedFiles:x,shouldShowPinnedTeamFolders:M,shouldShowSharedFolderInvites:U,starredState:r,teamFolders:V,totalNumItems:P,uploadAjaxInterceptor:this.uploadAjaxInterceptor,user:H,viewType:W,canDisplayFolderSizes:m,columns:q[W],viewTypeColumns:q,arePostTTIModulesLoaded:o,isNoComment:this.props["is-no-comment"],isOverFreeQuota:a,hasExcludedNsIds:l,isQueryingFolderSizes:y,nsId:this.props["ns-id"],uploaderExperiments:this.uploaderExperiments,uploaderPostTTIExperiments:this.uploaderPostTTIExperiments,searchBarExperiments:this.searchBarExperiments,browseExperiments:this.browseExperiments,browsePostTTIExperiments:_,onShowTimeline:k,onCloseTimeline:F,onOptInToRewind:B,onSelectionChange:A,extensionsFeatureFlags:v,sharingServiceInfo:G,onSortFiles:N,pinnedItems:j,onSetUrl:L,shouldShowRetrievalSuccessBanner:z,montanaModalProps:c,contentScroll:Y,isCreateButtonMoveEnabled:!!this.props.isCreateButtonMoveEnabled,emptyFolder:Q})},c.mountFileViewerTarget=function(){var e=document.getElementById(w.BROWSE_FILE_VIEWER_ELEMENT_ID);e||(e=document.createElement("div"),e.id=w.BROWSE_FILE_VIEWER_ELEMENT_ID,document.body.insertBefore(e,document.body.children[0]))},c.unmountFileViewerTarget=function(){var e=document.getElementById(w.BROWSE_FILE_VIEWER_ELEMENT_ID);e&&document.body.removeChild(e)},c})(i.default.Component);t.BrowseController=re}),define("modules/clean/react/browse/data/action_creators",["require","exports","tslib","external/immutable","external/lodash","modules/clean/filepath","modules/clean/flux/dispatcher","modules/clean/history","modules/clean/react/async_file_modal_controller","modules/clean/react/browse/action_logger","modules/clean/react/browse/api","modules/clean/react/browse/async_extensions","modules/clean/react/browse/constants","modules/clean/react/browse/data/helpers","modules/clean/react/browse/data/selectors","modules/clean/react/browse/data/folder_overview_selectors","modules/clean/react/browse/data/types","modules/clean/react/browse/logger_util","modules/clean/react/browse/models","modules/clean/react/browse/uri_helper","modules/clean/react/file_uploader/constants","modules/clean/react/files_view/data/action_creators","modules/clean/react/files_view/data/selectors","modules/clean/react/files_view/file_actions/api_v2","modules/clean/react/files_view/file_actions/file_from_metadata","modules/clean/react/files_view/file_actions/snackbars","modules/clean/react/files_view/types","modules/clean/react/folder_overview/data/action_creators","modules/clean/react/selection","modules/clean/react/snackbar","modules/clean/redux/tests/store","modules/clean/sharing/constants","modules/clean/undo","modules/clean/web_user_action_events","modules/core/cookies","modules/core/exception","modules/core/i18n","modules/core/uri"],function(e,t,r,o,n,i,s,a,l,c,d,u,p,f,_,m,h,S,g,v,E,w,b,T,F,y,C,I,O,R,P,D,N,A,L,x,M,U){"use strict";function k(e,r,o,n){var i=o.mount_points,s=_.path(r()),a=f.getMountPointUpdateForCurrentPath(i,s,_.mountPoints(r())),l=a[0],c=a[1];l&&!c&&R.Snackbar.complete(M._("The folder was unshared."),"browse-unshare");var d=f.getPathForNewMountPoint(l,c,s);if(d)return void n({path:d});e(t.setMountPoints({mountPoints:i}))}function B(e,r,o){var n=o.added,a=o.moved,l=o.removed,c=_.path(r()),d=_.unsortedFiles(r()),u=_.folderSizes(r()),f=d.size,m=_.boltIgnore(r()),h=m.added,S=m.moved,v=m.removed,E={added:new Set([]),moved:new Set([]),removed:new Set([])};n=n.filter(function(e){return!h.has(e.fq_path)||(E.added.add(e.fq_path),!1)}),a=a.filter(function(e){var t=e[0];return!S.has(t)||(E.moved.add(t),!1)}),l=l.filter(function(e){return!v.has(e)||(E.removed.add(e),!1)}),e(t.popBoltIgnore(E)),d=d.withMutations(function(e){u=u.withMutations(function(t){for(var r=function(e){return i.paths_are_equal(i.parent_dir(e.fq_path),c)},o=function(t){r(t)&&(e.set(t.fq_path,g.File.fromServerObject(t)),f+=1)},s=function(r,n){var i=e.get(r);if(!(i&&i.sjid>=n.sjid&&r===n.fq_path)){e.remove(r),f-=1,o(n);var s=t.get(r);s&&(t.remove(r),t.set(n.fq_path,s))}},d=function(r){e.remove(r),t.remove(r),f-=1},u=0,p=n;u<p.length;u++){var _=p[u];e.has(_.fq_path)?s(_.fq_path,_):o(_)}for(var m=0,h=a;m<h.length;m++){var S=h[m],v=S[0],_=S[1];e.has(v)?s(v,_):o(_)}for(var E=function(t){var r=e.find(function(e){return e.fq_path.toLowerCase()===t.toLowerCase()});r&&d(r.fq_path)},w=0,b=l;w<b.length;w++){var v=b[w];E(v)}})}),d.size!==f&&x.reportException({err:new Error("applyBoltUpdates ended up with unexpected number of items"),tags:["browse_file_collections_mismatch"],severity:x.SEVERITY.CRITICAL,exc_extra:{expected_unsorted_files_size:f,actual_unsorted_files_size:d.size,is_deleted_files_on:_.shouldShowDeletedFiles(r()),filesAdded:n,filesRemoved:l,filesMove:a}}),d!==_.unsortedFiles(r())&&(t.setUnsortedFiles({unsortedFiles:d})(e,r,P.mockExtraArguments),s.Dispatcher.dispatch({type:p.SharedWithActionType.BROWSE_FILES_UPDATED,data:{parentPath:c,files:d.toArray()}})),u!==_.folderSizes(r())&&e(t.setFolderSizes({folderSizes:u})),q({unsortedFiles:d})(e,r,P.mockExtraArguments)}var V=this;Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),n=r.__importStar(n),i=r.__importStar(i),a=r.__importDefault(a),l=r.__importStar(l),d=r.__importStar(d),_=r.__importStar(_),m=r.__importStar(m),S=r.__importStar(S),w=r.__importStar(w),T=r.__importStar(T),y=r.__importStar(y);t.appInit=function(e){var t=e.experiments,r=e.shouldShowDeletedFiles,o=e.user,n=e.viewer;return function(e,i){e({type:h.ActionTypes.APP_INIT,payload:{experiments:t,shouldShowDeletedFiles:r,user:o,viewer:n}});var a=L.Cookies.read(p.BROWSE_SORT_COOKIE_NAME);if(a&&a.indexOf("|")>-1){var l=a.split("|",2),c={sortField:l[0],sortDirection:l[1]},d=_.sortOrder(i());c.sortDirection===d.sortDirection&&c.sortField===d.sortField||e(W({sortOrder:c}))}s.Dispatcher.dispatch({type:E.UploaderActionType.SET_USER,data:{user:o}})}},t.pushBoltIgnore=function(e){return{type:h.ActionTypes.PUSH_BOLT_IGNORE,payload:e}},t.popBoltIgnore=function(e){return{type:h.ActionTypes.POP_BOLT_IGNORE,payload:e}},t.selectFilesByFqPath=function(e){var t=e.fqPathsToSelect;return{type:h.ActionTypes.SELECT_FILES_BY_FQ_PATH,payload:{fqPathsToSelect:t}}},t.setCanDisplayFolderSizes=function(e){var t=e.canDisplayFolderSizes;return{type:h.ActionTypes.SET_CAN_DISPLAY_FOLDER_SIZES,payload:{canDisplayFolderSizes:t}}},t.setClipboardFiles=function(e){var t=e.clipboardFiles;return{type:h.ActionTypes.SET_CLIPBOARD_FILES,payload:{clipboardFiles:t}}},t.copyFilesToClipboard=function(e){var r=e.files;return function(e,o){if(r.length){if(r.some(function(e){return e.isDeleted}))return void R.Snackbar.fail(M._("Deleted files cannot be added to the clipboard"),"browse-clipboard-copy");if(r.some(g.File.isTeamSharedFolder))return void R.Snackbar.fail(M._("Team Folders can’t be copied."),"browse-clipboard-copy");var n=M.ungettext("Added %(num_items)s item to clipboard","Added %(num_items)s items to clipboard",r.length).format({num_items:r.length});R.Snackbar.complete(n,"browse-clipboard-copy"),e(t.setClipboardFiles({clipboardFiles:r}))}}},t.pasteFilesFromClipboard=function(e){var t=e.copyFiles;return function(e,r){t({user:_.user(r()),files:_.clipboardFiles(r()),newPath:_.path(r()),checkFSWs:!0,dataApi:d,onSuccess:function(e){var t=M.ungettext("Pasted %(num_items)s item from clipboard","Pasted %(num_items)s items from clipboard",e.length).format({num_items:e.length});R.Snackbar.complete(t,"browse-clipboard-paste")}})}},t.setContext=function(e){var t=e.context;return{type:h.ActionTypes.SET_CONTEXT,payload:{context:t}}},t.setBrowsePostTTIExperiments=function(e){var t=e.browsePostTTIExperiments;return{type:h.ActionTypes.SET_BROWSE_POST_TTI_EXPERIMENTS,payload:{browsePostTTIExperiments:t}}};var H=function(e){var t=e.fileJumpFilter;return{type:h.ActionTypes.SET_FILE_JUMP_FILTER,payload:{fileJumpFilter:t}}};t.addFileJumpKeyCode=function(e){var r=e.keyChar;return function(e,o){var n=_.fileJumpFilter(o())+r.toLowerCase();e(H({fileJumpFilter:n}));for(var i=null,s=_.fileJumpIndex(o()),a=0,l=s;a<l.length;a++){var c=l[a],d=c.fqPath;if(c.filename>=n){i=d;break}}null!=i&&e(t.selectFilesByFqPath({fqPathsToSelect:[i]}))}},t.resetFileJumpFilter=function(){return function(e,t){c.logKeyboardShortcutUsage({user_id:_.user(t()).id,keyboard_shortcut_type:"jump",view_type:b.viewType(t())}),e(H({fileJumpFilter:""}))}},t.setFilePathsToSelectOnNextUpdate=function(e){var t=e.filePathsToSelectOnNextUpdate;return{type:h.ActionTypes.SET_FILE_PATHS_TO_SELECT_ON_NEXT_UPDATE,payload:{filePathsToSelectOnNextUpdate:t}}},t.optInToRewind=function(){return{type:h.ActionTypes.OPT_IN_TO_REWIND,payload:{}}},t.setIsRewindButtonEnabled=function(e){return function(t,o){return r.__awaiter(V,void 0,void 0,function(){var o,n,i,s;return r.__generator(this,function(r){switch(r.label){case 0:return o=e.path,n=e.userId,i=e.userSkuHasRewind,i?[4,d.isRewindButtonEnabled(o,n)]:(t({type:h.ActionTypes.SET_IS_REWIND_ENABLED,payload:{value:!0}}),[2]);case 1:return s=r.sent(),t({type:h.ActionTypes.SET_IS_REWIND_ENABLED,payload:{value:!!s.can_rewind}}),[2]}})})}},t.showTimeline=function(){return{type:h.ActionTypes.SHOW_TIMELINE,payload:{timestamp:(new Date).getTime()}}},t.hideTimeline=function(){return{type:h.ActionTypes.HIDE_TIMELINE,payload:{}}},t.refreshPinnedItems=function(){return function(e,t){return r.__awaiter(V,void 0,void 0,function(){var o;return r.__generator(this,function(r){return"V2"!==_.experiments(t()).expFolderOverview&&"V3"!==_.experiments(t()).expFolderOverview||(o=m.folderOverviewFolderFileId(t()),e(I.reloadContentReferences({folderFileId:o,componentNamespace:p.BrowseFolderOverviewComponentNamespace}))),[2]})})}},t.deleteFiles=function(e){var o=e.files,n=e.checkFSWs;return function(e,s){return r.__awaiter(V,void 0,void 0,function(){var a,d,u,p,f,m,h,v,E,w,F,C,I,O,P,D,L,x,U=this;return r.__generator(this,function(k){switch(k.label){case 0:return a=_.user(s()),d=_.path(s()),u=_.shouldShowDeletedFiles(s()),p=function(e){var t=e.eventName,r=e.num_files_selected,o=e.num_folders_selected,n=e.error_summary;c.logBrowseAction({uid:a.id,action:t,num_files_selected:r,num_folders_selected:o,view_type:b.viewType(s()),error_summary:n})},R.Snackbar.sync(M.ungettext("Deleting %(num_files)s item...","Deleting %(num_files)s items...",o.length).format({num_files:o.length}),!0,"browse-action"),1!==o.length||u||e(t.pushBoltIgnore({removed:new Set([o[0].fq_path])})),[4,T.deleteFiles(o,a.id,n)];case 1:return f=k.sent(),f.isError?("path"===f.error[".tag"]&&"file_system_warnings"===f.error.path[".tag"]?(R.Snackbar.close("browse-action"),l.showFileSystemWarningsModal({fsws:f.error.path.details,onFinalAccept:function(){e(t.deleteFiles({files:o,checkFSWs:!1}))},confirmText:M._("Delete")})):(1!==o.length||u||e(t.popBoltIgnore({removed:new Set([o[0].fq_path])})),R.Snackbar.fail(y.deleteError(o.length,f.error),"browse-action")),m=_.selectedFiles(s()),h=S.countFilesAndFolders(m),v=h.num_files_selected,E=h.num_folders_selected,p({eventName:A.WebUserActionLogEvent.DELETE_REQUEST_FAIL,num_files_selected:v,num_folders_selected:E,error_summary:f.error_summary})):(w=function(e){return"success"===e[".tag"]},F=f.result.entries.filter(w),i.paths_are_equal(_.path(s()),d)&&(C=F.map(function(e){return e.metadata.path_display}),I=_.unsortedFiles(s()),O=C.reduce(function(e,t){if(void 0===t)return e;var o=I.get(t);return u&&void 0!==o?e.set(t,new g.File(r.__assign({},o,{isDeleted:!0}))):e.delete(t)},I),e(t.setUnsortedFiles({unsortedFiles:O}))),P=function(){return r.__awaiter(U,void 0,void 0,function(){var n;return r.__generator(this,function(r){switch(r.label){case 0:return R.Snackbar.sync(M._("Undoing delete..."),!0,"browse-action"),1!==o.length||u||e(t.popBoltIgnore({added:new Set([o[0].fq_path])})),p({eventName:A.WebUserActionLogEvent.DELETE_UNDO,num_files_selected:f.result.changeset_data.length,num_folders_selected:0}),[4,T.undo(f.result.changeset_data,a)];case 1:return n=r.sent(),n.isError?(1!==o.length||u||e(t.popBoltIgnore({added:new Set([o[0].fq_path])})),R.Snackbar.fail(M._("Couldn’t undo delete."),"browse-action"),p({eventName:A.WebUserActionLogEvent.DELETE_UNDO_REQUEST_FAIL,num_files_selected:f.result.changeset_data.length,num_folders_selected:0,error_summary:n.error_summary})):(R.Snackbar.complete(M._("Delete undone."),"browse-action"),p({eventName:A.WebUserActionLogEvent.DELETE_UNDO_REQUEST_SUCCESS,num_files_selected:f.result.changeset_data.length,num_folders_selected:0})),[2]}})})},N.setHandleUndo(P),D=function(e){return"failure"===e[".tag"]},L=f.result.entries.filter(D),x=L.length>0?L[0].failure[".tag"]:void 0,L.length===f.result.entries.length?(R.Snackbar.fail(y.deleteCompleteError(L),"browse-action"),p({eventName:A.WebUserActionLogEvent.DELETE_REQUEST_FAIL,num_files_selected:f.result.changeset_data.length,num_folders_selected:0,error_summary:x})):(R.Snackbar.completeWithUndo(y.deleteCompleteSuccess(o.length,F.length),P,"browse-action"),p({eventName:A.WebUserActionLogEvent.DELETE_REQUEST_SUCCESS,num_files_selected:f.result.changeset_data.length,num_folders_selected:0,error_summary:x}))),[2]}})})}},t.renameFile=function(e){var o=e.file,n=e.name,s=e.checkFSWs;return function(e,a){return r.__awaiter(V,void 0,void 0,function(){var d,u,p,f,m,h,g=this;return r.__generator(this,function(v){switch(v.label){case 0:return n.indexOf("/")!==-1?(R.Snackbar.fail(M._("Name was invalid."),"browse-action"),e(w.setFileRename({file:o,renameState:null})),[2]):(d=_.user(a()),u=function(e,t,r){var o=_.selectedFiles(a()),n=S.countFilesAndFolders(o),i=n.num_files_selected,s=n.num_folders_selected;c.logBrowseAction({uid:d.id,action:e,num_files_selected:i,num_folders_selected:s,view_type:b.viewType(a()),result:t,error_summary:r})},n.indexOf("/")!==-1?(R.Snackbar.fail(M._("Name was invalid."),"browse-action"),e(w.setFileRename({file:o,renameState:null})),u(A.WebUserActionLogEvent.RENAME_REQUEST_FAIL,o,'Name contained "/"'),[2]):(e(w.setFileRename({file:o,renameState:C.RenameState.SAVING_INPUT})),p=_.path(a()),R.Snackbar.sync(M._("Renaming"),!1,"browse-action"),e(t.pushBoltIgnore({moved:new Set([o.fq_path])})),[4,T.renameFile(o,n,d,s)]));case 1:return f=v.sent(),f.isError?(e(t.popBoltIgnore({moved:new Set([o.fq_path])})),"to"===f.error[".tag"]&&"file_system_warnings"===f.error.to[".tag"]?(R.Snackbar.close("browse-action"),l.showFileSystemWarningsModal({fsws:f.error.to.details,onFinalAccept:function(){e(t.renameFile({file:o,name:n,checkFSWs:!1}))},onAbortAction:function(){e(w.setFileRename({file:o,renameState:null}))},confirmText:M._("Rename")})):(e(w.setFileRename({file:o,renameState:null})),R.Snackbar.fail(y.renameError(f.error,o.fq_path),"browse-action")),u(A.WebUserActionLogEvent.RENAME_REQUEST_FAIL,o,f.error_summary)):(m=F.fileFromMetadata(o,f.result.metadata),i.paths_are_equal(_.path(a()),p)&&(e(t.setUnsortedFiles({unsortedFiles:_.unsortedFiles(a()).remove(o.fq_path).set(m.fq_path,m)})),e(t.refreshPinnedItems())),e(t.selectFilesByFqPath({fqPathsToSelect:[m.fq_path]})),e(w.setFileRename({file:o,renameState:null})),h=function(){return r.__awaiter(g,void 0,void 0,function(){var n;return r.__generator(this,function(r){switch(r.label){case 0:return R.Snackbar.sync(M._("Undoing rename..."),!1,"browse-action"),e(t.pushBoltIgnore({added:new Set([o.fq_path]),removed:new Set([m.fq_path])})),u(A.WebUserActionLogEvent.RENAME_UNDO,o),[4,T.undo(f.result.changeset_data,d)];case 1:return n=r.sent(),n.isError?(R.Snackbar.fail(M._("Undo failed."),"browse-action"),e(t.popBoltIgnore({added:new Set([o.fq_path]),removed:new Set([m.fq_path])})),u(A.WebUserActionLogEvent.RENAME_UNDO_REQUEST_FAIL,o,n.error_summary)):(R.Snackbar.complete(M._("Rename undone."),"browse-action"),i.paths_are_equal(_.path(a()),p)&&(e(t.setUnsortedFiles({unsortedFiles:_.unsortedFiles(a()).remove(m.fq_path).set(o.fq_path,o)})),e(t.refreshPinnedItems())),e(t.selectFilesByFqPath({fqPathsToSelect:[o.fq_path]})),u(A.WebUserActionLogEvent.RENAME_UNDO_REQUEST_SUCCESS,o)),[2]}})})},N.setHandleUndo(h),R.Snackbar.completeWithUndo(M._("Rename complete."),h,"browse-action"),u(A.WebUserActionLogEvent.RENAME_REQUEST_SUCCESS,m)),[2]}})})}},t.createFolder=function(e){var o=e.pathName,n=e.folderName,i=e.checkFSWs,s=e.showShareModalOnSuccess,a=e.redirectOnSuccess,d=e.redirectOnCancel,u=e.selectCreatedFolder,p=void 0===u||u;return function(e,u){return r.__awaiter(V,void 0,void 0,function(){var f,m,h;return r.__generator(this,function(r){switch(r.label){case 0:return e(t.setNewFolderCreationState({newFolderCreationState:C.NewFolderCreationState.SAVING_INPUT})),c.logCreateFolderPending(),R.Snackbar.sync(M._("Creating folder..."),!1,"browse-action"),f=_.user(u()),[4,T.createFolder(o,n,f,i)];case 1:return m=r.sent(),m.isError?"path"===m.error[".tag"]&&"file_system_warnings"===m.error.path[".tag"]?(R.Snackbar.close("browse-action"),l.showFileSystemWarningsModal({fsws:m.error.path.details,onFinalAccept:function(){e(t.createFolder({pathName:o,folderName:n,checkFSWs:!1,showShareModalOnSuccess:s,redirectOnSuccess:a,redirectOnCancel:d,selectCreatedFolder:p}))},onAbortAction:function(){e(t.setNewFolderCreationState({newFolderCreationState:C.NewFolderCreationState.CREATE_FOLDER_INACTIVE})),c.logCreateFolderCancel(),d&&d()},confirmText:M._("Create folder")})):(e(t.setNewFolderCreationState({newFolderCreationState:C.NewFolderCreationState.CREATE_FOLDER_INACTIVE})),c.logCreateFolderError(m.error_summary,m.error[".tag"]),"path"===m.error[".tag"]&&"malformed_path"===m.error.path[".tag"]?R.Snackbar.fail(M._('The following characters are not allowed: angle brackets \\ / : ? * " |'),"browse-action"):R.Snackbar.fail(M._("Can’t create folder."),"browse-action"),d&&d()):(h=F.folderFromFolderMetadata(m.result.metadata),e(t.setNewFolderCreationState({newFolderCreationState:C.NewFolderCreationState.CREATE_FOLDER_INACTIVE})),R.Snackbar.complete(M._("Folder created."),"browse-action"),c.logCreateFolderSuccess(),p&&e(t.selectFilesByFqPath({fqPathsToSelect:[h.fq_path]})),a&&a(h.fq_path),s&&s(h,D.SHARE_ACTION_ORIGIN_TYPE.BROWSE_NEW_FOLDER_MODAL)),[2]}})})}},t.setFolderSizes=function(e){var t=e.folderSizes;return{type:h.ActionTypes.SET_FOLDER_SIZES,payload:{folderSizes:t}}},t.setLoadingState=function(e){var t=e.loadingState,r=e.path;return{type:h.ActionTypes.SET_LOADING_STATE,payload:{loadingState:t,path:r}}},t.setMountPoints=function(e){var t=e.mountPoints;return{type:h.ActionTypes.SET_MOUNT_POINTS,payload:{mountPoints:t}}},t.setNewFolderCreationState=function(e){var t=e.newFolderCreationState;return{type:h.ActionTypes.SET_NEW_FOLDER_CREATION_STATE,payload:{newFolderCreationState:t}}},t.setPaginatedTotalNumFiles=function(e){var t=e.paginatedTotalNumFiles;return{type:h.ActionTypes.SET_PAGINATED_TOTAL_NUM_FILES,payload:{paginatedTotalNumFiles:t}}},t.setUrl=function(e){var o=e.path,i=void 0===o?"":o,s=e.qargs;return function(e,o){a.default.push_state(_.urlPrefix(o())+U.URI.encode_parts(i),n.omitBy(r.__assign({},n.pick(v.getQueryArgs(),["d"]),s),n.isUndefined)),e(t.setSelection({selection:O.createSelection()}))}},t.setPath=function(e){var t=e.path;return{type:h.ActionTypes.SET_PATH,payload:{path:t}}},t.setPathData=function(e){var r=e.path,n=e.files,a=e.paginatedTotalNumFiles,l=e.context;return function(e,c){if(i.paths_are_equal(r,_.path(c()))){var d=o.Map(n.map(function(e){return[e.fq_path,e]}));e(t.setContext({context:l})),t.setUnsortedFiles({unsortedFiles:d})(e,c,P.mockExtraArguments),e(t.setPaginatedTotalNumFiles({paginatedTotalNumFiles:a})),e(t.clearSelection()),q({unsortedFiles:d})(e,c,P.mockExtraArguments),setTimeout(function(){s.Dispatcher.dispatch({type:p.SharedWithActionType.BROWSE_FILES_LOADED,data:{parentPath:r,files:n}}),s.Dispatcher.dispatch({type:E.UploaderActionType.SET_PATH,data:{path:r,hasPermissionToUploadToFolder:l.isCurrentPathWriteable()}})},1)}}},t.setSelection=function(e){var t=e.selection;return{type:h.ActionTypes.SET_SELECTION,payload:{selection:t}}},t.clearSelection=function(){return t.setSelection({selection:O.createSelection()})},t.setShouldShowDeletedFiles=function(e){var t=e.shouldShowDeletedFiles;return{type:h.ActionTypes.SET_SHOULD_SHOW_DELETED_FILES,payload:{shouldShowDeletedFiles:t}}};var W=function(e){var t=e.sortOrder;return{type:h.ActionTypes.SET_SORT_ORDER,payload:{sortOrder:t}}};t.setAndStoreSortOrder=function(e){return function(t,r){L.Cookies.delete(p.BROWSE_SORT_COOKIE_NAME);var o=e.sortField+"|"+e.sortDirection;L.Cookies.create(p.BROWSE_SORT_COOKIE_NAME,o,1095),t(W({sortOrder:e}))}},t.setUnsortedFiles=function(e){var t=e.unsortedFiles;return function(e,o){return r.__awaiter(V,void 0,void 0,function(){var n;return r.__generator(this,function(r){return n=_.user(o()),e({type:h.ActionTypes.SET_UNSORTED_FILES,payload:{unsortedFiles:t}}),u.asyncExtensions.initializeStore(n,t.toArray()),[2]})})}},t.requestFolderSizes=function(e){var t=e.fqPath;return{type:h.ActionTypes.REQUEST_FOLDER_SIZES,payload:{fqPath:t}}},t.setFolderSizesPending=function(e){var t=e.fetchFolderSizesResp;return{type:h.ActionTypes.SET_FOLDER_SIZES_PENDING,payload:{fetchFolderSizesResp:t}}},t.completeFolderSizes=function(e){var t=e.fetchFolderSizeState;return{type:h.ActionTypes.COMPLETE_FOLDER_SIZES,payload:{fetchFolderSizeState:t}}},t.applyBoltUpdates=function(e){var r=e.updates,o=e.setPath;return function(e,n){var i=r.parent_changes,s=_.user(n());if(i&&i.change_to_fq_path)return f.showUserNotificationForPathChange(s,i),void t.setUrl({path:i.change_to_fq_path})(e,n,P.mockExtraArguments);k(e,n,r,o),B(e,n,r)}};var q=function(e){var r=e.unsortedFiles;return function(e,n){var i=_.filePathsToSelectOnNextUpdate(n()).toArray(),s=i.filter(function(e){return r.has(e)}),a=i.filter(function(e){return!r.has(e)});0!==s.length&&(e(t.selectFilesByFqPath({fqPathsToSelect:s})),e(t.setFilePathsToSelectOnNextUpdate({filePathsToSelectOnNextUpdate:o.Set(a)})))}};t.appendFiles=function(e){var r=e.path,n=e.files;return function(e,a){if(i.paths_are_equal(r,_.path(a()))){var l=_.unsortedFiles(a()).size,c=_.unsortedFiles(a()).merge(o.Map(n.map(function(e){return[e.fq_path,e]})));t.setUnsortedFiles({unsortedFiles:c})(e,a,P.mockExtraArguments),q({unsortedFiles:c})(e,a,P.mockExtraArguments),setTimeout(function(){s.Dispatcher.dispatch({type:p.SharedWithActionType.BROWSE_FILES_LOADED,data:{parentPath:r,files:n}})},1),c.size!==l+n.length&&x.reportException({err:new Error("appendFiles ended up with unexpected number of files."),tags:["browse_file_collections_mismatch"],severity:x.SEVERITY.CRITICAL,exc_extra:{previous_unsorted_files_size:l,incoming_files_size:n.length,updated_unsorted_files_size:c.size,is_deleted_files_on:_.shouldShowDeletedFiles(a())}})}}},t.clearFiles=function(e){var r=e.path,n=e.context;return function(e,s){i.paths_are_equal(r,_.path(s()))&&(t.setUnsortedFiles({unsortedFiles:o.Map()})(e,s,P.mockExtraArguments),e(t.setSelection({selection:O.createSelection()})),e(t.setPaginatedTotalNumFiles({paginatedTotalNumFiles:0})),e(t.setContext({context:n})))}},t.setIsFileViewerShown=function(e){var t=e.isShown;return{type:h.ActionTypes.SET_IS_FILE_VIEWER_SHOWN,payload:{isShown:t}}}}),define("modules/clean/react/browse/data/folder_overview_selectors",["require","exports","tslib","modules/clean/react/browse/constants","modules/clean/react/folder_overview/data/selectors","modules/clean/react/browse/data/selectors","external/reselect","modules/clean/react/files_view/data/selectors","modules/clean/react/files_view/types","modules/clean/filepath"],function(e,t,r,o,n,i,s,a,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),c=r.__importStar(c);var d=n.makeSelectors();t.haveAllComponentsLoaded=function(e){return d.haveAllComponentsLoaded(e,{componentNamespace:o.BrowseFolderOverviewComponentNamespace})},t.hasFailedToLoad=function(e){return d.hasFailedToLoad(e,{componentNamespace:o.BrowseFolderOverviewComponentNamespace})},t.folderOverviewFolderFileId=function(e){return d.folderFileId(e,{path:i.path(e)})},t.folderOverviewLoggingFileId=function(e){return d.loggingFileId(e,{path:i.path(e)})},t.folderOverviewPinnedItems=function(e){return d.pinnedItems(e,{path:i.path(e)})},t.loadingState=s.createSelector(i.browseLoadingState,t.haveAllComponentsLoaded,t.hasFailedToLoad,i.experiments,function(e,t,r,o){return r?e:t||"V1"!==o.expFolderOverview&&"V2"!==o.expFolderOverview&&"V3"!==o.expFolderOverview?e:l.LoadingState.LOADING_FIRST_PAGE}),t.shouldShowPinnedTeamFolders=s.createSelector(i.context,t.loadingState,i.path,i.teamFolders,a.viewType,function(e,t,r,o,n){return e.showPinnedTeamFolder&&!o.isEmpty()&&c.paths_are_equal(r,"/")&&n===l.ViewType.List&&(t===l.LoadingState.LOADED||t===l.LoadingState.LOADING_REMAINING_PAGES)}),t.emptyFolder=s.createSelector(i.sortedFilesWithFolderSizes,i.sortedFilesWithFoldersSizesWithoutTeamFolders,t.shouldShowPinnedTeamFolders,function(e,t,r){return 0===(r?t:e).count()}),t.paginatedTotalNumFiles=function(e){return t.loadingState(e)===l.LoadingState.LOADED?i.sortedFiles(e).count():i.getBrowseState(e).paginatedTotalNumFiles}}),define("modules/clean/react/browse/data/helpers",["require","exports","tslib","external/lodash","modules/clean/filepath","modules/clean/react/browse/data/selectors","modules/clean/react/snackbar","modules/core/i18n"],function(e,t,r,o,n,i,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),n=r.__importStar(n),i=r.__importStar(i),t.showUserNotificationForPathChange=function(e,t){function r(e){return o.escape(n.filename(e))}switch(null!=t.change_type?t.change_type.toLowerCase():null){case"moved":s.Snackbar.complete(a._("This folder has been moved"),"browse-notification");break;case"renamed":s.Snackbar.complete(a._("This folder has been renamed to “%(folder_name)s”").format({folder_name:r(t.change_to_fq_path)}),"browse-notification");break;case"deleted":s.Snackbar.fail(a._("The folder “%(folder_name)s” has been deleted").format({folder_name:r(t.old_fq_path)}),"browse-notification")}},t.getMountPointUpdateForCurrentPath=function(e,t,r){var n,i,s=function(e){return t===e};return r&&r.find(s)?(i=r.find(s)||null,n=e[r.findKey(s)]||null):(i=null,n=o.find(e,s)||null),[i,n]},t.getPathForNewMountPoint=function(e,t,r){return e&&!t?r:e&&t?n.paths_are_equal(e,t)?null:t:!e&&t?r:null},t.getIndexOfFile=function(e,t){return i.sortedFiles(t).findIndex(function(t){return t.sjid===e.sjid&&t.ns_id===e.ns_id})}}),define("modules/clean/react/browse/data/reducer",["require","exports","tslib","external/immutable","modules/clean/filepath","modules/clean/react/browse/data/types","modules/clean/react/browse/models","modules/clean/react/files_view/types","modules/clean/react/selection","modules/core/exception"],function(e,t,r,o,n,i,s,a,l,c){"use strict";function d(e,t){var o=t.payload,n=o.experiments,i=o.shouldShowDeletedFiles,s=o.user,a=o.viewer;return c.assert(null===e.user,"Cannot reinitialize Browse store; changing invariants such as `user` is untested"),r.__assign({},e,{experiments:n,shouldShowDeletedFiles:i,user:s,viewer:a})}function u(e,t){var o=e.boltIgnore,n=o.added,i=o.moved,s=o.removed;return t.payload.added&&(n=new Set(n),t.payload.added.forEach(function(e){return n.add(e)})),t.payload.moved&&(i=new Set(i),t.payload.moved.forEach(function(e){return i.add(e)})),t.payload.removed&&(s=new Set(s),t.payload.removed.forEach(function(e){return s.add(e)})),r.__assign({},e,{boltIgnore:{added:n,moved:i,removed:s}})}function p(e,t){var o=e.boltIgnore,n=o.added,i=o.moved,s=o.removed;return t.payload.added&&(n=new Set(n),t.payload.added.forEach(function(e){return n.delete(e)})),t.payload.moved&&(i=new Set(i),t.payload.moved.forEach(function(e){return i.delete(e)})),t.payload.removed&&(s=new Set(s),t.payload.removed.forEach(function(e){return s.delete(e)})),r.__assign({},e,{boltIgnore:{added:n,moved:i,removed:s}})}function f(e,t){var n=t.payload.fqPathsToSelect,i=n.map(function(e){return e.toLowerCase()}),s=e.unsortedFiles.toList().filter(function(e){return i.includes(e.fq_path.toLowerCase())}),a=s.map(function(e){return e.fq_path}),l=o.OrderedSet(a),c=a.size?a.get(0):null;return r.__assign({},e,{selection:e.selection.set("selected",l).set("anchor",c)})}function _(e,t){var o=t.payload.canDisplayFolderSizes;return r.__assign({},e,{canDisplayFolderSizes:o})}function m(e,t){var o=t.payload.clipboardFiles;return r.__assign({},e,{clipboardFiles:o})}function h(e,t){var o=t.payload.context;return r.__assign({},e,{context:o})}function S(e,t){var o=t.payload.fileJumpFilter;return r.__assign({},e,{fileJumpFilter:o})}function g(e,t){var o=t.payload.filePathsToSelectOnNextUpdate;return r.__assign({},e,{filePathsToSelectOnNextUpdate:o})}function v(e,t){var o=t.payload.folderSizes;return r.__assign({},e,{folderSizes:o})}function E(e,t){var i=t.payload,s=i.loadingState,l=i.path;return n.paths_are_equal(l,e.path)?s===a.LoadingState.LOADED?r.__assign({},e,{loadingState:s,filePathsToSelectOnNextUpdate:o.Set()}):r.__assign({},e,{loadingState:s}):e}function w(e,t){var n=t.payload.mountPoints;return r.__assign({},e,{mountPoints:o.Map(n)})}function b(e,t){var o=t.payload.newFolderCreationState;return r.__assign({},e,{newFolderCreationState:o})}function T(e,t){var o=t.payload.paginatedTotalNumFiles;return r.__assign({},e,{paginatedTotalNumFiles:o})}function F(e,t){var o=t.payload.path;return r.__assign({},e,{path:o})}function y(e,t){var o=t.payload.selection;return r.__assign({},e,{selection:o})}function C(e,t){var o=t.payload.shouldShowDeletedFiles;return r.__assign({},e,{shouldShowDeletedFiles:o})}function I(e,t){var o=t.payload.sortOrder;return r.__assign({},e,{sortOrder:o})}function O(e,t){var o=t.payload.unsortedFiles;return r.__assign({},e,{unsortedFiles:o})}function R(e,t){var o=t.payload.browsePostTTIExperiments;return r.__assign({},e,{browsePostTTIExperiments:o})}function P(e,t){var o=t.payload.fqPath;if(e.isQueryingFolderSizes)return e;var n=e.folderSizes.withMutations(function(e){e.set(o,{size:0,state:a.FetchFolderSizeState.LOADING})});return r.__assign({},e,{folderSizes:n,isQueryingFolderSizes:!0})}function D(e,t){
var o=t.payload.fetchFolderSizesResp,n=e.currentFolderSizesQuery,i=e.folderSizes.withMutations(function(e){for(var t=function(t){e.update(t.fq_path,{size:0,state:a.FetchFolderSizeState.LOADING},function(){return{size:t.size,state:a.FetchFolderSizeState.LOADING}}),n=n.withMutations(function(e){return e.add(t.fq_path)})},r=0,i=o.sizes_dict;r<i.length;r++){t(i[r])}});return r.__assign({},e,{currentFolderSizesQuery:n,folderSizes:i})}function N(e,t){var n=t.payload.fetchFolderSizeState,i=e.folderSizes.withMutations(function(t){e.currentFolderSizesQuery.forEach(function(r){var o=e.folderSizes.get(r);o&&t.update(r,function(){return{size:o.size,state:n}})})});return r.__assign({},e,{currentFolderSizesQuery:o.Set(),folderSizes:i,isQueryingFolderSizes:!1})}function A(e,t){return r.__assign({},e,{isTimelineVisible:!0,clickTimelineTimestamp:t.payload.timestamp})}function L(e,t){return r.__assign({},e,{isTimelineVisible:!1})}function x(e,t){return r.__assign({},e,{isFileViewerShown:t.payload.isShown})}function M(e,t){return r.__assign({},e,{optedInToRewind:!0})}function U(e,t){return r.__assign({},e,{isRewindButtonEnabled:t.payload.value})}function k(e,r){switch(void 0===e&&(e=t.defaultBrowseState),r.type){case i.ActionTypes.APP_INIT:return d(e,r);case i.ActionTypes.PUSH_BOLT_IGNORE:return u(e,r);case i.ActionTypes.POP_BOLT_IGNORE:return p(e,r);case i.ActionTypes.SELECT_FILES_BY_FQ_PATH:return f(e,r);case i.ActionTypes.SET_CAN_DISPLAY_FOLDER_SIZES:return _(e,r);case i.ActionTypes.SET_CLIPBOARD_FILES:return m(e,r);case i.ActionTypes.SET_CONTEXT:return h(e,r);case i.ActionTypes.SET_FILE_JUMP_FILTER:return S(e,r);case i.ActionTypes.SET_FILE_PATHS_TO_SELECT_ON_NEXT_UPDATE:return g(e,r);case i.ActionTypes.SET_FOLDER_SIZES:return v(e,r);case i.ActionTypes.SET_LOADING_STATE:return E(e,r);case i.ActionTypes.SET_MOUNT_POINTS:return w(e,r);case i.ActionTypes.SET_NEW_FOLDER_CREATION_STATE:return b(e,r);case i.ActionTypes.SET_PAGINATED_TOTAL_NUM_FILES:return T(e,r);case i.ActionTypes.SET_PATH:return F(e,r);case i.ActionTypes.SET_SELECTION:return y(e,r);case i.ActionTypes.SET_SHOULD_SHOW_DELETED_FILES:return C(e,r);case i.ActionTypes.SET_SORT_ORDER:return I(e,r);case i.ActionTypes.SET_UNSORTED_FILES:return O(e,r);case i.ActionTypes.SHOW_TIMELINE:return A(e,r);case i.ActionTypes.HIDE_TIMELINE:return L(e,r);case i.ActionTypes.SET_IS_FILE_VIEWER_SHOWN:return x(e,r);case i.ActionTypes.OPT_IN_TO_REWIND:return M(e,r);case i.ActionTypes.SET_IS_REWIND_ENABLED:return U(e,r);case i.ActionTypes.REQUEST_FOLDER_SIZES:return P(e,r);case i.ActionTypes.SET_FOLDER_SIZES_PENDING:return D(e,r);case i.ActionTypes.COMPLETE_FOLDER_SIZES:return N(e,r);case i.ActionTypes.SET_BROWSE_POST_TTI_EXPERIMENTS:return R(e,r)}return e}Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),n=r.__importStar(n),t.defaultBrowseState={boltIgnore:{added:new Set,moved:new Set,removed:new Set},canDisplayFolderSizes:!1,clipboardFiles:[],context:new s.BrowseContext,isRewindButtonEnabled:!1,experiments:{},browsePostTTIExperiments:{},fileJumpFilter:"",filePathsToSelectOnNextUpdate:o.Set(),folderSizes:o.Map(),isTimelineVisible:!1,optedInToRewind:!1,clickTimelineTimestamp:void 0,loadingState:a.LoadingState.LOADING_FIRST_PAGE,mountPoints:null,newFolderCreationState:a.NewFolderCreationState.CREATE_FOLDER_INACTIVE,paginatedTotalNumFiles:0,path:"",selection:l.createSelection(),shouldShowDeletedFiles:!1,sortOrder:{sortField:a.SortField.FILENAME,sortDirection:a.SortDirection.ASCENDING},user:null,unsortedFiles:o.Map(),viewer:null,currentFolderSizesQuery:o.Set(),isQueryingFolderSizes:!1,isSearchMode:!1},t.browseReducer=k}),define("modules/clean/react/browse/data/selectors",["require","exports","tslib","external/immutable","external/reselect","modules/clean/filepath","modules/clean/filetypes","modules/clean/react/browse/data/reducer","modules/clean/react/browse/models","modules/clean/react/browse/uri_helper","modules/clean/react/browse/util","modules/clean/react/files_view/types","modules/clean/redux/namespaces","modules/clean/redux/selectors","modules/clean/search/types","modules/core/browser_detection","modules/core/exception"],function(e,t,r,o,n,i,s,a,l,c,d,u,p,f,_,m,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),i=r.__importStar(i),m=r.__importStar(m),t.getBrowseState=function(e){return f.getStateAtNamespace(e,p.BROWSE_NAMESPACE_KEY)||a.defaultBrowseState},t.canDisplayFolderSizes=function(e){return t.getBrowseState(e).canDisplayFolderSizes},t.clipboardFiles=function(e){return t.getBrowseState(e).clipboardFiles},t.context=function(e){return t.getBrowseState(e).context},t.experiments=function(e){return t.getBrowseState(e).experiments},t.postTTIExperiments=function(e){return t.getBrowseState(e).browsePostTTIExperiments},t.fileJumpFilter=function(e){return t.getBrowseState(e).fileJumpFilter},t.filePathsToSelectOnNextUpdate=function(e){return t.getBrowseState(e).filePathsToSelectOnNextUpdate},t.folderSizes=function(e){return t.getBrowseState(e).folderSizes},t.isFileJumping=function(e){return t.getBrowseState(e).fileJumpFilter.length>0},t.isQueryingFolderSizes=function(e){return t.getBrowseState(e).isQueryingFolderSizes},t.browseLoadingState=function(e){return t.getBrowseState(e).loadingState},t.mountPoints=function(e){return t.getBrowseState(e).mountPoints},t.newFolderCreationState=function(e){return t.getBrowseState(e).newFolderCreationState},t.path=function(e){return t.getBrowseState(e).path},t.selection=function(e){return t.getBrowseState(e).selection},t.shouldShowDeletedFiles=function(e){return t.getBrowseState(e).shouldShowDeletedFiles},t.sortOrder=function(e){return t.getBrowseState(e).sortOrder},t.unsortedFiles=function(e){return t.getBrowseState(e).unsortedFiles},t.boltIgnore=function(e){return t.getBrowseState(e).boltIgnore},t.user=function(e){var r=t.getBrowseState(e).user;return h.assert(null!=r,"Browse store `user` accessed before APP_INIT action"),r},t.viewer=function(e){var r=t.getBrowseState(e).viewer;return h.assert(null!=r,"Browse store `viewer` accessed before APP_INIT action"),r},t.isTimelineVisible=function(e){return t.getBrowseState(e).isTimelineVisible},t.clickTimelineTimestamp=function(e){return t.getBrowseState(e).clickTimelineTimestamp},t.isFileViewerShown=function(e){return t.getBrowseState(e).isFileViewerShown},t.optedInToRewind=function(e){return t.getBrowseState(e).optedInToRewind},t.isRewindButtonEnabled=function(e){return t.getBrowseState(e).isRewindButtonEnabled},t.browsePostTTIExperiments=function(e){return t.getBrowseState(e).browsePostTTIExperiments||{}},t.fileJumpIndex=n.createSelector(t.unsortedFiles,function(e){return e.keySeq().toArray().map(function(e){return{filename:i.filename(e).toLowerCase(),fqPath:e}}).sort(function(e,t){return e.filename<t.filename?-1:e.filename>t.filename?1:0})}),t.sortedFiles=n.createSelector(t.unsortedFiles,t.sortOrder,t.folderSizes,function(e,t,r){return d.sortFiles(e.toList(),t,r,m.mac)}),t.selectedFiles=n.createSelector(t.unsortedFiles,t.selection,function(e,t){return t.selected.isEmpty()||e.isEmpty()?o.OrderedMap():o.OrderedMap(t.selected.map(function(t){var r=e.find(function(e){return e.fq_path===t});return r?[r.fq_path,r]:void 0}))}),t.urlPrefix=n.createSelector(t.user,t.viewer,function(e,t){return c.browse_root(t,e)}),t.teamFolders=n.createSelector(t.unsortedFiles,t.folderSizes,function(e,t){var r={sortField:u.SortField.FILENAME,sortDirection:u.SortDirection.ASCENDING};return d.sortFiles(e.toList().filter(function(e){return e.type===s.FileTypes.TEAM_SHARED_FOLDER}),r,t,m.mac)}),t.sortedFilesWithFolderSizes=n.createSelector(t.sortedFiles,t.folderSizes,function(e,t){return e.map(function(e){var r=t.get(e.fq_path);return r?e.updateSize(r.size,r.state):e})}),t.unsortedFilesWithFolderSizes=n.createSelector(t.unsortedFiles,t.folderSizes,function(e,t){return e.withMutations(function(r){t.forEach(function(t,o){var n=e.get(o);if(n&&t){var i=n.updateSize(t.size,t.state);r.set(o,i)}})})}),t.sortedFilesWithFoldersSizesWithoutTeamFolders=n.createSelector(t.sortedFilesWithFolderSizes,function(e){return e.filter(function(e){return e.type!==s.FileTypes.TEAM_SHARED_FOLDER})}),t.shouldShowSharedFolderInvites=n.createSelector(t.browsePostTTIExperiments,t.path,function(e,t){return!!e.expShowSharedFolderInvites&&i.paths_are_equal(t,"/")}),t.shouldShowSidebarFolderOverview=n.createSelector(t.selectedFiles,function(e){return e&&1===e.size&&e.first().is_dir&&!l.File.isNoAccessSharedFolder(e.first())}),t.shouldMainContentScroll=n.createSelector(t.experiments,function(e){return e.expBrowseDetailsPaneVariants===_.DetailsPaneVariants.CONTENT_SCROLL}),t.isCreateButtonMoveEnabled=n.createSelector(t.experiments,function(e){return!!e.expCreateButtonMove})}),define("modules/clean/react/browse/data/store",["require","exports","modules/clean/redux/namespaces","modules/clean/react/browse/data/reducer","modules/clean/redux/store"],function(e,t,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i;t.getStoreForBrowse=function(){var e;return i||(i=n.getStoreAndRegisterReducers((e={},e[r.BROWSE_NAMESPACE_KEY]=o.browseReducer,e))),i}}),define("modules/clean/react/browse/global_actions",["require","exports","tslib","external/lodash","react","modules/clean/analytics","modules/clean/cloud_docs/constants","modules/clean/cloud_docs/new_file_menu","modules/clean/filepath","modules/clean/filetypes","modules/clean/history","modules/clean/react/async_onboarding_move_modal","modules/clean/react/browse/action_logger","modules/clean/react/browse/actions","modules/clean/react/browse/constants","modules/clean/react/browse/data/action_creators","modules/clean/react/browse/data/selectors","modules/clean/react/browse/data/store","modules/clean/react/extensions/data/types","modules/clean/react/extensions/split_share_button","modules/clean/react/growth/async_joiner_personal_account_modal","modules/clean/react/modal","modules/clean/sharing/access_level","modules/clean/sharing/browse_exports","modules/clean/sharing/gating_util","modules/clean/sharing/constants","modules/clean/user_education/user_education_client","modules/clean/viewer","modules/core/browser","modules/core/browser_detection","modules/core/exception","modules/core/i18n","modules/core/notify","modules/core/uri"],function(e,t,r,o,n,i,s,a,l,c,d,u,p,f,_,m,h,S,g,v,E,w,b,T,F,y,C,I,O,R,P,D,N,A){"use strict";function L(t){return r.__awaiter(this,void 0,Promise,function(){var o;return r.__generator(this,function(n){switch(n.label){case 0:return[4,new Promise(function(t,r){e(["modules/clean/sharing/content_manager"],t,r)}).then(r.__importStar)];case 1:return o=n.sent().goToContentManagerForPath,o(t),[2]}})})}function x(e){return function(){var t=e.currentNSID,r=e.currentNSPath;O.redirect("/requests?ns_id="+t+"&path="+r+"&referrer=web_browse_global_action")}}function M(e){var t=e.context,r=e.user,l=e.viewType,d=e.showDeletedFiles,p=e.onUpload,f=void 0===p?o.noop:p,_=e.isNoComment,m=void 0!==_&&_,b=e.autoTeamGroupId,T=e.browsePostTTIExperiments,y=e.browseExperiments,O=e.isRewindButtonEnabled,P=e.optedInToRewind,D=e.expFolderHistoryRollbacks,N=e.selection_mode,A=e.empty_folder,L=t.isCurrentlyInRoot,M=!t.canViewContainingNSMembers,k=t.isCurrentPathWriteable(),B=R.is_input_webkitdirectory_supported(),Q={action:{className:"action-upload",label:V(U.UploadFiles),popoverLabel:V(U.Files),iconName:B?"upload-file":"upload",performAction:function(){return f(!1)},disabled:!k,key:"upload-files"},isPrimary:!1},K=B?{action:{className:"action-upload",label:V(U.UploadFolder),popoverLabel:V(U.Folder),iconName:"upload-folder",performAction:function(){return f(!0)},disabled:!k,key:"upload-folder"},isPrimary:!1}:void 0,J=!t.isInsideSandboxFolder,X=T.expTimeline,Z=T.expRewindUpsell,$=T.expEnableCloudDocsPaperCreate,ee=T.expEnableCloudDocsBinderCreate,te=T.expEnableCloudDocsGddCreate,re=T.expShowRequestFiles,oe={action:function(){return n.default.createElement(a.NewFileMenu,{key:"new-file-menu",user:r,source:s.NewFileMenuFromType.BROWSE,path:t.currentFQPath,disabled:!k,showGdd:!!te,showPaper:!!$,showBinder:!!ee,primaryButton:!0,selection_mode:N,empty_folder:A})},isPrimary:!0},ne=[];if(t.isInsideTeamFolderTree||!t.isInsideDeletedSharedFolder&&!t.isInsideDeletedNestedSharedFolder)if(t.isInsideDeletedFolder)ne.push({action:{label:V(U.RestoreFolder),iconName:"restore",className:"action-restore",performAction:z(r,l,t),disabled:!k,key:"restore-folder"},isPrimary:!0});else{var ie={label:V(U.NewFolder),iconName:"new-folder",performAction:H(r,l,t,y.expGGRaclsEnabled,b),disabled:!k,className:"action-new-folder",key:"new-folder"},se={action:ie,isPrimary:!1},ae={label:V(L?U.NewSharedFolder:U.ShareFolderAbbreviated),iconName:"new-shared-folder",performAction:q(r,t),disabled:M,className:"action-share-folder",key:"new-shared-folder"},le={file_id:"ns:"+t.currentNSID+t.currentNSPath,fq_path:t.currentFQPath,is_dir:!0,type:c.FileTypes.FOLDER,icon:"",is_cloud_doc:!1,is_symlink:!1},ce=function(){return n.default.createElement(v.SplitShareButton,{file:le,user:r,variant:"secondary",triggerType:g.TriggerType.SidebarPrimaryButton,onShowShare:q(r,t),context:{surface:"browse"},shareButtonLabel:V(U.ShareFolder)})},de={action:ce,isPrimary:!0},ue={action:ae,isPrimary:!1},pe={action:{label:V(U.NewTeamFolder),iconName:"new-team-folder",performAction:Y(r,t),disabled:!1,className:"action-team-folder",key:"new-team-folder"},isPrimary:!1},fe=S.getStoreForBrowse(),_e=h.isCreateButtonMoveEnabled(fe.getState());if(r.is_cdm_member&&"/"===t.currentFQPath){C.UEClient.registerBulkCallbackForEducationStep([{moduleName:"trial_admin_setup_team_space",stepName:"team_folder_modal"},{moduleName:"trial_admin_setup_team_space_v2",stepName:"team_folder_modal"},{moduleName:"trial_admin_setup_team_space_mobile",stepName:"team_folder_modal"},{moduleName:"trial_admin_setup_team_space_mobile_v2",stepName:"team_folder_modal"},{moduleName:"trial_admin_setup_folder_structure",stepName:"team_folder_modal"},{moduleName:"trial_admin_setup_folder_structure_v2",stepName:"team_folder_modal"},{moduleName:"trial_admin_setup_team_space_free_order",stepName:"team_folder_modal"},{moduleName:"trial_admin_setup_team_space_free_order_v2",stepName:"team_folder_modal"}],ie.performAction);var me=function(e){i.TeamsWebActionsLogger.log(e),window.setTimeout(function(){C.UEClient.sendEvent("SetStructureModal","Close")},2500),w.Modal.close()},he=function(){return{user:r,teamName:I.Viewer.get_viewer().team_name,onSuccess:function(){return me("uj_ss_modal_success")},onError:function(){return me("uj_ss_modal_error")},onCancel:function(){return me("uj_ss_modal_cancel")}}};C.UEClient.registerBulkCallbackForEducationStep([{moduleName:"trial_admin_shared_workspace",stepName:"set_structure_modal"},{moduleName:"trial_admin_shared_workspace_v2",stepName:"set_structure_modal"},{moduleName:"trial_admin_shared_workspace_free_order",stepName:"set_structure_modal"},{moduleName:"trial_admin_shared_workspace_free_order_v2",stepName:"set_structure_modal"}],function(){u.showOnboardingMoveDialog(he())}),C.UEClient.registerCallbackForEducationStep("joiner_checklist_shared_workspace_files_decision","set_structure_modal",function(){u.showOnboardingMoveDialogV2(he())}),C.UEClient.registerCallbackForEducationStep("joiner_checklist_inform_personal_account","team_space_tooltip",function(){E.asyncWarmJoinerModalProps(r)}),C.UEClient.registerCallbackForEducationStep("joiner_checklist_inform_personal_account","joiner_personal_account_success_modal",function(){E.asyncShowJoinerPersonalAccountModal(r)}),_e||ne.push(oe),ne.push(Q),B&&ne.push(K),ne.push(se)}else L?(_e||ne.push(oe),ne.push(Q),B&&ne.push(K),!r.is_cdm_member&&F.GoldenGate.hasContentManagerAndSuperAdmin(r.id)&&ne.push(pe),ne.push(ue,se)):(_e||ne.push(oe),J&&ne.push(de),ne.push(Q),B&&ne.push(K),ne.push(se));!re||!k||r.is_cdm_member&&"/"===t.currentFQPath||ne.push({action:{label:V(U.RequestFiles),iconName:"new-file-request",performAction:x(t),key:"new-file-request"}}),m||ne.push({action:{label:V(d?U.HideDeletedFiles:U.ShowDeletedFiles),iconName:d?"hide":"show-deleted-files",performAction:G(r,l,d,!!y.expShowDeletedFilesRedirect,t.currentFQPath),disabled:M,className:"action-deleted-files",key:"toggle-deleted",ariaLabel:V(U.ShowDeletedFiles),ariaPressed:d},isPrimary:!1}),!I.Viewer.get_viewer().is_assume_user_session&&(F.GoldenGate.hasContentManagerAndSuperAdmin(r.id)&&F.GoldenGate.hasNewOwnershipModel(r.id)&&t.isInsideTeamFolderTree||!r.is_cdm_member&&F.GoldenGate.hasContentManagerAndSuperAdmin(r.id)&&t.isCurrentlyInRoot)&&ne.push({action:{label:V(U.ManageAsAdmin),iconName:"settings-gear",performAction:Y(r,t),key:"manage-as-admin"},isPrimary:!1}),D||P||"OFF"!==Z&&"CONTROL"!==Z&&void 0!==Z?ne.push({action:{label:V(t.isCurrentlyInRoot?U.RewindDropbox:U.RewindFolder),iconName:"revert-folder",disabled:!O,performAction:W(r,t),key:"rewind-folder"},isPrimary:!1}):X&&ne.push({action:{label:V(U.FolderHistory),iconName:"view-folder-history",performAction:W(r,t),key:"folder-history"},isPrimary:!1})}else ne.push({action:{label:V(U.ReAddSharedFolder),iconName:"restore",performAction:j(r,t),disabled:!k,key:"re-add-shared-folder"},isPrimary:!0});return ne}Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),n=r.__importDefault(n),l=r.__importStar(l),d=r.__importDefault(d),m=r.__importStar(m),h=r.__importStar(h),O=r.__importStar(O),R=r.__importStar(R);var U;(function(e){e[e.UploadFiles=1]="UploadFiles",e[e.UploadFolder=2]="UploadFolder",e[e.Upload=3]="Upload",e[e.Files=4]="Files",e[e.Folder=5]="Folder",e[e.NewPaperDoc=6]="NewPaperDoc",e[e.NewFolder=7]="NewFolder",e[e.RestoreFolder=8]="RestoreFolder",e[e.ReAddSharedFolder=9]="ReAddSharedFolder",e[e.ShowDeletedFiles=10]="ShowDeletedFiles",e[e.HideDeletedFiles=11]="HideDeletedFiles",e[e.NewSharedFolder=12]="NewSharedFolder",e[e.ShareFolder=13]="ShareFolder",e[e.ShareFolderAbbreviated=14]="ShareFolderAbbreviated",e[e.ManageAsAdmin=15]="ManageAsAdmin",e[e.NewTeamFolder=16]="NewTeamFolder",e[e.FolderHistory=17]="FolderHistory",e[e.RewindFolder=18]="RewindFolder",e[e.RewindDropbox=19]="RewindDropbox",e[e.RequestFiles=20]="RequestFiles"})(U||(U={}));var k={},B=function(e){switch(e){case U.UploadFiles:return D._("Upload files");case U.UploadFolder:return D._("Upload folder");case U.Upload:return D._("Upload");case U.FolderHistory:return D._("Folder history");case U.RewindFolder:return D._("Rewind this folder",{project:"folder-history"});case U.RewindDropbox:return D._("Rewind Dropbox",{project:"folder-history"});case U.Files:return D._("Files");case U.Folder:return D._("Folder");case U.NewPaperDoc:return D._("New Paper Document");case U.NewFolder:return D._("New folder");case U.RestoreFolder:return D._("Restore folder");case U.ReAddSharedFolder:return D._("Re-add shared folder");case U.ShowDeletedFiles:return D._("Show deleted files");case U.HideDeletedFiles:return D._("Hide deleted files");case U.NewSharedFolder:return D._("New shared folder");case U.ShareFolder:return D._("Share folder");case U.ShareFolderAbbreviated:return D._("Share");case U.ManageAsAdmin:return D._("View in admin console");case U.NewTeamFolder:return D._("New team folder");case U.RequestFiles:return D._("Request files")}},V=function(e){return e in k||(k[e]=B(e)),k[e]},H=function(e,t,r,o,n){return function(){var i=r.currentNSID,s=r.currentFQPath;p.logCreateFolder({uid:e.id,view_type:t,file_nsid:i,file_path:s,file_name:l.filename(s)});var a=e.is_cdm_member&&"/"===s;if(o&&(a=r.isInsideTeamFolderTree&&!!e.is_team),a){o||P.assert(!!n,"All CDM Users should have an auto team group in their team");var c=function(e){N.Notify.error(e?e:D._("There was a problem completing this request.")),f.browseActions.cancelCreateFolder()},d=function(e){var t=(e.user,e.folderName,e.fqPath);f.browseActions.createFolderComplete(),f.browseActions.selectFilesByFqPath({fqPathsToSelect:[t]}),f.browseActions.handleNewFolderRedirectOnSuccess(t)},u=function(e){var t=e.pathName,r=e.folderName,o=e.checkFSWs;f.browseActions.createFolder({pathName:t,folderName:r,checkFSWs:o,redirectOnSuccess:f.browseActions.handleNewFolderRedirectOnSuccess})};T.asyncShowAppropriateNewFolderModalForCdmUser({user:e,context:r,autoTeamGroupId:n,showFileSystemWarningsModal:void 0,onPending:f.browseActions.createFolderPending,onComplete:d,onCancel:c,autoTeamGroupDefaultAccessLevel:b.ACCESS_LEVEL.WRITER,setUrl:function(e){var t=e.path,r=e.qargs;return S.getStoreForBrowse().dispatch(m.setUrl({path:t,qargs:r}))},handleCreateFolder:u})}else{var u=function(t){var o=t.folderName,n=t.isConfidential;f.browseActions.createFolderInNewFolderModal({folderName:o,isConfidential:n,user:e,context:r,redirectOnSuccess:f.browseActions.handleNewFolderRedirectOnSuccess})};T.asyncShowCdmNewFolderModal(u,e,r,!1,!1,!0)}}},W=function(e,t){return function(){d.default.update_query_param(_.BrowseQueryArg.rewind,"true"),S.getStoreForBrowse().dispatch(m.showTimeline())}},q=function(e,t){return function(){t.isCurrentlyInRoot?T.asyncShowShareAFolderWizardModal(e):T.asyncShowShareModal(e,t,{origin:y.SHARE_ACTION_ORIGIN_TYPE.BROWSE_GLOBAL_ACTIONS},function(e){var t=e.path,r=e.qargs;return S.getStoreForBrowse().dispatch(m.setUrl({path:t,qargs:r}))})}},G=function(e,t,r,o,n){return function(){if(o&&!r){var i=l.paths_are_equal(n,"/")?{}:{fq_path:n};O.redirect(new A.URI({scheme:"https",authority:"www.dropbox.com",path:"/deleted_files",query:i}))}else p.logToggleDeletedFiles({uid:e.id,show_deleted_files:!r,view_type:t}),f.browseActions.setShouldShowDeletedFiles({shouldShowDeletedFiles:!r})}},z=function(e,t,r){return function(){var o=r.currentNSID,n=r.currentFQPath;p.logRestore({uid:e.id,view_type:t,file_nsid:o,file_path:n,file_name:l.filename(n),num_files_selected:0,num_folders_selected:1}),f.browseActions.doRestoreFilesWithUnifiedTrashModal({})}},j=function(e,t){return function(){var r=t.currentFQPath.toLowerCase(),o=t.inactiveNSIDByFQPath[r],n=t.isInsideDeletedNestedSharedFolder;o&&T.asyncMountSharedFolder(o,e.role,y.SHARE_ACTION_ORIGIN_TYPE.BROWSE_GLOBAL_ACTIONS,!1,null,n)}},Y=function(e,t){return function(){L({containingFolder:t.currentFQPath,isCDM:e.is_cdm_member})}};t.getGlobalActions=M}),define("modules/clean/react/browse/selection_preview_pane",["require","exports","tslib","react","modules/clean/react/async/loadable"],function(e,t,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),t.SelectionPreviewPane=n.Loadable({loader:function(){return new Promise(function(t,r){e(["modules/clean/react/browse/selection_preview_component"],t,r)}).then(r.__importStar).then(function(e){return e.MemoizedSelectionPreviewComponent})},loading:function(){return o.default.createElement("div",{className:"selection-preview-pane selection-preview-pane__empty"})}})}),define("modules/clean/react/browse/sidebar_view",["require","exports","tslib","external/react-redux","react","modules/clean/react/app_actions_view","modules/clean/react/browse/data/selectors","modules/clean/react/browse/data/folder_overview_selectors","modules/clean/react/files_view/data/selectors","modules/clean/react/browse/data/store","modules/clean/react/browse/global_actions","modules/clean/react/browse/models","modules/clean/react/browse/selection_preview_pane","modules/clean/react/browse/util","modules/clean/react/file_uploader/file_uploader","modules/clean/react/files_view/types","modules/clean/react/folder_overview/sidebar_connected","modules/clean/react/folder_overview/utils","modules/clean/web_timing_logger","modules/core/i18n"],function(e,t,r,o,n,i,s,a,l,c,d,u,p,f,_,m,h,S,g,v){"use strict";function E(e){return"function"==typeof e?e:{displayName:e.label,popoverMenuName:e.popoverLabel,iconName:e.iconName,handleClick:e.performAction,disabled:e.disabled,className:e.className,badge:e.badge,ariaLabel:e.ariaLabel,ariaPressed:e.ariaPressed,key:e.key}}function w(e){if("function"==typeof e)return e;var t=void 0;return e.subItems&&(t=e.subItems.map(E)),{displayName:e.label,iconName:e.iconName,handleClick:e.performAction,disabled:e.disabled,className:e.className,subItems:t,ariaLabel:e.ariaLabel,ariaPressed:e.ariaPressed,key:e.key}}Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importDefault(n),s=r.__importStar(s),a=r.__importStar(a),l=r.__importStar(l);var b=(function(t){function o(e){var r=t.call(this,e)||this;return r.renderSingleSelectionAudienceBox=function(e){var t=e.selectedFiles,o=e.context,i=e.user,s=r.sharedWithModule;if(!s)return null;var a=t.first(),l=s.SharedWithController;return n.default.createElement(l,{file:a,browseContext:o,user:i,isInAudienceBox:!0})},r.state={appActionsProps:r.getCurrentAppActionsProps(r.props)},r}return r.__extends(o,t),o.prototype.componentDidMount=function(){return r.__awaiter(this,void 0,void 0,function(){var t;return r.__generator(this,function(o){switch(o.label){case 0:return[4,g.waitForTTI()];case 1:return o.sent(),t=this,[4,new Promise(function(t,r){e(["modules/clean/react/browse/shared_with"],t,r)}).then(r.__importStar)];case 2:return t.sharedWithModule=o.sent(),this.setState({appActionsProps:this.getCurrentAppActionsProps(this.props)}),[2]}})})},o.prototype.componentWillReceiveProps=function(e){e.selectedFiles===this.props.selectedFiles&&e.isRewindButtonEnabled===this.props.isRewindButtonEnabled&&e.context===this.props.context&&e.user===this.props.user&&e.shouldShowDeletedFiles===this.props.shouldShowDeletedFiles&&e.isNoComment===this.props.isNoComment&&e.arePostTTIModulesLoaded===this.props.arePostTTIModulesLoaded&&e.viewType===this.props.viewType&&e.starredState===this.props.starredState&&e.canDisplayFolderSizes===this.props.canDisplayFolderSizes&&e.uploadAjaxInterceptor===this.props.uploadAjaxInterceptor&&e.responsive.isMatchedMedium===this.props.responsive.isMatchedMedium&&e.responsive.isMatchedLarge===this.props.responsive.isMatchedLarge&&e.uploaderExperiments===this.props.uploaderExperiments&&e.uploaderPostTTIExperiments===this.props.uploaderPostTTIExperiments&&e.browseExperiments===this.props.browseExperiments&&e.browsePostTTIExperiments===this.props.browsePostTTIExperiments&&e.optedInToRewind===this.props.optedInToRewind&&e.pinnedItems===this.props.pinnedItems||this.setState({appActionsProps:this.getCurrentAppActionsProps(e)})},o.prototype.getCurrentAppActionsProps=function(e){var t,r=e.selectedFiles,o=e.autoTeamGroupId,i=e.context,s=e.canDisplayFolderSizes,a=e.onGetFileActionsForFiles,l=e.user,c=e.isRewindButtonEnabled,u=e.viewType,p=e.shouldShowDeletedFiles,_=e.onUploadButtonClick,m=e.isNoComment,h=e.browsePostTTIExperiments,S=e.browseExperiments,g=e.handleComponentTTI,b=e.responsive,T=f.getSelectedFilesText(r,i),F=r.count(),y=n.default.createElement("div",null);if(F>0){t=a(r,s,b,!0,!0,h.expRewindUpsell).map(function(e,t){var r="function"==typeof e;return{action:e,isPrimary:0===t||r}}),1===F&&(y=this.renderSingleSelectionAudienceBox(e))}else{t=d.getGlobalActions({context:i,user:l,isRewindButtonEnabled:c,viewType:u,showDeletedFiles:p,onUpload:_,isNoComment:m,autoTeamGroupId:o,browsePostTTIExperiments:h,browseExperiments:S,optedInToRewind:this.props.optedInToRewind,expFolderHistoryRollbacks:this.props.browseExperiments.expFolderHistoryRollbacks||!1,selection_mode:this.props.selectedFiles.count()>0?"selected":"unselected",empty_folder:this.props.emptyFolder});var C=this.sharedWithModule;if(C){var I=C.SharedWithController;y=n.default.createElement(I,{browseContext:i,user:l,isInAudienceBox:!0})}}for(var O=[],R=[],P=0,D=t;P<D.length;P++){var N=D[P];N.isPrimary?O.push(w(N.action)):R.push(E(N.action))}return e.isNoComment&&(y=n.default.createElement("div",null)),{headerText:T,popoverTriggerLabel:v._("Actions"),primaryMenuItems:O,primarySubnode:y,secondaryMenuItems:R,handleComponentTTI:g}},o.prototype.render=function(){var e=this.props,t=e.responsive,o=e.isFileViewerShown,a=e.selectedFiles,l=!(!t||!t.isResponsive||t.isMatchedLarge),d=c.getStoreForBrowse(),f=!l,g=!l&&s.shouldShowSidebarFolderOverview(d.getState()),v=a&&0!==a.size,E=s.isCreateButtonMoveEnabled(d.getState());return n.default.createElement("div",{id:"brws-sidebar-view"},null!=this.props.context.currentFQPath&&!o&&n.default.createElement(_.FileUploaderController,{key:"file-uploader-controller",ref:"fileUploader",loadOnRender:this.props.arePostTTIModulesLoaded,needToSetStoreValues:!1,ajaxInterceptor:this.props.uploadAjaxInterceptor,uploaderExperiments:this.props.uploaderExperiments,uploaderPostTTIExperiments:this.props.uploaderPostTTIExperiments,browseViewType:this.props.viewType}),f&&n.default.createElement(p.SelectionPreviewPane,{selectedFiles:a}),n.default.createElement(i.AppActionsView,r.__assign({user:this.props.user},this.state.appActionsProps,{responsive:this.props.responsive,hideHeaderText:!!f,shouldCollapseActions:v,onContextMenuClick:this.props.onContextMenuClick,isCreateButtonMoveEnabled:!!E,isPrimaryActionSapphire:!0})),g&&n.default.createElement(h.SidebarFolderOverview,{key:a.first().fq_path,path:a.first().fq_path,componentNamespace:"SIDEBAR",isReadOnly:!S.canEditOverviewForFile(a.first()),browseLoadingState:m.LoadingState.LOADED,onlyRenderExistingFolderOverviews:!("V2"===this.props.browseExperiments.expFolderOverview||"V3"===this.props.browseExperiments.expFolderOverview),canShareFolder:!u.File.isNoAccessSharedFolder(a.first())}))},o})(n.default.PureComponent);t.BrowseSidebarViewComponent=b;var T=function(e){return{isFileViewerShown:s.isFileViewerShown(e),browseExperiments:s.experiments(e),browsePostTTIExperiments:s.postTTIExperiments(e),context:s.context(e),viewType:l.viewType(e),isTimelineVisible:s.isTimelineVisible(e),optedInToRewind:s.optedInToRewind(e),selectedFiles:s.selectedFiles(e),user:s.user(e),pinnedItems:a.folderOverviewPinnedItems(e),shouldShowDeletedFiles:s.shouldShowDeletedFiles(e),isRewindButtonEnabled:s.isRewindButtonEnabled(e),canDisplayFolderSizes:s.canDisplayFolderSizes(e),emptyFolder:a.emptyFolder(e)}};t.BrowseSidebarView=o.connect(T)(b)}),define("modules/clean/react/browse/title",["require","exports","tslib","external/react-redux","react","modules/clean/browse_uri_interface","modules/clean/filepath","modules/clean/react/browse/data/action_creators","modules/clean/react/browse/data/selectors","modules/clean/react/file_uploader/file_uploader","modules/clean/react/path_breadcrumbs","modules/clean/viewer","modules/core/i18n"],function(e,t,r,o,n,i,s,a,l,c,d,u,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importDefault(n),s=r.__importStar(s),a=r.__importStar(a),l=r.__importStar(l);var f=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleGetUrlForPath=function(e){return i.browse_uri_for_fq_path(t.props.user,e).toString()},t}return r.__extends(t,e),t.setPageTitle=function(e){e&&(document.title=p._("%(folder_name)s - Dropbox").format({folder_name:s.filename(e,p._("Files"))}))},t.prototype.componentDidMount=function(){t.setPageTitle(this.props.path)},t.prototype.componentWillReceiveProps=function(e){e.path!==this.props.path&&t.setPageTitle(e.path)},t.prototype.render=function(){var e=this.props,t=e.path,r=e.user,o=e.isDraggingInternalFiles,i=e.isDraggingExternalFiles,a=e.isUploadModalOpen,l=e.setUrl,f=s.filename("",u.Viewer.get_root_name(r)),_="work"===r.role?p._("Work"):p._("Personal");return n.default.createElement(d.PathBreadcrumbs,{path:t,isDraggingInternalFiles:o,setFileUploaderPath:c.FileUploaderController.setPathAndPermissions,getUrlForPath:this.handleGetUrlForPath,firstBreadcrumbName:f,firstBreadcrumbAlt:_,shouldHighlightDropTargets:o||i&&!a,disableDragging:i,setUrl:l})},t})(n.default.PureComponent);t.BrowseTitleComponent=f;var _=function(e){return{path:l.path(e),user:l.user(e)}},m={setUrl:a.setUrl};t.BrowseTitle=o.connect(_,m)(f)}),define("modules/clean/react/browse/web_team_sharing_experiment",["require","exports","tslib","react","modules/clean/react/file_uploader/constants","modules/clean/react/async_fileops_modals","modules/clean/analytics","external/immutable","modules/clean/react/async/loadable","modules/clean/web_timing_logger"],function(e,t,r,o,n,i,s,a,l,c){"use strict";var d=this
;Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),i=r.__importStar(i),a=r.__importStar(a);var u=l.Loadable({loader:function(){return r.__awaiter(d,void 0,Promise,function(){var t;return r.__generator(this,function(o){switch(o.label){case 0:return[4,c.waitForTTI()];case 1:return o.sent(),[4,new Promise(function(t,r){e(["modules/clean/react/web_team_sharing_modal"],t,r)}).then(r.__importStar)];case 2:return t=o.sent().WebTeamSharingModal,[2,t]}})})}}),p=(function(t){function l(e){var r=t.call(this,e)||this;return r.removeUploadListener=function(){window.removeEventListener(n.ALL_UPLOADS_COMPLETE_EVENT,r.handleUploadsComplete)},r.closeTeamSharingModal=function(){return r.setState({isWebTeamSharingModalOpen:!1})},r.openFileMoveDialog=function(){r.closeTeamSharingModal(),s.TeamsWebActionsLogger.log("post_m1_sharing_modal_clicked"),i.showMove({files:r.props.selectedFiles.toArray(),path:r.props.context.currentFQPath,user:r.props.user})},r.state={isWebTeamSharingModalOpen:!1,uploadedFiles:[],expWebSharingActive:!1},r}return r.__extends(l,t),l.prototype.componentWillReceiveProps=function(t){return r.__awaiter(this,void 0,void 0,function(){var o,i,s,a=this;return r.__generator(this,function(l){switch(l.label){case 0:return!t.browsePostTTIExperiments.expBizAddFilesTeamFolderRwls||this.handleUploadsComplete?[3,2]:[4,new Promise(function(t,r){e(["modules/clean/growth/experiments/web_sharing_helper"],t,r)}).then(r.__importStar)];case 1:o=l.sent(),i=o.logExposure,s=o.shouldShowModal,this.handleUploadsComplete=function(e){if(s(a.props.user,a.props.path)){i();var t=e.detail.files;a.setState({isWebTeamSharingModalOpen:!0,uploadedFiles:t,expWebSharingActive:!0})}},window.addEventListener(n.ALL_UPLOADS_COMPLETE_EVENT,this.handleUploadsComplete),l.label=2;case 2:return[2]}})})},l.prototype.componentWillUnmount=function(){this.handleUploadsComplete&&this.removeUploadListener()},l.prototype.render=function(){return this.state.expWebSharingActive?o.default.createElement(u,{context:this.props.context,files:this.state.uploadedFiles,handleModalClose:this.closeTeamSharingModal,handleAction:this.openFileMoveDialog,open:this.state.isWebTeamSharingModalOpen,user:this.props.user}):null},l.defaultProps={selectedFiles:a.OrderedMap()},l})(o.default.PureComponent);t.WebTeamSharingModalExperiment=p}),define("modules/clean/react/comments2/components/comments_translations",["require","exports","comments2/strings","modules/clean/i18n/formatters","modules/constants/page_load","comments2/l10n"],function(e,t,r,o,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=o.createFormatters(n.USER_LOCALE,r.strings,o.createI18nCache());t.commentsMasterLocalization=i.getCommentsStrings(s)}),define("modules/clean/react/education/education_module_event_bridge",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=(function(){function e(){this.requestSectionHandler=null,this.requestSharingCalloutHandler=null}return e.prototype.registerRequestSectionHandler=function(e){this.requestSectionHandler=e},e.prototype.requestSection=function(e){this.requestSectionHandler&&this.requestSectionHandler(e)},e.prototype.registerRequestSharingCalloutHandler=function(e){this.requestSharingCalloutHandler=e},e.prototype.requestSharingCallout=function(){this.requestSharingCalloutHandler&&this.requestSharingCalloutHandler()},e})();t.educationEventBridge=new r});var __importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};define("modules/clean/react/education/education_module_experiment",["require","exports","modules/clean/react/async/loadable","modules/clean/web_timing_logger","modules/clean/react/css"],function(e,t,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r.Loadable({loader:function(){return o.waitForTTI().then(function(){return new Promise(function(t,r){e(["modules/clean/react/education/education_module_experiment_sync"],t,r)}).then(__importStar)}).then(function(e){return e.UnstyledEducationModuleExperiment})}});t.CXEducationModuleExperiment=n.requireCssWithComponent(i,["/static/js/premium-growth/index.web-vflb9JTu1.css","/static/css/growth/experiments/education_module_experiment-vflFlYQXJ.css","/static/css/font_sharp_grotesk-vfle4tE4q.css"])}),define("modules/clean/react/file_uploader/action_logger",["require","exports","tslib","modules/clean/filepath","modules/clean/react/file_uploader/constants","modules/clean/web_upload_action_logger","modules/clean/web_user_action_logger","modules/clean/web_upload_action_events","modules/clean/web_user_action_events","modules/core/browser"],function(e,t,r,o,n,i,s,a,l,c){"use strict";function d(e){return e&&!!e.uploadId}function u(e){return e&&!!e.batchId}function p(e){return e===l.WebUserActionLogEvent.UPLOAD_BUTTON_CLICK||e===l.WebUserActionLogEvent.ADD_MORE_FILES_CLICK||e===l.WebUserActionLogEvent.VIEW_DETAILS_CLICK||e===l.WebUserActionLogEvent.CLOSE_MODAL_CLICK||e===l.WebUserActionLogEvent.UPLOAD_CLICK||e===l.WebUserActionLogEvent.UPLOAD_FILES_CLICK||e===l.WebUserActionLogEvent.UPLOAD_FOLDER_CLICK||e===l.WebUserActionLogEvent.CANCEL_UPLOAD_CLICK}function f(e,t,l,f,_,m,h,S){var g={num_files:m,num_dirs:h,chooser_type:f,upload_method:_};if(d(l)){var v=l,E=t===a.WebUploadActionEvent.UPLOAD_FAILURE&&v.errorType===n.UploadErrorType.GENERIC&&S?S:v.errorType;g=r.__assign({},g,{upload_id:v.uploadId,file_size:v.size,file_extension:o.file_extension(v.name),failure_reason:E,batch_id:v.batchId,upload_destination:v.dest,current_path:c.get_pathname(),file_name:v.name})}else if(u(l)){var v=l;g=r.__assign({},g,{file_size:v.size,file_extension:o.file_extension(v.name),batch_id:v.batchId})}p(t)?s.WebUserActionLog.log(e,t,g):(t=t,g.client_timestamp=Math.round(Date.now()/1e3),i.WebUploadActionLog.log(e,t,g))}Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),c=r.__importStar(c),t.logUploadAction=f}),define("modules/clean/react/file_uploader/constants",["require","exports","tslib","external/immutable"],function(e,t,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o);(function(e){e.ALL_UPLOADS_COMPLETE="ALL_UPLOADS_COMPLETE",e.SET_PATH="UPLOADER_SET_PATH",e.SET_FOLDER_NS_ID="UPLOADER_SET_FOLDER_NS_ID",e.SET_USER="UPLOADER_SET_USER",e.SET_NUM_DRAGGING_FILES="SET_NUM_DRAGGING_FILES",e.QUEUE_UPLOADS="QUEUE_UPLOADS",e.START_UPLOAD="START_UPLOAD",e.COMPLETE_UPLOAD="COMPLETE_UPLOAD",e.CANCEL_UPLOADS="CANCEL_UPLOADS",e.SET_CURRENT_UPLOAD_PROGRESS="SET_CURRENT_UPLOAD_PROGRESS",e.UPLOAD_ERROR="UPLOAD_ERROR",e.SET_IS_UPLOAD_MODAL_OPEN="SET_IS_UPLOAD_MODAL_OPEN",e.SET_INLINE_STATUS_SHOULD_BE_DISMISSED="SET_INLINE_STATUS_SHOULD_BE_DISMISSED",e.ADD_NEW_FAILED_FILE="ADD_NEW_FAILED_FILE",e.CONFIRM_FSW="CONFIRM_FSW",e.ADD_FILES_TO_PLU="ADD_FILES_TO_PLU",e.ADD_DIRECTORIES_TO_PLU="ADD_DIRECTORIES_TO_PLU",e.REMOVE_FILES="REMOVE_FILES",e.SET_HAS_OVERQUOTA_ERROR="SET_HAS_OVERQUOTA_ERROR"})(t.UploaderActionType||(t.UploaderActionType={}));var n;(function(e){e.PENDING="PENDING",e.UPLOADING="UPLOADING",e.COMPLETE="COMPLETE",e.CANCELLED="CANCELLED",e.FAILED="FAILED"})(n=t.FileStatusType||(t.FileStatusType={}));var i;(function(e){e.FILE_SIZE_ERROR="FILE_SIZE_ERROR",e.HTTP_ERROR="HTTP_ERROR",e.CONNECTION_ERROR="CONNECTION_ERROR",e.OVER_QUOTA_ERROR="OVER_QUOTA_ERROR",e.LOCKED_TEAM_ERROR="LOCKED_TEAM_ERROR",e.IGNORED="IGNORED",e.INVALID_EXTENSION="INVALID_EXTENSION",e.EMPTY_OR_FOLDER="EMPTY_OR_FOLDER",e.FOLDER_SAFARI="FOLDER_SAFARI",e.PACKAGE_FILE="PACKAGE_FILE",e.GENERIC="GENERIC",e.BLOCKS_MISSING_ERROR="BLOCKS_MISSING_ERROR",e.COMMIT_HTTP_ERROR="COMMIT_HTTP_ERROR",e.UPLOAD_BLOCK_ERROR="UPLOAD_BLOCK_ERROR",e.CHUNKS_NOT_ENABLED_ERROR="CHUNKS_NOT_ENABLED_ERROR",e.SERVER_RESPONSE_ERROR="SERVER_RESPONSE_ERROR",e.SERVER_TOKEN_EMPTY_ERROR="SERVER_TOKEN_EMPTY_ERROR",e.SERVER_TOKENS_MISSING_ERROR="SERVER_TOKENS_MISSING_ERROR",e.SERVER_HASH_RESPONSE_ERROR="SERVER_HASH_RESPONSE_ERROR",e.BLOCK_RUNTIME_ID_MISSING_ERROR="BLOCK_RUNTIME_ID_MISSING",e.CLIENT_HASH_EMPTY_ERROR="CLIENT_HASH_EMPTY_ERROR",e.SERVER_HASH_EMPTY_ERROR="SERVER_HASH_EMPTY_ERROR",e.HASHES_NOT_EQUAL_ERROR="HASHES_NOT_EQUAL_ERROR",e.BLOCK_INDEX_ERROR="BLOCK_INDEX_ERROR",e.BLOCK_EMPTY_ERROR="BLOCK_EMPTY_ERROR",e.BLOB_EMPTY_ERROR="BLOB_EMPTY_ERROR",e.BLOB_MISSING_ERROR="BLOB_MISSING_ERROR",e.CLIENT_HASH_DIGEST_ERROR="CLIENT_HASH_DIGEST_ERROR",e.FILE_READER_NULL_RESULT_ERROR="FILE_READER_NULL_RESULT_ERROR",e.COMMIT_READINESS_ERROR="COMMIT_READINESS_ERROR",e.UPLOAD_PRECHECK_ERROR="UPLOAD_PRECHECK_ERROR",e.UPLOAD_PRECHECK_INVALID_CHAR_ERROR="UPLOAD_PRECHECK_INVALID_CHAR_ERROR"})(i=t.UploadErrorType||(t.UploadErrorType={}));(function(e){e.NONE="NONE",e.BASIC_OVER_QUOTA="BASIC_OVER_QUOTA",e.BASIC_NEAR_QUOTA="BASIC_NEAR_QUOTA",e.LIMITED_TEAM_USER_OVER_QUOTA="LIMITED_TEAM_USER_OVER_QUOTA",e.LIMITED_TEAM_TSD_OVER_QUOTA="LIMITED_TEAM_TSD_OVER_QUOTA",e.LOCKED_TEAM_USER_OVER_QUOTA="LOCKED_TEAM_USER_OVER_QUOTA"})(t.OverQuotaStatusType||(t.OverQuotaStatusType={}));var s=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t})(o.Record({uploadId:void 0,dest:"",ns_id:null,ns_path:null,userId:null,name:"",size:0,percentUploaded:0,status:n.PENDING,errorType:i.GENERIC,errorMessage:"",batchId:void 0,chooserType:void 0},"FileUpload"));t.FileUpload=s,t.UPLOAD_BEGIN_EVENT="dbxUploadBegin",t.UPLOAD_CANCEL_EVENT="dbxUploadCancel",t.UPLOAD_COMPLETE_EVENT="dbxUploadComplete",t.ALL_UPLOADS_COMPLETE_EVENT="dbxAllUploadsComplete",t.UPLOAD_ERROR_EVENT="dbxUploadError";(function(e){e[e["4mb"]=0]="4mb",e[e["8mb"]=1]="8mb"})(t.ValidChunkSizeStrings||(t.ValidChunkSizeStrings={}))}),define("modules/clean/react/file_uploader/store",["require","exports","tslib","external/immutable","modules/clean/flux/base_store","modules/clean/react/file_uploader/constants","modules/clean/react/file_uploader/utils","modules/core/exception"],function(e,t,r,o,n,i,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o);var l=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype._init=function(){this._path="/",this._hasPermissionToUploadToFolder=!0,this._folderNsId=null,this._user=null,this._fileList=o.OrderedMap(),this._currentUploadId=null,this._numDraggingFiles=0,this._isInternalTransfer=!1,this._isUploadModalOpen=!1,this._inlineStatusShouldBeDismissed=!1,this._numSecondsLeft=0,this._confirmedFSWs=[],this._confirmedFSWBatchIds=[],this._hasOverquotaError=!1,this._allUploadsComplete=!1},t.prototype.fileList=function(){return this._fileList},t.prototype.currentUpload=function(){var e=this._currentUploadId;if(!e)return null;var t=this._fileList.get(e);return t?t:null},t.prototype.uploadById=function(e){var t;return e&&(t=this._fileList.get(e)),t||void 0},t.prototype.numSecondsLeft=function(){return this._numSecondsLeft},t.prototype.isUploadCancelled=function(e){var t=this._fileList.get(e);return!!t&&t.status===i.FileStatusType.CANCELLED},t.prototype.inlineStatusShouldBeDismissed=function(){return this._inlineStatusShouldBeDismissed},t.prototype.path=function(){return this._path},t.prototype.folderNsId=function(){return this._folderNsId},t.prototype.hasPermissionToUploadToFolder=function(){return this._hasPermissionToUploadToFolder},t.prototype.user=function(){return this._user},t.prototype.nextUpload=function(){return this._fileList.find(function(e){return e.status===i.FileStatusType.PENDING})},t.prototype.numDraggingFiles=function(){return this._numDraggingFiles},t.prototype.isInternalTransfer=function(){return this._isInternalTransfer},t.prototype.isUploadModalOpen=function(){return this._isUploadModalOpen},t.prototype.confirmedFSWs=function(){return this._confirmedFSWs},t.prototype.confirmedFSWBatchIds=function(){return this._confirmedFSWBatchIds},t.prototype.hasOverquotaError=function(){return this._hasOverquotaError},t.prototype.allUploadsComplete=function(){return this._allUploadsComplete},t.prototype.setUser=function(e){var t=e.user;this._user=t,this.emit_change()},t.prototype.setPath=function(e){var t=e.path,r=e.hasPermissionToUploadToFolder,o=void 0===r||r;this._path=t,this._hasPermissionToUploadToFolder=o,this._confirmedFSWs=[],this.emit_change()},t.prototype.setFolderNsId=function(e){var t=e.folderNsId;this._folderNsId=t},t.prototype.setHasOverquotaError=function(e){var t=e.hasOverquotaError;this._hasOverquotaError=t,this.emit_change()},t.prototype.queueUploads=function(e){for(var t=e.files,r={},o=0,n=t;o<n.length;o++){var i=n[o];r[i.uploadId]=i}this._fileList=this._fileList.merge(r),this.emit_change()},t.prototype.handleAllUploadsComplete=function(){this._allUploadsComplete=!0,this.emit_change()},t.prototype.startUpload=function(e){var t=e.file;a.assert(null==this.currentUpload(),"can't start an unload while one is ongoing"),a.assert(null!=t,"missing file to upload"),a.assert(this._fileList.get(t.uploadId)===t,"failed to find file in file list"),this._fileList.get(t.uploadId)&&(this._fileList=this._fileList.update(t.uploadId,function(e){return e.set("status",i.FileStatusType.UPLOADING)}),this._currentUploadId=t.uploadId,this._allUploadsComplete=!1),this.emit_change()},t.prototype.completeUpload=function(e){var t=e.uploadId,r=this._fileList.get(t);r&&(t===this._currentUploadId&&r.status===i.FileStatusType.UPLOADING||a.reportStack("Tried to mark a file upload that is not currently uploading as complete",{exc_extra:{file:r.toString(),fileListLength:this._fileList.count(),uploadId:t,currentUploadId:this._currentUploadId}}),this._fileList=this._fileList.update(t,function(e){return e.set("status",i.FileStatusType.COMPLETE)})),this._currentUploadId=null,this.emit_change()},t.prototype.cancelUploads=function(e){for(var t=e.files,r=0,o=t;r<o.length;r++){var n=o[r];this._fileList=this._fileList.update(n.uploadId,function(e){return e.status===i.FileStatusType.PENDING||e.status===i.FileStatusType.UPLOADING?e.set("status",i.FileStatusType.CANCELLED):e}),n.uploadId===this._currentUploadId&&(this._currentUploadId=null)}this.emit_change()},t.prototype.setCurrentUploadProgress=function(e){var t=e.percentComplete,r=e.numSecondsLeft,o=this._currentUploadId;o&&(this._fileList=this._fileList.update(o,function(e){return e.set("percentUploaded",t)}),void 0!==r&&(this._numSecondsLeft=r)),this.emit_change()},t.prototype.handleUploadError=function(e){var t=e.uploadId,r=e.errorType,o=e.errorMessage,n=this._fileList.get(t);n&&(n.uploadId!==this._currentUploadId&&a.reportStack("Error reported for file upload that is not the current upload",{exc_extra:{file:n.toString(),fileListLength:this._fileList.count(),uploadId:t,currentUploadId:this._currentUploadId,errorType:r,errorMessage:o}}),this._fileList=this._fileList.update(n.uploadId,function(e){return e.set("status",i.FileStatusType.FAILED).set("errorType",r).set("errorMessage",o)})),this._currentUploadId=null,this.emit_change()},t.prototype.setNumDraggingFiles=function(e){var t=e.numDraggingFiles,r=e.isInternalTransfer,o=void 0!==r&&r;this._numDraggingFiles=t,this._isInternalTransfer=o,this.emit_change()},t.prototype.setIsUploadModalOpen=function(e){var t=e.isUploadModalOpen;this._isUploadModalOpen=t,this.emit_change()},t.prototype.setInlineStatusShouldBeDismissed=function(e){var t=e.inlineStatusShouldBeDismissed;this._inlineStatusShouldBeDismissed=t,this.emit_change()},t.prototype.addNewFailedFile=function(e){var t=e.file,r=e.errorType,o=e.errorMessage;null==t.uploadId&&(t=t.set("uploadId",s.generateUploadId())),t=t.set("status",i.FileStatusType.FAILED).set("errorType",r).set("errorMessage",o),this._fileList=this._fileList.set(t.uploadId,t),this.emit_change()},t.prototype.confirmFSW=function(e){var t=this,r=e.fswIds,o=e.batchId;r.forEach(function(e){t._confirmedFSWs.includes(e)||t._confirmedFSWs.push(e)}),this._confirmedFSWBatchIds.includes(o)||this._confirmedFSWBatchIds.push(o)},t.prototype._new_payload=function(e){var t=e.action;switch(t.type){case i.UploaderActionType.SET_USER:this.setUser(t.data);break;case i.UploaderActionType.SET_PATH:this.setPath(t.data);break;case i.UploaderActionType.SET_FOLDER_NS_ID:this.setFolderNsId(t.data);break;case i.UploaderActionType.QUEUE_UPLOADS:this.queueUploads(t.data);break;case i.UploaderActionType.START_UPLOAD:this.startUpload(t.data);break;case i.UploaderActionType.COMPLETE_UPLOAD:this.completeUpload(t.data);break;case i.UploaderActionType.ALL_UPLOADS_COMPLETE:this.handleAllUploadsComplete();break;case i.UploaderActionType.CANCEL_UPLOADS:this.cancelUploads(t.data);break;case i.UploaderActionType.SET_CURRENT_UPLOAD_PROGRESS:this.setCurrentUploadProgress(t.data);break;case i.UploaderActionType.UPLOAD_ERROR:this.handleUploadError(t.data);break;case i.UploaderActionType.SET_NUM_DRAGGING_FILES:this.setNumDraggingFiles(t.data);break;case i.UploaderActionType.SET_IS_UPLOAD_MODAL_OPEN:this.setIsUploadModalOpen(t.data);break;case i.UploaderActionType.SET_INLINE_STATUS_SHOULD_BE_DISMISSED:this.setInlineStatusShouldBeDismissed(t.data);break;case i.UploaderActionType.ADD_NEW_FAILED_FILE:this.addNewFailedFile(t.data);break;case i.UploaderActionType.CONFIRM_FSW:this.confirmFSW(t.data);break;case i.UploaderActionType.SET_HAS_OVERQUOTA_ERROR:this.setHasOverquotaError(t.data)}},t})(n.Store);t.UploaderStoreClass=l,t.uploaderStore=new l}),define("modules/clean/react/file_uploader/utils",["require","exports","tslib","react","modules/clean/filepath","modules/clean/react_format","modules/clean/base64","modules/core/browser","modules/clean/analytics","modules/core/i18n","modules/clean/growth/types","modules/clean/growth/api","modules/clean/react/growth/education_module_event_bridge","modules/clean/react/snackbar"],function(e,t,r,o,n,i,s,a,l,c,d,u,p,f){"use strict";function _(){return h()}function m(){return"batch-"+h()}function h(){for(var e="",t=0;t<16;++t)e+=String.fromCharCode(Math.floor(256*Math.random()));var r=s.encode(e);return r=r.replace(/\+/g,"-"),r=r.replace(/\//g,"_"),r=r.replace(/\=*$/,"")}function S(e,t){var r=0;return e.forEach(function(e){t.indexOf(e.status)!==-1&&(r+=e.size)}),r}function g(e,t,r){var o=t,n=0;return e.forEach(function(e,t){for(var i=0,s=e.split("/"),a=r.split("/");i<s.length&&i<a.length&&s[i]===a[i];)i++;i===s.length&&i>1&&i>n&&(n=i,o=Number(t))}),o}function v(e){var t;switch(e){case d.FolderType.Private:t=c._("<b>Only you can view and edit these files</b>. If you want to share, you can send anyone a read-only copy of your work.");break;case d.FolderType.Shared:t=c._("<b>Anyone in this folder can view this file. Only people with edit access can make changes.</b> You can edit user permissions at any time.");break;case d.FolderType.Team:t=c._("<b>Anyone on your team can access these files.</b> You can also create a folder to share files with specific team members.");break;default:throw d.enforceExhaustive(e),new Error("unknown folderType: "+e)}return{calloutTitle:o.createElement("span",null,i.reactFormat(t,{b:o.createElement("b",null)})),calloutButtonText:c._("Learn More")}}function E(e){switch(e){case d.FolderType.Private:return"private";case d.FolderType.Shared:return"specific";case d.FolderType.Team:return"everyone";default:throw d.enforceExhaustive(e),new Error("unknown folderType: "+e)}}function w(e){switch(e){case d.FolderType.Shared:return{sectionIdx:1,itemIdx:0};case d.FolderType.Team:return{sectionIdx:0,itemIdx:1};case d.FolderType.Private:return{sectionIdx:1,itemIdx:2};default:throw d.enforceExhaustive(e),new Error("unknown folderType: "+e)}}function b(e){return function(){f.Snackbar.close(),p.educationEventBridge.requestSection(e)}}function T(e,t,o){if(t){var n=v(e),i=w(e),s=b(i);return r.__assign({},n,{onCalloutButtonClick:s,viewContext:d.calculateViewContext(),logEvent:l.TeamsWebActionsLogger.log,extraLogInfo:{access_type:E(e),target_module_section_index:"string"!=typeof i&&i.sectionIdx,target_module_item_index:"string"!=typeof i&&i.itemIdx},onSnackbarSeen:function(){return u.markRichSnackbarAsSeen(e,t)},onSnackbarFinished:function(){return o(e)}})}}function F(e,t){return!e.is_team||!e.is_cdm_member||""!==n.normalize(t)&&(n.paths_are_equal(e.cdm_tmf_path,t)||n.inSubDirectory(e.cdm_tmf_path,t))}function y(e,t){return{root_folder:""===n.normalize(t),member_folder:F(e,t),folder_level:n.normalize(t).split("/").length}}function C(e){return{has_permissions:e.includes("action_commit_to_tsd_root"),has_permissions_nonroot:e.includes("action_missing_parent"),has_other:e.some(function(e){return!I.includes(e)})}}Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),n=r.__importStar(n),s=r.__importStar(s),a=r.__importStar(a),t.generateUploadId=_,t.generateBatchId=m,t.calculateSizeOfUploads=S,t.getNsId=g,t.getOQmodalOQALocationCode=function(e){return"/h"===(e||a.get_uri().path)?"ho":"fb"},t.folderTypeToSnackbarCopy=v,t.computeRichSnackbarProps=T,t.getUploadLocationMetadataToLog=y;var I=["action_commit_to_tsd_root","action_missing_parent"];t.getFSWMetadataToLog=C}),define("modules/clean/react/fileops_actions",["require","exports","tslib","react","modules/clean/em_string","modules/clean/file_operations/notifications","modules/clean/filepath","modules/clean/react/async_file_modal_controller","modules/clean/react/browse/action_logger","modules/clean/react/browse/api","modules/clean/react/browse/models","modules/clean/react/browse/data/action_creators","modules/clean/react/browse/data/store","modules/clean/react/files_view/file_actions/api_v2","modules/clean/react/files_view/file_actions/file_from_metadata","modules/clean/react/snackbar","modules/clean/react_format","modules/clean/sharing/browse_exports","modules/clean/sharing/constants","modules/clean/undo","modules/clean/viewer","modules/clean/web_user_action_events","modules/core/i18n","modules/core/notify"],function(e,t,r,o,n,i,s,a,l,c,d,u,p,f,_,m,h,S,g,v,E,w,b,T){"use strict";function F(e){return r.__awaiter(this,void 0,Promise,function(){var t,o,n,i,s,a,l;return r.__generator(this,function(r){switch(r.label){case 0:return t=e.files,o=e.newPath,n=e.onUndo,i=e.onSuccess,s=e.user,m.Snackbar.sync(b.ungettext("Copying %(num_files)s item...","Copying %(num_files)s items...",t.length).format({num_files:t.length}),!0,"browse-action"),[4,f.copyFiles(t,o,s.id,!1)];case 1:return a=r.sent(),l={successLogAction:w.WebUserActionLogEvent.COPY_REQUEST_SUCCESS,failedLogAction:w.WebUserActionLogEvent.COPY_REQUEST_FAIL,undoingLogAction:w.WebUserActionLogEvent.COPY_UNDO,undoFailedLogAction:w.WebUserActionLogEvent.COPY_UNDO_REQUEST_FAIL,undoSuccessLogAction:w.WebUserActionLogEvent.COPY_UNDO_REQUEST_SUCCESS,undoingSnackbarText:b._("Undoing copy..."),undoFailedSnackbarText:b._("Couldn’t undo copy."),undoSuccessSnackbarText:b._("Copy undone."),getFailureSnackbarText:function(e){return b.ungettext("Couldn’t copy %(failed_to_copy_files)s item.","Couldn’t copy %(failed_to_copy_files)s items.",e).format({failed_to_copy_files:e})},getPartialSuccessSnackbarText:function(e,t){return b.ungettext("Copied %(succesfully_copied_files)s out of %(total_num_files)s item.","Copied %(succesfully_copied_files)s out of %(total_num_files)s items.",t).format({succesfully_copied_files:e,total_num_files:t})},getSuccessSnackbarText:function(e){return b.ungettext("Copied %(succesfully_copied_files)s item.","Copied %(succesfully_copied_files)s items.",e).format({succesfully_copied_files:e})}},R(a,s,t,o,l,i,n),[2]}})})}function y(e){return r.__awaiter(this,void 0,Promise,function(){var t,o,n,i,a,l,c,d,u,p;return r.__generator(this,function(r){switch(r.label){case 0:return t=e.path,o=e.files,n=e.newPath,i=e.onUndo,a=e.onSuccess,l=e.user,c=e.dataApiV2,d=void 0===c?f:c,void 0!==t&&s.paths_are_equal(t,n)?(m.Snackbar.fail(b._("Those files already exist in that folder."),"browse-action"),[2]):(m.Snackbar.sync(b.ungettext("Moving %(num_files)s item...","Moving %(num_files)s items...",o.length).format({num_files:o.length}),!0,"browse-action"),[4,d.moveFiles(o,n,l.id,!1,!1)]);case 1:return u=r.sent(),p={successLogAction:w.WebUserActionLogEvent.MOVE_REQUEST_SUCCESS,failedLogAction:w.WebUserActionLogEvent.MOVE_REQUEST_FAIL,undoingLogAction:w.WebUserActionLogEvent.MOVE_UNDO,undoFailedLogAction:w.WebUserActionLogEvent.MOVE_UNDO_REQUEST_FAIL,undoSuccessLogAction:w.WebUserActionLogEvent.MOVE_UNDO_REQUEST_SUCCESS,undoingSnackbarText:b._("Undoing move..."),undoFailedSnackbarText:b._("Couldn’t undo move."),undoSuccessSnackbarText:b._("Move undone."),getFailureSnackbarText:function(e){return b.ungettext("Couldn’t move %(failed_to_move_files)s item.","Couldn’t move %(failed_to_move_files)s items.",e).format({failed_to_move_files:e})},getPartialSuccessSnackbarText:function(e,t){return b.ungettext("Moved %(succesfully_moved_files)s out of %(total_num_files)s item.","Moved %(succesfully_moved_files)s out of %(total_num_files)s items.",t).format({succesfully_moved_files:e,total_num_files:t})},getSuccessSnackbarText:function(e){return b.ungettext("Moved %(succesfully_moved_files)s item.","Moved %(succesfully_moved_files)s items.",e).format({succesfully_moved_files:e})}},R(u,l,o,n,p,a,i),[2]}})})}function C(e,t,r,o,n){var i=E.Viewer.get_viewer().team_name,l=!1;"is_cdm_member"in e&&e.is_cdm_member&&s.inSubDirectory(e.cdm_tmf_path,o)&&(l=!0);var c=O(e,t,i,r,l);if(null==c)return void(n&&n());T.Notify.clear();var f=t===N.TEAM_SPACE_OWNER_ONLY_MANAGE_MEMBERSHIP_ERROR||t===N.TEAM_SPACE_ONLY_ON_TEAM_SHARING_ERROR||t===N.NS_HAVE_MOUNTED_CHILDREN_NS_ERROR,_=I(e,f,i,r.length,l),m="";m=f?"/help/business/team-space-overview#out":"/help/business/team-space-overview#move";var h=1===r.length,v=r[0]instanceof d.File&&h&&!f?b._("See owner"):void 0,w=function(){r[0]instanceof d.File&&S.asyncShowShareModal(e.id,r[0],{origin:g.SHARE_ACTION_ORIGIN_TYPE.BROWSE_FILE_ACTIONS},function(e){var t=e.path,r=e.qargs;return p.getStoreForBrowse().dispatch(u.setUrl({path:t,qargs:r}))})};a.showMoveErrorModal({title:_,content:c,learnMoreLink:m,buttonString:v,onClick:w})}function I(e,t,r,o,i){return t?1===o?b._("Can’t move out of the team space"):b._("Can’t move %(num_of_files)s items").format({num_of_files:o}):"is_cdm_member"in e&&e.is_cdm_member&&!i?b.ungettext("Can’t move shared folder to the %(team_name)s team space","Can’t move shared folders to the %(team_name)s team space",o).format({team_name:n.Emstring.em_snippet(r,g.SNIPPET_SIZES.DISPLAY_NAME)}):b.ungettext("Can’t move shared folder to a team folder","Can’t move shared folders to a team folder",o)}function O(e,t,r,i,a){var l=b._("You don’t have permission to move some of these items. Try moving items individually."),c=null;return t===N.OFF_TEAM_OWNER_ERROR?c=1===i.length?null==r?h.reactFormat(b._("The owner of <strong>%(file_name)s</strong> is a member of another team.").format({file_name:n.Emstring.em_snippet(s.filename(i[0].fq_path),g.SNIPPET_SIZES.FILENAME)}),{strong:o.default.createElement("strong",{style:{fontWeight:500}})}):h.reactFormat(b._("The owner of <strong>%(file_name)s</strong> isn’t a member of %(team_name)s.").format({team_name:r,file_name:n.Emstring.em_snippet(s.filename(i[0].fq_path),g.SNIPPET_SIZES.FILENAME)}),{strong:o.default.createElement("strong",{style:{fontWeight:500}})}):null==r?b._("The owner of some of these shared folders is a member of another team."):b._("The owner of some of these shared folders isn’t a member of %(team_name)s.").format({team_name:r}):t===N.OWNER_ONLY_MANAGE_MEMBERSHIP_ERROR?c=1===i.length?"is_cdm_member"in e&&e.is_cdm_member&&!a?h.reactFormat(b._("Only the owner of <strong>%(file_name)s</strong> can move it to the %(team_name)s team space.").format({team_name:r,file_name:n.Emstring.em_snippet(s.filename(i[0].fq_path),g.SNIPPET_SIZES.FILENAME)}),{strong:o.default.createElement("strong",{style:{fontWeight:500}})}):h.reactFormat(b._("Only the owner of <strong>%(file_name)s</strong> can move it to a team folder.").format({file_name:n.Emstring.em_snippet(s.filename(i[0].fq_path),g.SNIPPET_SIZES.FILENAME)}),{strong:o.default.createElement("strong",{style:{fontWeight:500}})}):"is_cdm_member"in e&&e.is_cdm_member&&!a?b._("Only the owner can move some of these folders to the %(team_name)s team space.").format({team_name:r}):b._("Only the owner can move some of these folders to a team folder."):t===N.VIEW_ONLY_ACCESS_ERROR?c=1===i.length?h.reactFormat(b._("You can only view <strong>%(file_name)s</strong>. Ask an owner or editor of the folder for access to edit it.").format({file_name:n.Emstring.em_snippet(s.filename(i[0].fq_path),g.SNIPPET_SIZES.FILENAME)}),{strong:o.default.createElement("strong",{style:{fontWeight:500}})}):b._("You can’t edit some of these folders. Ask an owner or editor of the folders for access to edit them."):t===N.TEAM_SPACE_OWNER_ONLY_MANAGE_MEMBERSHIP_ERROR||t===N.TEAM_SPACE_ONLY_ON_TEAM_SHARING_ERROR?c=1===i.length?h.reactFormat(b._("If you need to move <strong>%(file_name)s</strong>, ask your admin to move it for you.").format({file_name:n.Emstring.em_snippet(s.filename(i[0].fq_path),g.SNIPPET_SIZES.FILENAME)}),{strong:o.default.createElement("strong",{style:{fontWeight:500}})}):l:t===N.NS_HAVE_MOUNTED_CHILDREN_NS_ERROR&&(c=1===i.length?h.reactFormat(b._("<strong>%(file_name)s</strong> has other shared folders inside it. Try moving each shared folder individually.").format({file_name:n.Emstring.em_snippet(s.filename(i[0].fq_path),g.SNIPPET_SIZES.FILENAME)}),{strong:o.default.createElement("strong",{style:{fontWeight:500}})}):l),c}function R(e,r,o,n,i,s,a){if(e.isError){m.Snackbar.close("browse-action");var c=function(){m.Snackbar.fail(i.getFailureSnackbarText(o.length),"browse-action")};return C(r,e.error[".tag"],o,n,c),void l.logFileAction({uid:r.id,action:i.failedLogAction,num_files_selected:o.length,num_folders_selected:0,error_summary:e.error_summary,error:e.error[".tag"],jobId:e&&e.jobId})}var d=function(e){return"success"===e[".tag"]},u=e.result.entries.filter(d),p=u.length,f=o.length-p,h=P(e,r,i,a);if(t.showBatchCompletedSnackbar(o.length,p,f,i,h),s){var S=[];u.forEach(function(e){if("file"===e.success[".tag"]||"folder"===e.success[".tag"]){var t=e.success,r=o.find(function(e){return e.file_id===t.id});if(r){var n=_.fileFromMetadata(r,t);S.push(n)}}}),s([],S)}D(i.successLogAction,e.result,r.id,e.jobId,o.length)}function P(e,t,o,n){var i=this;return!e.isError&&e.result.changeset_data&&e.result.changeset_data.length>0?function(){return r.__awaiter(i,void 0,void 0,function(){var i,s;return r.__generator(this,function(r){switch(r.label){case 0:return m.Snackbar.sync(o.undoingSnackbarText,!0,"browse-action"),i=!1,l.logFileAction({uid:t.id,action:o.undoingLogAction,num_files_selected:e.result.entries.length,num_folders_selected:0}),[4,f.undo(e.result.changeset_data,t)];case 1:return s=r.sent(),s.isError?(m.Snackbar.fail(o.undoFailedSnackbarText,"browse-action"),l.logFileAction({uid:t.id,action:o.undoFailedLogAction,num_files_selected:e.result.entries.length,num_folders_selected:0,error_summary:s.error_summary,error:s.error[".tag"]})):(m.Snackbar.complete(o.undoSuccessSnackbarText,"browse-action"),i=!0,l.logFileAction({uid:t.id,action:o.undoSuccessLogAction,num_files_selected:e.result.entries.length,num_folders_selected:0})),n&&n(i),[2]}})})}:void 0}function D(e,t,r,o,n){var i=n,s=0,a=void 0,c=t.entries.filter(function(e){return"success"===e[".tag"]});c&&(i=c.filter(function(e){return"file"===e.success[".tag"]}).length,s=c.filter(function(e){return"folder"===e.success[".tag"]}).length);var d=t.entries.filter(function(e){return"failure"===e[".tag"]});d&&d.length>0&&(a=d[0].failure[".tag"]),l.logFileAction({uid:r,action:e,num_files_selected:i,num_folders_selected:s,jobId:o,error_summary:a})}Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),i=r.__importStar(i),s=r.__importStar(s),a=r.__importStar(a),c=r.__importStar(c),u=r.__importStar(u),f=r.__importStar(f);var N={VIEW_ONLY_ACCESS_ERROR:"view_only_access_error",OFF_TEAM_OWNER_ERROR:"off_team_owner_error",OWNER_ONLY_MANAGE_MEMBERSHIP_ERROR:"owner_only_manage_membership_error",
TEAM_SPACE_OWNER_ONLY_MANAGE_MEMBERSHIP_ERROR:"team_space_owner_only_manage_membership_error",TEAM_SPACE_ONLY_ON_TEAM_SHARING_ERROR:"team_space_only_on_team_sharing_error",NS_HAVE_MOUNTED_CHILDREN_NS_ERROR:"ns_have_mounted_children_ns_error"};t.copyFiles=function(e){return e.useApiV2?F(e):A(e)};var A=function(e){var o=e.files,n=e.newPath,s=e.checkFSWs,l=e.onSuccess,d=e.onRequestNotSent,u=e.onUndo,p=e.user,f=e.dataApi;!(void 0===f?c:f).copyFiles({files:o,newPath:n,checkFSWs:s,userId:p.id,onSuccess:function(s){var c=s.newFiles,d=s.changesets,f=s.failureDetails;if(f){var _=function(){t.copyFiles(r.__assign({},e,{checkFSWs:!1}))};a.showFileSystemWarningsModal({fsws:f,onFinalAccept:_,confirmText:b._("Copy")})}else l&&l(c),i.notifyCopySuccess(o.length,p,d,n,function(){u&&u()})}})&&d&&d()};t.moveFiles=function(e){return e.useApiV2?y(e):L(e)};var L=function(e){var o=e.path,n=e.files,s=e.newPath,l=e.checkFSWs,d=e.onSuccess,u=e.onRequestNotSent,p=e.onUndo,f=e.user,_=e.dataApi,m=void 0===_?c:_,h=function(o){var l=o.newFiles,c=o.changesets,u=o.failureDetails;if(u){var _=function(){t.moveFiles(r.__assign({},e,{checkFSWs:!1}))};a.showFileSystemWarningsModal({fsws:u,onFinalAccept:_,confirmText:b._("Move")})}else i.notifyMoveSuccess(n.length,f,c,s,function(){p&&p()}),d&&d(l)},S=function(e){"This will result in losing ownership of these folders."===e?(T.Notify.clear(),a.showConfirmOwnershipTransferModal(function(){m.moveFiles({path:o,files:n,newPath:s,userId:f.id,onSuccess:h,allowOwnershipTransfer:!0})})):C(f,e,n,s)};!m.moveFiles({path:o,files:n,newPath:s,checkFSWs:l,userId:f.id,onSuccess:h,onError:S,allowOwnershipTransfer:!1})&&u&&u()};t.getBatchUndoHandler=P,t.showBatchCompletedSnackbar=function(e,t,r,o,n){if(t>0&&r>0){var i=o.getPartialSuccessSnackbarText(t,e);n?(v.setHandleUndo(n),m.Snackbar.completeWithUndo(i,n,"browse-action")):m.Snackbar.complete(i,"browse-action")}else if(t>0){var i=o.getSuccessSnackbarText(t);n?(v.setHandleUndo(n),m.Snackbar.completeWithUndo(i,n,"browse-action")):m.Snackbar.complete(i,"browse-action")}else m.Snackbar.fail(o.getFailureSnackbarText(r),"browse-action")}}),define("modules/clean/react/files_view/column_header",["require","exports","tslib","external/classnames","react","spectrum/checkbox","spectrum/table","modules/clean/react/files_view/column_header_menu","modules/clean/react/files_view/fixed_table_head","modules/clean/react/files_view/sticky_table_head","modules/clean/react/files_view/types","modules/clean/react/files_view/view_type_column_header_menu","modules/core/i18n"],function(e,t,r,o,n,i,s,a,l,c,d,u,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),n=r.__importDefault(n);var f=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={isHovered:!1},t.handleChangeSelectAllCheckbox=function(e){"unchecked"===e?t.props.onDeselectAll():t.props.onSelectAll()},t.handleMouseEnter=function(){t.setState({isHovered:!0})},t.handleMouseLeave=function(){t.setState({isHovered:!1})},t}return r.__extends(t,e),t.prototype.getAriaSortValue=function(e){return e===d.SortDirection.ASCENDING?"ascending":e===d.SortDirection.DESCENDING?"descending":"none"},t.prototype.render=function(){var e=this,t=this.state.isHovered,d=this.props,f=d.columnFlex,_=d.isCompactMode,m=d.isSelectMode,h=d.currentSort,S=d.onSelection,g=d.onSort,v=d.onSwitchViewType,E=d.selectAllCheckboxState,w=void 0===E?"unchecked":E,b=d.showSelectAllCheckbox,T=void 0===b||b,F=d.stickyOffsetHeight,y=d.stickyOffsetTop,C=d.columns,I=d.visibleColumns,O=d.viewType,R=d.viewTypes,P=d.viewTypeLabels,D=d.onTTI,N=d.isSearchMode,A=d.presentationOnly,L=d.variant,x=!m&&!t&&!_,M=[n.default.createElement(s.TableHeadCell,{className:"brws-column-header-table-cell brws-checkbox-cell",key:"checkbox-cell",role:A?"presentation":"columnheader",scope:"col"},n.default.createElement("div",{className:"brws-vertically-center"},T?n.default.createElement(i.Checkbox,{className:o.default("brws-checkbox",{"brws-checkbox-checked":"checked"===w}),checked:w,onChange:this.handleChangeSelectAllCheckbox,variant:x?"invisible":"default",ariaLabel:p._("Select all")}):null))].concat(I.map(function(t,r){var o=h&&h.sortField===t.sortField?h.sortDirection:void 0;return n.default.createElement(s.TableHeadCell,{key:r,role:A?"presentation":"columnheader",scope:"col","aria-sort":e.getAriaSortValue(o),className:"brws-column-header-table-cell"},n.default.createElement(a.ColumnHeaderMenu,{column:t,sortDirection:o,columns:C,visibleColumns:I,onSelection:S,onSort:g,viewType:O,isSearchMode:N}),r===I.length-1&&n.default.createElement(u.ViewTypeColumnHeaderMenu,{onTTI:D,viewType:O,viewTypes:R,viewTypeLabels:P,onSwitchViewType:v}))})),U={onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave};return"default"===L?n.default.createElement(s.TableHead,r.__assign({className:"brws-column-header"},U),M):"fixed"===L?n.default.createElement(l.FixedTableHead,r.__assign({offsetHeight:F},U),M):"sticky-native"===L?n.default.createElement(s.TableHead,r.__assign({className:"brws-column-header brws-column-header--sticky",style:{position:"sticky",top:y,zIndex:1}},U),M):n.default.createElement(c.StickyTableHead,r.__assign({columnFlex:f,offsetHeight:F,offsetTop:y,className:"brws-column-header"},U),M)},t.defaultProps={variant:"fixed"},t})(n.default.PureComponent);t.ColumnHeader=f}),define("modules/clean/react/files_view/column_header_menu",["require","exports","tslib","external/classnames","spectrum/icon_form","spectrum/popover","react","modules/clean/react/files_view/constants","modules/clean/react/files_view/types","modules/core/i18n"],function(e,t,r,o,n,i,s,a,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),s=r.__importDefault(s);var d=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handlePopoverSelection=function(e){var r=t.props,o=r.onSort,n=r.onSelection,i=r.column;if(e===l.SortDirection.ASCENDING||e===l.SortDirection.DESCENDING)o(i.sortField,e);else{if(n(e,i),t.props.isSearchMode)return void o(e.sortField,l.SortDirection.DESCENDING);1===t.props.visibleColumns.length&&o(e.sortField,t.props.sortDirection||l.SortDirection.ASCENDING)}},t}return r.__extends(t,e),t.prototype._columnMenuTitle=function(){switch(this.props.viewType){case l.ViewType.Grid:case l.ViewType.LargeGrid:return c._("Group by");case l.ViewType.List:default:return this.props.isSearchMode?c._("Sort by"):c._("Show")}},t.prototype.render=function(){var e=this.props,t=e.column,r=e.columns,d=e.visibleColumns,u=e.sortDirection,p=e.isSearchMode;if(t.isSortDisabled)return s.default.createElement("div",{className:"normal brws-column-header-menu"},s.default.createElement("span",{className:"brws-column-header-menu-trigger-disabled"},t.label));var f,_=!(t.sortField!==l.SortField.RELEVANCE||!p),m=u!==l.SortDirection.ASCENDING||_?u!==l.SortDirection.DESCENDING||_?"caret-down":"sort-arrow-down":"sort-arrow-up",h=_?null:s.default.createElement(i.PopoverItemGroupSeparator,{key:"show-separator"}),S=p?a.SEARCH_LIST_VIEW_SORT_ENABLED_COLUMNS:r;return!t.isLocked&&r&&r.length&&(f=[h,s.default.createElement(i.PopoverItemGroup,{key:"show-item-group"},s.default.createElement(i.PopoverItemGroupTitle,{className:"brws-column-header-menu-title",key:"show-title"},this._columnMenuTitle()),S.filter(function(e){return!e.isLocked}).map(function(e){return s.default.createElement(i.PopoverSelectableItem,{key:e.sortField,disabled:d.map(function(e){return e.sortField}).includes(e.sortField)&&e.sortField!==t.sortField,selected:e.sortField===t.sortField,value:e},e.label)}))]),s.default.createElement(i.Popover,{className:"brws-column-header-menu",onSelection:this.handlePopoverSelection},s.default.createElement(i.PopoverTrigger,{className:o.default("brws-column-header-menu-trigger",{"brws-column-header-menu-trigger-active":!!u&&!_}),title:t.popoverTriggerLabel,"aria-label":c._("Sort by %(sort_by)s").format({sort_by:t.label})},s.default.createElement("span",null,t.label),s.default.createElement("span",{className:"brws-column-header-menu-label-icon-wrapper"},s.default.createElement(n.IconForm,{className:"brws-column-header-menu-label-icon",name:m}))),s.default.createElement(i.PopoverContent,null,!_&&s.default.createElement(i.PopoverItemGroup,null,s.default.createElement(i.PopoverItemGroupTitle,{className:"brws-column-header-menu-title"},c._("Order")),s.default.createElement(i.PopoverSelectableItem,{selected:u===l.SortDirection.ASCENDING,value:l.SortDirection.ASCENDING,disabled:t.isSortOrderOptionDisabled},c._("Ascending")),s.default.createElement(i.PopoverSelectableItem,{selected:u===l.SortDirection.DESCENDING,value:l.SortDirection.DESCENDING,disabled:t.isSortOrderOptionDisabled},c._("Descending"))),f))},t})(s.default.PureComponent);t.ColumnHeaderMenu=d}),define("modules/clean/react/files_view/column_helpers",["require","exports","modules/clean/immutability_helper"],function(e,t,r){"use strict";function o(e,t,o){var n=e.map(function(e){return e.sortField}).indexOf(t),i=e.map(function(e){return e.sortField}).indexOf(o);if(n===i||n===-1||i===-1)return e;var s=e[n],a=e[i];return r.splice(r.splice(e,n,1,a),i,1,s)}Object.defineProperty(t,"__esModule",{value:!0}),t.swapColumns=o}),define("modules/clean/react/files_view/column_manager",["require","exports","tslib","external/lodash","react","spectrum/dimensions","modules/clean/immutability_helper","modules/clean/react/files_view/column_helpers","modules/clean/react/files_view/types"],function(e,t,r,o,n,i,s,a,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),n=r.__importDefault(n),t.ColumnManager=function(e){var t=e.responsiveContainer,o=r.__rest(e,["responsiveContainer"]);return(o.isMatchedLarge||o.isMatchedMedium)&&t?n.default.createElement(i.Dimensions,null,function(e){var t=e.width,i=r.__assign({},o);return t&&(i.isMatchedLarge=t>824,i.isMatchedMedium=!i.isMatchedLarge&&t>588),n.default.createElement(c,r.__assign({},i,{containerWidth:t}))}):n.default.createElement(c,r.__assign({},o))};var c=(function(e){function t(t){var r=e.call(this,t)||this;return r.handleSelection=function(e,t){var o=r.props,n=o.viewType,i=o.onColumnsChanged,c=o.viewTypeColumns,d=r.state.visibleColumns,u=c?c[l.ViewType.List]:void 0,p=c?c[l.ViewType.Grid]:void 0;if(u&&p){var f=d.indexOf(t);if(f===-1||d.includes(e))r.changeVisibleColumns(d);else{var _=s.splice(d,f,1,e);r.changeVisibleColumns(_);var m=r.isSizeColumnPresent(_);n===l.ViewType.List?i(a.swapColumns(u,t.sortField,e.sortField),l.ViewType.List,m):(i(a.swapColumns(p,t.sortField,e.sortField),n,m),e.sortField!==l.SortField.FILENAME&&i(a.swapColumns(u,u[1].sortField,e.sortField),l.ViewType.List,m))}}},r}return r.__extends(t,e),t.prototype.componentWillMount=function(){this.changeVisibleColumns(this.computeVisibleColumns(this.props),!0)},t.prototype.componentWillReceiveProps=function(e){var t=this.props.viewTypeColumns,r=this.state.visibleColumns,n=this.getNumVisibleColumns(this.props),i=this.getNumVisibleColumns(e);if(o.isEqual(this.props.columns,e.columns)&&this.props.viewType===e.viewType){if(i<n)this.changeVisibleColumns(r.slice(0,i),!0);else if(i>n){var s=this.props.columns,c=i-r.length,d=o.filter(s,function(e){return!o.find(r,function(t){return t.sortField===e.sortField})}).slice(0,c);this.changeVisibleColumns(r.concat(d),!0)}}else if(1===i&&e.columns.length&&e.currentSort){var s=e.columns,u=e.viewType,p=t?t[l.ViewType.Grid]:void 0;switch(u){case l.ViewType.List:this.changeVisibleColumns([s[0]],!0);break;case l.ViewType.Grid:case l.ViewType.LargeGrid:if(p){var f=e.currentSort,_=s.find(function(e){return e.sortField===f.sortField}),m=_||s[0];this.deferredOnColumnsChangedHandler([m],a.swapColumns(p,p[0].sortField,m.sortField),u)}}}else this.changeVisibleColumns(e.columns.slice(0,i),!0)},t.prototype.changeVisibleColumns=function(e,t){var r=this;void 0===t&&(t=!1),this.resetChangeVisibleColumnsTimeout();var o=this.isSizeColumnPresent(e);this.setState({visibleColumns:e,canDisplayFolderSizes:o}),t?this.changeVisibleColumnsTimeout=setTimeout(function(){r.resetChangeVisibleColumnsTimeout(),r.props.onCanDisplayFolderSizesChanged(o)}):this.props.onCanDisplayFolderSizesChanged(o)},t.prototype.resetChangeVisibleColumnsTimeout=function(){this.changeVisibleColumnsTimeout&&(clearTimeout(this.changeVisibleColumnsTimeout),this.changeVisibleColumnsTimeout=void 0)},t.prototype.deferredOnColumnsChangedHandler=function(e,t,r){var o=this;this.resetDeferredOnColumnsChangedHandler();var n=this.isSizeColumnPresent(e);this.setState({visibleColumns:e,canDisplayFolderSizes:n}),this.onColumnsChangesTimeout=setTimeout(function(){o.resetDeferredOnColumnsChangedHandler(),o.props.onColumnsChanged(t,r,n)})},t.prototype.resetDeferredOnColumnsChangedHandler=function(){this.onColumnsChangesTimeout&&(clearTimeout(this.onColumnsChangesTimeout),this.onColumnsChangesTimeout=void 0)},t.prototype.computeVisibleColumns=function(e){return e.columns.slice(0,this.getNumVisibleColumns(e))},t.prototype.getNumVisibleColumns=function(e){var t=e.isMatchedLarge,r=e.isMatchedMedium;switch(e.viewType){case l.ViewType.Grid:case l.ViewType.LargeGrid:return 1;case l.ViewType.List:default:return t?3:r?2:1}},t.prototype.isSizeColumnPresent=function(e){return e.some(function(e){return e.sortField===l.SortField.SIZE})},t.prototype.render=function(){var e=this.props,t=e.children,r=e.containerWidth,o=this.state,n=o.visibleColumns,i=o.canDisplayFolderSizes;if(!t)return null;var s=t;return"function"==typeof t&&(s=t({visibleColumns:n,canDisplayFolderSizes:i,handleSelection:this.handleSelection,containerWidth:r})),s},t})(n.default.PureComponent);t.ColumnManagerComponent=c}),define("modules/clean/react/files_view/controller",["require","exports","tslib","external/classnames","external/immutable","external/lodash","external/react-dom","external/react-redux","react","spectrum/media_table_skeleton","spectrum/table","modules/clean/photos/thumb_loading/buffered_thumb_store","modules/clean/photos/thumb_loading/generic_thumb_store","modules/clean/react/browse/models","modules/clean/react/files_view/column_header","modules/clean/react/files_view/column_manager","modules/clean/react/files_view/constants","modules/clean/react/files_view/data/store","modules/clean/react/files_view/drag_and_drop","modules/clean/react/files_view/file_grouper","modules/clean/react/files_view/file_list_empty_folder_table","modules/clean/react/files_view/internal_drag_status","modules/clean/react/files_view/list","modules/clean/react/files_view/pinned_team_folder_view","modules/clean/react/files_view/scroll_updater","modules/clean/react/files_view/selectors","modules/clean/react/files_view/tile_grid","modules/clean/react/files_view/types","modules/clean/react/icon/file_folder_icon","modules/clean/react/selectable_list","modules/clean/sharing/access_level","modules/clean/user_education/user_education_client","modules/clean/web_timing_logger","modules/core/browser_detection","modules/core/i18n","modules/core/notify"],function(e,t,r,o,n,i,s,a,l,c,d,u,p,f,_,m,h,S,g,v,E,w,b,T,F,y,C,I,O,R,P,D,N,A,L,x){"use strict";function M(e,t){return e.filter(U(t)).size>0}function U(e){return function(t){return e?t instanceof f.File||t instanceof f.FileSharedWithMe:t instanceof f.File}}Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),n=r.__importStar(n),i=r.__importStar(i),s=r.__importStar(s),l=r.__importDefault(l),N=r.__importStar(N);var k=function(){},B={sectionLabels:[],sectionStartIndices:[]},V=[P.NameSpaceAccess.ACCESS_NO_ACCESS,P.NameSpaceAccess.ACCESS_READER,P.NameSpaceAccess.ACCESS_READER_NO_COMMENT];t.getShouldShowSelectAllCheckbox=M;var H=(function(t){function a(){var e=null!==t&&t.apply(this,arguments)||this;return e.gridViewPrewarmedThumbnailRequestIds=[],e.state={thumbStore:new u.BufferedThumbStore,keyboardShortcutModalHandler:function(){e.setState({shouldShowKeyboardShortcutModal:!0})},dropTarget:null,sections:{sectionLabels:[],sectionStartIndices:[]},tilesPerRow:1},e.handleCopyToClipboard=function(){var t=e.props,r=t.selectedFiles,o=t.onCopyToClipboard;r.size&&o(r.toArray())},e.handleNewFolderSubmit=function(t){""===t?(e.props.onNewFolderCancel(),e.handleNewFolderCancel({source:I.NameInputActionSource.SUBMIT})):e.props.onNewFolderSubmit(t)},e.handleNewFolderCancel=function(t){t.source!==I.NameInputActionSource.ESC&&x.Notify.error(L._("Please provide a name for the new folder.")),e.props.onNewFolderCancel()},e.handleSetFileUploaderPath=function(t){var r=t?t.path:e.props.path,o=e.props.context.isCurrentPathWriteable();t&&t.hasOwnProperty("hasPermissionToUploadToFolder")&&(o=!!t.hasPermissionToUploadToFolder),e.props.setFileUploaderPath({path:r,hasPermissionToUploadToFolder:o})},e.handleDragStart=function(t,o){void 0===o&&(o=[]);var n=e.props,a=n.path,l=n.selectedFiles,c=n.user,d=i.keyBy(o,"fq_path");d=r.__assign({},d,l.toJS());var u=i.values(d);if(u.some(function(e){return f.File.isTeamSharedFolder(e)}))return void x.Notify.error(L._("Team folders can’t be moved."));if(u.some(function(e){return f.File.isTeamMemberFolder(e)}))return void x.Notify.error(L._("Your member folder can’t be moved."));var p=t.dataTransfer;p&&(p.setDragImage&&e.internalDragStatusRef&&p.setDragImage(s.findDOMNode(e.internalDragStatusRef),-10,-10),p.setData(A.INTERNAL_FILE_DATA_TRANSFER_TYPE,JSON.stringify({userId:c.id,fromPath:a,filePaths:u.map(function(e){return e.fq_path})})),p.effectAllowed="copyMove")},e.handleDragEnter=function(t,r,o,n){g.onFileDragEnterItem(r,!!e.props.isDraggingExternalFiles,!!e.props.isDraggingInternalFiles,o,n,e.props.context,e.handleSetDropTarget,e.handleSetFileUploaderPath)},e.handleSetDropTarget=function(t){e.setState({dropTarget:t})},e.handleSelectionChange=function(t){D.UEClient.sendEvent("FileItemRow","CheckboxToggled"),e.props.onSelectionChange(t)},e.handleDeselectAll=function(){var t=e.props,r=t.selection;(0,t.onSelectionChange)(r.set("selected",n.OrderedSet()))},e.handleSelectAll=function(){var t=e.props,r=t.items,o=t.selection;(0,t.onSelectionChange)(o.set("selected",n.OrderedSet(r.filter(U(e.props.expSelectableFswm)).map(function(e){return"fq_path"in e?e.fq_path:e.file_id}))))},e._handleGetOverflowMenuActions=function(t,r){var o=e.props;return(0,o.getOverflowMenuActions)(t,r,o.responsive)},e.handleTTI=function(){e.props.onComponentTTI("FilesViewController")},e.setInternalDragStatusRef=function(t){e.internalDragStatusRef=t},e.getIsCurrentPathWriteable=function(){return e.props.context.isCurrentPathWriteable()},e.onTilesPerRowChange=function(t){e.setState({tilesPerRow:t})},e.onDeselectAll=function(){e.props.isSearchMode&&e.props.onFocusSearchBar()},e}return r.__extends(a,t),a.prototype.componentWillMount=function(){this.setTileItemsSections(this.props)},a.prototype.componentDidMount=function(){var t=this;this.setupUnity(),D.UEClient.registerForAllEducationSteps(function(e){var r=["FileItemRow","PinnedTeamFolder","PathBreadcrumbs"];e.step&&e.step.effect&&r.includes(e.step.effect.containerName)&&t.props.onSwitchViewType(I.ViewType.List)}),N.waitForTTI().then(function(){t.prewarmGridViewThumbStore();var o=function(e){var r=e.showKeyboardShortcutsModal;t.state.shouldShowKeyboardShortcutModal&&r(t.props.viewType===I.ViewType.List),t.setState({keyboardShortcutModalHandler:function(){r(t.props.viewType===I.ViewType.List)},shouldShowKeyboardShortcutModal:!1})};o.perfName="keyboard_shortcuts_modal",new Promise(function(t,r){e(["modules/clean/react/files_view/keyboard_shortcuts_modal"],t,r)}).then(r.__importStar).then(o)})},a.prototype.componentWillReceiveProps=function(e){if(e.context&&this.props.context&&e.context.currentFQPath!==this.props.context.currentFQPath){this.undoPrewarmGridViewThumbStore();var t=this.props.arePostTTIModulesLoaded?new p.GenericThumbStore:new u.BufferedThumbStore;this.setState({thumbStore:t})}(e.viewType!==this.props.viewType||!e.currentSort!=!this.props.currentSort||e.currentSort&&this.props.currentSort&&(e.currentSort.sortField!==this.props.currentSort.sortField||e.currentSort.sortDirection!==this.props.currentSort.sortDirection)||e.items!==this.props.items)&&this.setTileItemsSections(e)},a.prototype.componentDidUpdate=function(e){e.context&&this.props.context&&e.context.currentFQPath!==this.props.context.currentFQPath&&this.prewarmGridViewThumbStore(),this.props.enableUnity&&e.items!==this.props.items&&this.triggerUnityChangeCallback&&this.triggerUnityChangeCallback()},a.prototype.componentWillUnmount=function(){this.triggerUnityChangeCallback=void 0},a.prototype.setupUnity=function(){return r.__awaiter(this,void 0,void 0,function(){var t,o=this;return r.__generator(this,function(n){switch(n.label){case 0:return[4,N.waitForTTI()];case 1:return n.sent(),[4,new Promise(function(t,r){e(["modules/clean/unity_browse_interface"],t,r)}).then(r.__importStar)];case 2:return t=n.sent().default,this.triggerUnityChangeCallback=function(){t.browse_visible_change_callback(o.props.items.toArray(),o.props.user.id,0,o.props.items.size-1)},[2]}})})},a.prototype.setTileItemsSections=function(e){this.setState({sections:e.viewType!==I.ViewType.List&&e.currentSort?v.getSections(e.items,e.currentSort.sortField,e.currentSort.sortDirection,e.isSearchMode):B})},a.prototype.prewarmGridViewThumbStore=function(){var e=this;if(this.props.viewType!==I.ViewType.Grid){var t=this.state.thumbStore;this.props.items.slice(0,100).forEach(function(r){if(r instanceof f.File||r instanceof f.FileSharedWithMe){var o=O.getThumbnailUrlForItem(r.thumbnail_url_tmpl,h.ViewTypeThumbnailSizes[I.ViewType.Grid]);if(o){var n=t.bind_url(o,{onSuccess:k});n&&e.gridViewPrewarmedThumbnailRequestIds.push(n)}}})}},a.prototype.undoPrewarmGridViewThumbStore=function(){var e=this;this.gridViewPrewarmedThumbnailRequestIds.length&&(this.gridViewPrewarmedThumbnailRequestIds.forEach(function(t){e.state.thumbStore.unbind_url(t)}),this.gridViewPrewarmedThumbnailRequestIds=[])},a.prototype.renderEmptyFolderView=function(){var e=this.props,t=e.context,r=e.responsive,o=e.onFocusSearchBar,n=e.onPasteFromClipboard,i=e.onNavigateToParentFolder;if(this.props.customEmptyFolderView)return this.props.customEmptyFolderView(r);var s=t.isInsideSharedFolder,a=t.currentSharedFolderPermissionRole,c=s&&V.includes(a),d=c?void 0:L._("Drag and drop files onto this window to upload.");return l.default.createElement(E.EmptyFolderTable,{title:L._("This folder is empty"),subtitle:d,onTTI:this.handleTTI,onFocusSearchBar:o,onPasteFromClipboard:n,onNavigateToParentFolder:i,onOpenKeyboardShortcutModal:this.state.keyboardShortcutModalHandler})},a.prototype.renderPinnedTeamFolderView=function(e){var t=this.props,r=t.context,o=t.dropTargetHighlightMode,n=t.onShowShare,i=t.renderSharedWithController,s=t.teamFolders,a=t.user,c=t.onRenameSubmit,d=t.onRenameCancel,u=t.selectionMethod,p=this.state,f=p.dropTarget,_=p.thumbStore;return l.default.createElement(T.PinnedTeamFolderView,{activeDropTarget:f,columnFlex:h.LIST_VIEW_COLUMN_FLEX[1],context:r,dropTargetHighlightMode:o,getOverflowMenuActions:this._handleGetOverflowMenuActions,isCompactMode:e,onDragEnter:this.handleDragEnter,onNavigateToFileOrFolder:this.props.onNavigateToFileOrFolder,onRenameCancel:d,onRenameSubmit:c,teamFolders:s,user:a,arePostTTIModulesLoaded:this.props.arePostTTIModulesLoaded,thumbStore:_,onShowShare:n,renderSharedWithController:i,selectionMethod:u})},a.prototype.getSelectAllCheckboxCheckedVariant=function(){var e=this.props,t=e.selectedFiles,r=e.items,o="unchecked";return t.size===r.filter(U(this.props.expSelectableFswm)).size?o="checked":t.size&&(o="mixed"),o},a.prototype.isCreateFolderUIActive=function(){var e=this.props.createNewFolderState;return e&&"CREATE_FOLDER_INACTIVE"!==e},a.prototype.shouldShowEmptyFolderView=function(){return this.props.loadingState===I.LoadingState.LOADED&&!this.props.items.size&&!this.isCreateFolderUIActive()},a.prototype.shouldComponentUpdate=function(e){return e.loadingState!==this.props.loadingState||e.loadingState!==I.LoadingState.LOADING_FIRST_PAGE},a.prototype.render=function(){var e=this,t=this.props,n=t.onDelete,i=t.onShowRename,s=t.onRenameSubmit,a=t.onRenameCancel,u=t.onSwitchViewType,p=t.onPasteFromClipboard,f=t.onColumnsChanged,S=t.onCanDisplayFolderSizesChanged,g=t.onFocusSearchBar,v=t.currentSort,E=t.createNewFolderState,T=t.context,O=t.columns,P=t.dropTargetHighlightMode,D=t.fileRename,N=t.getIsFileJumping,A=t.onAddFileJumpKeyCode,L=t.onResetFileJump,x=t.items,U=t.isSearchMode,k=t.isDraggingExternalFiles,B=t.isDraggingInternalFiles,V=t.isQueryingFolderSizes,H=t.isFileViewerShown,W=t.loadingState,q=t.onSortChange,G=t.path,z=t.responsive,j=t.selectedFiles,Y=t.selection,Q=t.shouldShowPinnedTeamFolders,K=t.renderSharedWithController,J=t.onShowShare,X=t.onPresentInZoom,Z=t.teamFolders,$=t.totalNumFiles,ee=t.user,te=t.viewType,re=t.viewTypes,oe=t.viewTypeLabels,ne=t.viewTypeColumns,ie=t.onLocationLinkClick,se=t.onNavigateToFileOrFolder,ae=t.onNavigateToParentFolder,le=t.onOpenFileSharedWithMe,ce=t.onOpenPaper,de=t.arePostTTIModulesLoaded,ue=t.onStarClick,pe=t.extensionsFeatureFlags,fe=t.sharingServiceInfo,_e=t.stickyOffsetTop,me=t.disabledMultiselect,he=t.isStickyColumnHeader,Se=t.onRangeInView,ge=t.hasResponsiveOverflowMenu,ve=t.selectionMethod,Ee=t.highDensity,we=t.scrollContainer,be=t.filteredContactName,Te=z.isMatchedLarge,Fe=z.isMatchedMedium,ye=this.state,Ce=ye.dropTarget,Ie=ye.thumbStore,Oe=ye.keyboardShortcutModalHandler,Re=ye.sections,Pe=ye.tilesPerRow;if(W===I.LoadingState.LOADING_FIRST_PAGE)return de?l.default.createElement(c.MediaTableSkeleton,{numRows:15}):null;var De=y.getItemIds(this.props),Ne=!Te,Ae=!!j.size;if(this.shouldShowEmptyFolderView())return l.default.createElement("div",{className:"brws-files-view"},Q&&this.renderPinnedTeamFolderView(Ne),this.renderEmptyFolderView());var Le=Te?h.DEFAULT_COLUMN_HEADER_HEIGHT:h.COMPACT_COLUMN_HEADER_HEIGHT,xe=Le+_e,Me=this.props.scrollPositionOffset||0;return Q&&(Me+=Le+Le+h.PINNED_TEAM_FOLDER_SECONDARY_HEADER_PADDING_TOP+Z.size*h.DEFAULT_ROW_HEIGHT),l.default.createElement("div",{className:o.default(["brws-files-view","brws-files-view--"+te.toLowerCase()])},Q&&this.renderPinnedTeamFolderView(Ne),l.default.createElement(m.ColumnManager,{columns:O,viewTypeColumns:ne,currentSort:v,onCanDisplayFolderSizesChanged:S,onColumnsChanged:f,isMatchedLarge:Te,isMatchedMedium:Fe,isSearchMode:U,viewType:te,responsiveContainer:!!this.props.expSnippets},function(t){var c=t.visibleColumns,f=t.handleSelection,m=t.canDisplayFolderSizes,S=t.containerWidth,w=(U?e.props.expSnippets?h.LIST_VIEW_SEARCH_MODE_WITH_SNIPPETS_COLUMN_FLEX:h.LIST_VIEW_SEARCH_MODE_COLUMN_FLEX:h.LIST_VIEW_COLUMN_FLEX)[c.length],F={columnFlex:w,currentSort:v,isCompactMode:Ne,isSelectMode:Ae,onDeselectAll:e.handleDeselectAll,onSelectAll:e.handleSelectAll,onSelection:f,onSort:q,onSwitchViewType:u,selectAllCheckboxState:e.getSelectAllCheckboxCheckedVariant(),showSelectAllCheckbox:M(e.props.items,e.props.expSelectableFswm),stickyOffsetHeight:Le,stickyOffsetTop:_e,columns:O,visibleColumns:c,viewType:te,viewTypes:re,viewTypeLabels:oe,onTTI:e.handleTTI,isSearchMode:U,presentationOnly:te!==I.ViewType.List};return te===I.ViewType.List?l.default.createElement(R.SelectableList,{itemIds:De,keyScope:R.SELECTABLE_LIST_KEY_SCOPE,onSelectionChange:e.handleSelectionChange,selection:Y,tilesPerRow:Pe,onDeselectAll:e.onDeselectAll},function(t){var u=t.focusedFileId,f=t.handleDeselect,h=t.handleFocusFile,v=t.handleSelect,y=t.isSelectableListEvent;return l.default.createElement(d.Table,{"aria-rowcount":$,className:o.default("brws-files-view-list",{"brws-files-view-list-compact":Ne,"brws-files-view-list-high-density":Ee}),columnFlex:w},l.default.createElement(_.ColumnHeader,r.__assign({},F,{variant:we?"sticky-native":he?"sticky":"fixed"})),l.default.createElement(b.FilesViewList,{onDelete:n,onShowRename:i,activeDropTarget:Ce,context:T,createNewFolderState:E,disabledMultiselect:me||!1,dropTargetHighlightMode:P,items:x,extensionsFeatureFlags:pe,fileRename:D,focusedFileIndex:u?De.indexOf(u):void 0,getOverflowMenuActions:e._handleGetOverflowMenuActions,getIsCurrentPathWriteable:e.getIsCurrentPathWriteable,getIsFileJumping:N,onAddFileJumpKeyCode:A,onResetFileJump:L,isCompactMode:Ne,isDraggingExternalFiles:k,isDraggingInternalFiles:B,isFileViewerShown:H,isSearchMode:U,isSelectMode:Ae,isSelectableListEvent:y,arePostTTIModulesLoaded:de,keyScope:R.SELECTABLE_LIST_KEY_SCOPE,onCopyToClipboard:e.handleCopyToClipboard,onDragStart:e.handleDragStart,onDragEnter:e.handleDragEnter,onDeselectFile:f,onFocusFile:h,onFocusSearchBar:g,onOpenKeyboardShortcutModal:Oe,onLocationLinkClick:ie,onNavigateToFileOrFolder:se,onNavigateToParentFolder:ae,onNewFolderCancel:e.handleNewFolderCancel,onNewFolderSubmit:e.handleNewFolderSubmit,onOpenFileSharedWithMe:le,onOpenPaper:ce,onPasteFromClipboard:p,onRenameCancel:a,onRenameSubmit:s,onSelectFile:v,onSetDropTarget:e.handleSetDropTarget,onSetFileUploaderPath:e.handleSetFileUploaderPath,onStarClick:ue,responsive:z,scrollPositionOffset:Me,selectedFiles:j,selection:Y,renderSharedWithController:K,hrefForFile:e.props.hrefForFile,onShowShare:J,onPresentInZoom:X,user:ee,viewportTopOffset:xe,visibleColumns:c,canDisplayFolderSizes:m,thumbStore:Ie,shareButtonLabel:e.props.shareButtonLabel,sharingServiceInfo:fe,showShareButton:e.props.showShareButton,starredState:e.props.starredState,useSearchSuccessBanner:e.props.useSearchSuccessBanner,expHighlightedTruncatedString:e.props.expHighlightedTruncatedString,onRangeInView:Se,hasResponsiveOverflowMenu:ge,expSnippets:e.props.expSnippets,containerWidth:S,expSelectableFswm:e.props.expSelectableFswm,selectionMethod:ve,highDensity:Ee,scrollContainer:we,filteredContactName:be,expBrowseStickyOverflowMenu:e.props.expBrowseStickyOverflowMenu}))}):l.default.createElement(R.SelectableList,{itemIds:De,keyScope:R.SELECTABLE_TILE_GRID_KEY_SCOPE,onSelectionChange:e.handleSelectionChange,selection:Y,tilesPerRow:Pe,sectionStartIndices:Re.sectionStartIndices},function(t){var o=t.handleDeselect,c=t.handleDeselectAll,u=t.handleFocusFile,f=t.handleSelect,m=t.handleSelectAll,S=t.focusedFileId;return l.default.createElement("div",null,l.default.createElement(d.Table,{columnFlex:h.GRID_VIEW_COLUMN_FLEX,role:"presentation",style:we?{position:"sticky",top:_e,zIndex:1}:void 0},l.default.createElement(_.ColumnHeader,r.__assign({},F,{variant:we?"default":he?"sticky":"fixed"}))),l.default.createElement(C.FilesViewTileGrid,{onDelete:n,disabledMultiselect:me||!1,expSelectableFswm:e.props.expSelectableFswm,onShowRename:i,activeDropTarget:Ce,arePostTTIModulesLoaded:de,createNewFolderState:E,context:T,deselectAll:c,dropTargetHighlightMode:P,fileRename:D,getOverflowMenuActions:e._handleGetOverflowMenuActions,getIsCurrentPathWriteable:e.getIsCurrentPathWriteable,getIsFileJumping:N,onAddFileJumpKeyCode:A,onResetFileJump:L,onTTI:e.handleTTI,items:x,isCreateFolderUIActive:e.isCreateFolderUIActive(),isDraggingExternalFiles:k,isDraggingInternalFiles:B,isQueryingFolderSizes:V,isSearchMode:U,onCopyToClipboard:e.handleCopyToClipboard,onDeselectFile:o,onDragEnter:e.handleDragEnter,onDragStart:e.handleDragStart,onFocusFile:u,onFocusSearchBar:g,onNewFolderCancel:e.handleNewFolderCancel,onNewFolderSubmit:e.handleNewFolderSubmit,onNavigateToFileOrFolder:se,onOpenFileSharedWithMe:le,onOpenPaper:ce,onOpenKeyboardShortcutModal:Oe,onPasteFromClipboard:p,onRangeInView:Se,onRenameCancel:a,onRenameSubmit:s,onSelectFile:f,onSetDropTarget:e.handleSetDropTarget,onSortChange:q,onStarClick:ue,onTilesPerRowChange:e.onTilesPerRowChange,path:G,sections:Re,selectAll:m,selectedFiles:j,selection:Y,onSetFileUploaderPath:e.handleSetFileUploaderPath,thumbStore:Ie,tilesPerRow:Pe,totalNumItems:$,user:ee,viewportTopOffset:xe,viewType:te,starredState:e.props.starredState,hrefForFile:e.props.hrefForFile,focusedFileIndex:S?De.indexOf(S):void 0,selectionMethod:e.props.selectionMethod,scrollContainer:we,expBrowseStickyOverflowMenu:e.props.expBrowseStickyOverflowMenu}))})}),l.default.createElement(F.ScrollUpdater,{scrollContainer:we,path:G}),l.default.createElement(w.InternalDragStatus,{
className:"offscreen-drag-icon",files:j.toArray(),ref:this.setInternalDragStatusRef}))},a.defaultProps={dropTargetHighlightMode:I.DropTargetHighlightMode.NONE,enableUnity:!0,fileRename:null,loadingState:I.LoadingState.LOADING_FIRST_PAGE,selectionMethod:I.SelectionMethod.CHECKBOX},a})(l.default.Component);t.ConnectedFilesViewController=H;var W=S.getStoreForFilesView();t.FilesViewController=function(e){return l.default.createElement(a.Provider,{store:W},l.default.createElement(H,r.__assign({},e)))}}),define("modules/clean/react/files_view/culled_table_body",["require","exports","tslib","spectrum/table","modules/clean/react/files_view/util","react"],function(e,t,r,o,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=r.__importDefault(i),t.CulledTableBodyWithScrollContainer=function(e){var t=e.scrollContainer,o=r.__rest(e,["scrollContainer"]);return t?t.current&&i.default.createElement(s,r.__assign({},o,{shouldUseWindowAsScrollContainer:!0,window:n.createFakeWindow(t.current)})):i.default.createElement(s,r.__assign({},o))};var s=(function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(n,e),n.prototype.componentWillMount=function(){this.updateOffsetCache()},n.prototype.componentDidMount=function(){this.updateScroll()},n.prototype.componentWillReceiveProps=function(e){e.listItemHeight!==this.props.listItemHeight&&this.updateOffsetCache(e),e.scrollToRow!==this.props.scrollToRow&&this.updateScroll(e)},n.prototype.updateOffsetCache=function(e){var r=(void 0===e?this.props:e).listItemHeight;this.offsetCache=Array.isArray(r)?t.computeOffsetCache(r):void 0},n.prototype.updateScroll=function(e){var r=void 0===e?this.props:e,o=r.scrollToRow,n=r.listItemHeight,i=r.viewportTopOffset,s=void 0===i?0:i,a=r.scrollPositionOffset,l=void 0===a?0:a,c=r.window;if(void 0!==o&&o>=0){var d=(Array.isArray(n)?this.offsetCache[o]:(o+1)*n)+l,u=Array.isArray(n)?n[o]:n,p=d-u;t.scrollTo([p,d],s,c)}},n.prototype.render=function(){var e=this.props,t=e.viewportTopOffset,n=(e.scrollToRow,r.__rest(e,["viewportTopOffset","scrollToRow"]));return i.default.createElement(o.CulledTableBody,r.__assign({viewportHeight:window.innerHeight-t},n))},n.defaultProps={viewportTopOffset:0},n})(i.default.PureComponent);t.CulledTableBodyWithScrollToRow=s;var a=function(e){return void 0===e&&(e=window),"scrollingElement"in e.document&&e.document.scrollingElement?e.document.scrollingElement.scrollTop:e.document.documentElement.scrollTop};t.scrollTo=function(e,t,r){var o=e[0],n=e[1];void 0===t&&(t=0),void 0===r&&(r=window);var i=r.innerHeight-t,s=a(r),l=s+i;o<s?r.scrollTo(0,o):n>l&&r.scrollTo(0,n-i)},t.computeOffsetCache=function(e){return e.reduce(function(e,t){return e.push(t+(e[e.length-1]||0)),e},[])}}),define("modules/clean/react/files_view/data/action_creators",["require","exports","tslib","modules/clean/react/files_view/constants","modules/clean/react/files_view/data/selectors","modules/clean/react/files_view/data/types","modules/clean/storage","modules/core/cookies"],function(e,t,r,o,n,i,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importStar(n),t.setViewType=function(e){var t=e.user,r=e.viewType;return function(e,a){e({type:i.ActionTypes.SET_VIEW_TYPE,payload:{viewType:r}}),s.UserLocalStorage.set(t.id,o.VIEW_TYPE_STORAGE_KEY,n.viewTypes(a()))}},t.loadViewTypes=function(e){var t=e.user;return function(e,r){var l,c=s.UserLocalStorage.get(t.id,o.VIEW_TYPE_STORAGE_KEY);if(c)e({type:i.ActionTypes.SET_VIEW_TYPES,payload:{viewTypes:c}});else{var d=a.Cookies.read(o.VIEW_TYPE_COOKIE_NAME);a.Cookies.delete(o.VIEW_TYPE_COOKIE_NAME),d&&(e({type:i.ActionTypes.SET_VIEW_TYPES,payload:{viewTypes:(l={},l[o.VIEW_TYPE_GLOBAL_SCOPE]=d,l)}}),s.UserLocalStorage.set(t.id,o.VIEW_TYPE_STORAGE_KEY,n.viewTypes(r())))}}},t.setViewTypeScope=function(e){var t=e.viewTypeScope;return{type:i.ActionTypes.SET_VIEW_TYPE_SCOPE,payload:{viewTypeScope:t}}},t.setViewTypeColumns=function(e){var t=e.columns,a=e.viewType,l=e.user;return function(e,c){var d;s.UserLocalStorage.set(l.id,o.COLUMNS_STORAGE_KEY+"_"+a,t);var u=r.__assign({},n.viewTypeColumns(c()),(d={},d[a]=t,d));e({type:i.ActionTypes.SET_VIEW_TYPE_COLUMNS,payload:{viewTypeColumns:u}})}},t.loadViewTypeColumns=function(e){var t=e.user;return function(e,a){var l=n.viewTypeColumns(a());o.AllViewTypes.forEach(function(e){var n,i=s.UserLocalStorage.get(t.id,o.COLUMNS_STORAGE_KEY+"_"+e);i&&(l=r.__assign({},l,(n={},n[e]=i,n)))}),e({type:i.ActionTypes.SET_VIEW_TYPE_COLUMNS,payload:{viewTypeColumns:l}})}},t.setFileRename=function(e){var t=e.file,r=e.renameState;return{type:i.ActionTypes.SET_FILE_RENAME,payload:{file:t,renameState:r}}},t.resetScroll=function(){return{type:i.ActionTypes.SET_SCROLL,payload:{scrollTop:0}}}}),define("modules/clean/react/files_view/data/reducer",["require","exports","tslib","modules/clean/react/files_view/constants","modules/clean/react/files_view/data/types","modules/clean/react/files_view/types"],function(e,t,r,o,n,i){"use strict";function s(e,t){var o=t.payload,n=o.file,i=o.renameState;return i?r.__assign({},e,{fileRename:{file:n,state:i}}):r.__assign({},e,{fileRename:null})}function a(e,r){switch(void 0===e&&(e=t.defaultFilesViewState),r.type){case n.ActionTypes.SET_VIEW_TYPE:return u(e,r.payload);case n.ActionTypes.SET_VIEW_TYPES:return p(e,r.payload);case n.ActionTypes.SET_VIEW_TYPE_COLUMNS:return f(e,r.payload);case n.ActionTypes.SET_VIEW_TYPE_SCOPE:return d(e,r.payload);case n.ActionTypes.SET_FILE_RENAME:return s(e,r);case n.ActionTypes.SET_SCROLL:return _(e,r.payload)}return e}var l,c;Object.defineProperty(t,"__esModule",{value:!0}),t.defaultFilesViewState={viewTypes:(l={},l[o.VIEW_TYPE_GLOBAL_SCOPE]=i.ViewType.List,l),viewTypeScope:o.VIEW_TYPE_GLOBAL_SCOPE,viewTypeColumns:(c={},c[i.ViewType.List]=o.LIST_VIEW_COLUMNS,c[i.ViewType.Grid]=o.GRID_VIEW_COLUMNS,c[i.ViewType.LargeGrid]=o.GRID_VIEW_COLUMNS,c),fileRename:null};var d=function(e,t){var o=t.viewTypeScope;return r.__assign({},e,{viewTypeScope:o})},u=function(e,t){var o,n=t.viewType;return r.__assign({},e,{viewTypes:r.__assign({},e.viewTypes,(o={},o[e.viewTypeScope]=n,o))})},p=function(e,t){var o=t.viewTypes;return r.__assign({},e,{viewTypes:r.__assign({},e.viewTypes,o)})},f=function(e,t){var o=t.viewTypeColumns;return r.__assign({},e,{viewTypeColumns:o})},_=function(e,t){return r.__assign({},e,{currentScroll:{scrollTop:t.scrollTop}})};t.filesViewReducer=a}),define("modules/clean/react/files_view/data/selectors",["require","exports","external/reselect","modules/clean/react/files_view/constants","modules/clean/react/files_view/data/reducer","modules/clean/redux/selectors","modules/clean/redux/namespaces"],function(e,t,r,o,n,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){return i.getStateAtNamespace(e,s.FILES_VIEW_NAMESPACE_KEY)||n.defaultFilesViewState};t.viewTypes=function(e){return a(e).viewTypes},t.viewTypeScope=function(e){return a(e).viewTypeScope},t.viewTypeColumns=function(e){return a(e).viewTypeColumns},t.viewType=r.createSelector(t.viewTypes,t.viewTypeScope,function(e,t){return t in e?e[t]:t in o.defaultViewTypes?o.defaultViewTypes[t]:e[o.VIEW_TYPE_GLOBAL_SCOPE]}),t.fileRename=function(e){return a(e).fileRename},t.currentScroll=function(e){return a(e).currentScroll}}),define("modules/clean/react/files_view/data/store",["require","exports","modules/clean/react/files_view/data/reducer","modules/clean/redux/namespaces","modules/clean/redux/store"],function(e,t,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i;t.getStoreForFilesView=function(){var e;return i||(i=n.getStoreAndRegisterReducers((e={},e[o.FILES_VIEW_NAMESPACE_KEY]=r.filesViewReducer,e))),i}}),define("modules/clean/react/files_view/data/types",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e.SET_VIEW_TYPE="FILES_VIEW/SET_VIEW_TYPE",e.SET_VIEW_TYPES="FILES_VIEW/SET_VIEW_TYPES",e.SET_VIEW_TYPE_COLUMNS="FILES_VIEW/SET_VIEW_TYPE_COLUMNS",e.SET_VIEW_TYPE_SCOPE="FILES_VIEW/SET_VIEW_TYPE_SCOPE",e.SET_FILE_RENAME="FILES_VIEW/SET_FILE_RENAME",e.SET_SCROLL="FILES_VIEW/SET_SCROLL"})(t.ActionTypes||(t.ActionTypes={}))}),define("modules/clean/react/files_view/file_actions/api_v2",["require","exports","tslib","modules/clean/api_v2/user_client","modules/clean/filepath"],function(e,t,r,o,n){"use strict";function i(e,t,i,s){return r.__awaiter(this,void 0,Promise,function(){var a,l,c,d,u;return r.__generator(this,function(r){switch(r.label){case 0:a=n.parent_dir(e.fq_path),l=n.normalize(a)+"/"+t,c=new o.UserApiV2Client,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,c.ns("files").rpc("move_v2",{from_path:e.fq_path,to_path:l,allow_shared_folder:!0,autorename:!0,allow_ownership_transfer:!1,fsw_request:s?{".tag":"confirm",confirm:["action_commit_to_tsd_root"]}:void 0},{subjectUserId:i.id})];case 2:return d=r.sent(),[2,{isError:!1,result:d}];case 3:return u=r.sent(),u&&u.error&&u.error[".tag"]?[2,{isError:!0,error:u.error,error_summary:u.summary}]:[2,{isError:!0,error:{".tag":"undefined_error"},error_summary:"undefined_error"}];case 4:return[2]}})})}function s(e,t){return r.__awaiter(this,void 0,Promise,function(){var n,i,s;return r.__generator(this,function(r){switch(r.label){case 0:n=new o.UserApiV2Client,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,n.ns("files").rpc("undo_batch",{entries:e},{subjectUserId:t.id})];case 2:return i=r.sent(),[2,{isError:!1,result:i}];case 3:return s=r.sent(),s&&s.error&&s.error[".tag"]?[2,{isError:!0,error:s.error,error_summary:s.summary}]:[2,{isError:!0,error:{".tag":"undefined_error"},error_summary:"undefined_error"}];case 4:return[2]}})})}function a(e,t,i,s,a){return r.__awaiter(this,void 0,Promise,function(){var l,d,u;return r.__generator(this,function(r){switch(r.label){case 0:return l=new o.UserApiV2Client,d=function(){return l.ns("files").rpc("move_batch_v2",{entries:e.map(function(e){return{from_path:e.fq_path,to_path:t+"/"+n.filename(e.fq_path)}}),autorename:!0,allow_ownership_transfer:!!s,fsw_request:a?{".tag":"check"}:void 0},{subjectUserId:i})},u=function(e){return l.ns("files").rpc("move_batch/check_v2",{async_job_id:e},{subjectUserId:i})},[4,c(d,u)];case 1:return[2,r.sent()]}})})}function l(e,t,i,s){return r.__awaiter(this,void 0,Promise,function(){var a,l,d;return r.__generator(this,function(r){switch(r.label){case 0:return a=new o.UserApiV2Client,l=function(){return a.ns("files").rpc("copy_batch_v2",{entries:e.map(function(e){return{from_path:e.fq_path,to_path:t+"/"+n.filename(e.fq_path)}}),autorename:!0,fsw_request:s?{".tag":"check"}:void 0},{subjectUserId:i})},d=function(e){return a.ns("files").rpc("copy_batch/check_v2",{async_job_id:e},{subjectUserId:i})},[4,c(l,d)];case 1:return[2,r.sent()]}})})}function c(e,t){return r.__awaiter(this,void 0,Promise,function(){var o,n,i;return r.__generator(this,function(r){switch(r.label){case 0:return r.trys.push([0,9,,10]),[4,e()];case 1:return o=r.sent(),"complete"!==o[".tag"]?[3,2]:[2,{isError:!1,result:o}];case 2:n=void 0,r.label=3;case 3:return[4,new Promise(function(e){return setTimeout(e,1e3)})];case 4:return r.sent(),[4,t(o.async_job_id)];case 5:n=r.sent(),r.label=6;case 6:if(n&&"in_progress"===n[".tag"])return[3,3];r.label=7;case 7:return"complete"===n[".tag"]?[2,{isError:!1,result:n,jobId:o.async_job_id}]:[2,{isError:!0,error:{".tag":"undefined_error"},error_summary:"undefined_error",jobId:o.async_job_id}];case 8:return[3,10];case 9:return i=r.sent(),i&&i.error&&i.error[".tag"]?[2,{isError:!0,error:i.error,error_summary:i.summary}]:[2,{isError:!0,error:{".tag":"undefined_error"},error_summary:"undefined_error"}];case 10:return[2]}})})}function d(e,t,n){return r.__awaiter(this,void 0,Promise,function(){var i,s,a;return r.__generator(this,function(r){switch(r.label){case 0:return i=new o.UserApiV2Client,s=function(){return i.ns("files").rpc("delete_batch",{entries:e.map(function(e){return{path:e.fq_path}}),fsw_request:n?{".tag":"check"}:void 0},{subjectUserId:t})},a=function(e){return i.ns("files").rpc("delete_batch/check",{async_job_id:e},{subjectUserId:t})},[4,u(s,a)];case 1:return[2,r.sent()]}})})}function u(e,t){return r.__awaiter(this,void 0,Promise,function(){var o,n,i;return r.__generator(this,function(r){switch(r.label){case 0:return r.trys.push([0,10,,11]),[4,e()];case 1:return o=r.sent(),"complete"!==o[".tag"]?[3,2]:[2,{isError:!1,result:o}];case 2:return"other"!==o[".tag"]?[3,3]:[2,{isError:!0,error:{".tag":"undefined_error"},error_summary:"undefined_error"}];case 3:n=void 0,r.label=4;case 4:return[4,new Promise(function(e){return setTimeout(e,1e3)})];case 5:return r.sent(),[4,t(o.async_job_id)];case 6:n=r.sent(),r.label=7;case 7:if(n&&"in_progress"===n[".tag"])return[3,4];r.label=8;case 8:return"complete"===n[".tag"]?[2,{isError:!1,result:n,jobId:o.async_job_id}]:[2,{isError:!0,error:{".tag":"undefined_error"},error_summary:"undefined_error",jobId:o.async_job_id}];case 9:return[3,11];case 10:return i=r.sent(),i&&i.error&&i.error[".tag"]?[2,{isError:!0,error:i.error,error_summary:i.summary}]:[2,{isError:!0,error:{".tag":"undefined_error"},error_summary:"undefined_error"}];case 11:return[2]}})})}function p(e,t,i,s){return r.__awaiter(this,void 0,Promise,function(){var a,l,c;return r.__generator(this,function(r){switch(r.label){case 0:a=new o.UserApiV2Client,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,a.ns("files").rpc("create_folder_v2",{path:n.normalize(e)+"/"+t,autorename:!0,fsw_request:s?{".tag":"check"}:void 0},{subjectUserId:i.id})];case 2:return l=r.sent(),[2,{isError:!1,result:l}];case 3:return c=r.sent(),c&&c.error&&c.error[".tag"]?[2,{isError:!0,error:c.error,error_summary:c.summary}]:[2,{isError:!0,error:{".tag":"undefined_error"},error_summary:"undefined_error"}];case 4:return[2]}})})}Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importStar(n);t.renameFile=i,t.undo=s,t.moveFiles=a,t.copyFiles=l,t.deleteFiles=d,t.createFolder=p}),define("modules/clean/react/files_view/file_actions/file_from_metadata",["require","exports","tslib","modules/clean/react/browse/models"],function(e,t,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fileFromMetadata=function(e,t){if("file"===t[".tag"]){var n=t,i=r.__assign({},e,{fq_path:n.path_display||e.fq_path,icon:n.icon+"_32",revision_id:n.rev,file_id:n.id});return new o.File(i)}return"folder"===t[".tag"]?new o.File(r.__assign({},e,{fq_path:t.path_display||e.fq_path})):e},t.folderFromFolderMetadata=function(e){return new o.File({file_id:e.id,fq_path:e.path_display||"",icon:e.icon,is_dir:!0})}}),define("modules/clean/react/files_view/file_actions/snackbars",["require","exports","modules/core/i18n"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.renameError=function(e,t){return"to"===e[".tag"]&&"malformed_path"===e.to[".tag"]?r._("Name was invalid."):"from_write"===e[".tag"]&&"team_folder"===e.from_write[".tag"]?r._("Team folders can’t be renamed."):"from_lookup"===e[".tag"]&&"not_found"===e.from_lookup[".tag"]?r._("Couldn’t find the file."):r._("Rename failed.")},t.deleteError=function(e,t){return r.ungettext("Couldn’t delete %(failed_to_delete_files)s item.","Couldn’t delete %(failed_to_delete_files)s items.",e).format({failed_to_delete_files:e})},t.deleteCompleteSuccess=function(e,t){return t<e?r.ungettext("Deleted %(succesfully_deleted_files)s out of %(total_num_files)s item.","Deleted %(succesfully_deleted_files)s out of %(total_num_files)s items.",e).format({succesfully_deleted_files:t,total_num_files:e}):r.ungettext("Deleted %(succesfully_deleted_files)s item.","Deleted %(succesfully_deleted_files)s items.",t).format({succesfully_deleted_files:t})},t.deleteCompleteError=function(e){if(1===e.length){var t=e[0].failure;if("too_many_files"===t[".tag"]||"too_many_write_operations"===t[".tag"])return r._("There are too many files in one request. Please retry with fewer files.");if("path_lookup"===t[".tag"]&&"not_found"===t.path_lookup[".tag"])return r._("File does not exist.",{comment:"Error message when trying to delete a file that does not exist."})}return r.ungettext("Couldn’t delete %(failed_to_delete_files)s item.","Couldn’t delete %(failed_to_delete_files)s items.",e.length).format({failed_to_delete_files:e.length})}}),define("modules/clean/react/files_view/file_grouper",["require","exports","modules/core/i18n","modules/clean/datetime","modules/clean/react/browse/constants","modules/clean/react/files_view/types","modules/clean/react/browse/models"],function(e,t,r,o,n,i,s){"use strict";function a(e){return e instanceof s.File?s.File.getCategoryDescription(e,!0):n.ExtensionCategories.DOCUMENT}function l(e){return e instanceof s.File?e.is_dir?n.FileTypeCapitalizedCategoryTranslations.FOLDER:s.File.getExtension(e).toUpperCase():d}function c(e,t,n,c){void 0===c&&(c=!1);var f=[],_=[],m=null;if(t===i.SortField.CATEGORY)e.forEach(function(e,t){if(e){var r=a(e);r!==m&&(f.push(r),_.push(t),m=r)}});else if(t===i.SortField.EXTENSION)e.forEach(function(e,t){if(e){var r=l(e);if(r!==m){var o=r;""===r&&(o=d),f.push(o),_.push(t),m=r}}});else if(t===i.SortField.MODIFIED)if(n===i.SortDirection.DESCENDING){var h=o.getTimeBands(Date.now());e.forEach(function(e,t){if(e){var o;if(c&&e instanceof s.File&&e.isDeleted)o=p;else{var n=s.itemTimestampInMs(e);o=n>=h.today?r._("Today"):n>=h.yesterday?r._("Yesterday"):n>=h.thisWeek?r._("This week"):n>=h.lastWeek?r._("Last week"):n>=h.thisMonth?r._("This month"):n>=h.lastMonth?r._("Last month"):n>=h.lastThreeMonths?r._("Three months ago"):r._("Older")}o!==m&&(f.push(o),_.push(t),m=o)}})}else e.forEach(function(e,t){if(e){var r;if(c&&e instanceof s.File&&e.isDeleted)r=p;else if(s.itemTimestampInMs(e)){var n=new Date(s.itemTimestampInMs(e)),i=n.getMonth(),a=n.getFullYear();r=o.month_with_year(i,a)}else r=u;r!==m&&(f.push(r),_.push(t),m=r)}});return{sectionLabels:f,sectionStartIndices:_}}Object.defineProperty(t,"__esModule",{value:!0});var d=r._("Extensionless",{comment:"Label for files without extensions like .txt or .png"}),u=r._("Missing dates",{comment:"label for group of files without dates marking when they are created or modified"}),p=r._("Deleted content isn’t sorted by last modified");t.getSections=c}),define("modules/clean/react/files_view/file_media_actions",["require","exports","tslib","react","spectrum/button","spectrum/icon_table","spectrum/media_table","modules/clean/react/app_actions/app_actions_menu","modules/clean/react/files_view/util","modules/clean/react/extensions/split_share_button","modules/clean/react/extensions/utils","modules/clean/react/files_view/overflow_menu","modules/clean/react/files_view/share_button","modules/core/i18n"],function(e,t,r,o,n,i,s,a,l,c,d,u,p,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),t.ViewFileButton=function(e){var t=e.isVisible,r=e.onClick;return o.default.createElement(n.Button,{className:"brws-file-row-view-file-button","aria-label":f._("View File"),onClick:r,tabIndex:t?void 0:-1,variant:t?"secondary":"invisible"},o.default.createElement(i.IconTable,{name:"view"}))};var _=(function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={isActionDropdownOpen:!1},t.onActionDropdownOpen=function(){t.setState({isActionDropdownOpen:!0})},t.onActionDropdownClose=function(){t.setState({isActionDropdownOpen:!1})},t}return r.__extends(n,e),n.prototype.render=function(){var e=this.props,n=e.arePostTTIModulesLoaded,i=e.canDisplayFolderSizes,f=e.file,_=e.getOverflowMenuActions,m=e.hasResponsiveOverflowMenu,h=e.isCompactMode,S=e.isHovered,g=e.isSearchMode,v=e.isSelectMode,E=e.isSelected,w=e.isSharingDisabled,b=e.onPresentInZoom,T=e.shareButtonLabel,F=e.showShareButton,y=e.thumbStore,C=e.useSearchSuccessBanner,I=e.user,O=e.viewportTopOffset,R=e.expBrowseStickyOverflowMenu,P=this.props.onShowShare||function(){},D=this.props.onOpenFileClick||function(){},N=this.props.extensionsFeatureFlags||{},A=this.props.sharingServiceInfo||{},L=g?"search":"browse";if(l.isFswm(f))return o.default.createElement(o.default.Fragment,null,v&&!R?o.default.createElement(s.MediaActions,null,o.default.createElement(t.ViewFileButton,{isVisible:E||h||S,onClick:D})):o.default.createElement(s.MediaActions,null,o.default.createElement(u.FilesViewOverflowMenu,{canDisplayFolderSizes:i,file:f,getOverflowMenuActions:_,isResponsive:!!m,showBorders:S||!!R&&E,thumbStore:y,viewportTopOffset:O,onMenuOpen:this.props.logOverflowMenuOpen,ariaHidden:v&&!E&&!S&&!!R})));var x={file:f,onShowShare:P,shareButtonLabel:T,showShareButton:F};return v?o.default.createElement(s.MediaActions,null,l.isFile(f)&&!w&&!d.shouldShowSplitShare(N,A,f)&&o.default.createElement(p.ShareButton,r.__assign({},x,{isVisible:!h&&(E||S),isSearchMode:g,useSearchSuccessBanner:C})),!w&&d.shouldShowSplitShare(N,A,f)&&o.default.createElement(c.SplitShareButton,r.__assign({},x,{context:{surface:L},file:f,isVisible:!h&&(E||S),onDropdownClose:this.onActionDropdownClose,onDropdownOpen:this.onActionDropdownOpen,onPresentInZoom:b,onShowShare:P,user:I,variant:"secondary"})),h||!S&&!E?null:o.default.createElement(a.ExtensionsMenu,{file:f,onDropdownClose:this.onActionDropdownClose,onDropdownOpen:this.onActionDropdownOpen,onPresentInZoom:b,telemetryContext:{surface:L},user:this.props.user}),R?n&&o.default.createElement(u.FilesViewOverflowMenu,{canDisplayFolderSizes:i,file:f,getOverflowMenuActions:_,isResponsive:!!m,showBorders:S||!!R&&E,thumbStore:y,viewportTopOffset:O,onMenuOpen:this.props.logOverflowMenuOpen,ariaHidden:v&&!E&&!S&&!!R}):o.default.createElement(t.ViewFileButton,{isVisible:E||h||S,onClick:D})):o.default.createElement(s.MediaActions,null,!w&&!d.shouldShowSplitShare(N,A,f)&&o.default.createElement(p.ShareButton,r.__assign({},x,{isVisible:S&&!h||this.state.isActionDropdownOpen,isSearchMode:this.props.isSearchMode,useSearchSuccessBanner:this.props.useSearchSuccessBanner})),!w&&d.shouldShowSplitShare(N,A,f)&&o.default.createElement(c.SplitShareButton,r.__assign({},x,{onShowShare:P,isVisible:S&&!h||this.state.isActionDropdownOpen,user:I,file:f,onDropdownOpen:this.onActionDropdownOpen,onDropdownClose:this.onActionDropdownClose,onPresentInZoom:b,context:{surface:L},variant:"secondary"})),S&&!h||this.state.isActionDropdownOpen?o.default.createElement(a.ExtensionsMenu,{file:f,onDropdownClose:this.onActionDropdownClose,onDropdownOpen:this.onActionDropdownOpen,onPresentInZoom:b,telemetryContext:{surface:L},user:this.props.user}):null,n&&o.default.createElement(u.FilesViewOverflowMenu,{canDisplayFolderSizes:i,file:f,getOverflowMenuActions:_,isResponsive:!!m,showBorders:S,thumbStore:y,viewportTopOffset:O,onMenuOpen:this.props.logOverflowMenuOpen,ariaHidden:v&&!E&&!S&&!!R}))},n})(o.default.PureComponent);t.FileMediaActions=_}),define("modules/clean/react/files_view/file_name_cell",["require","exports","tslib","external/classnames","react","retrieval-components/highlighted-truncated-string","spectrum/dimensions","spectrum/media_table","modules/clean/browse_interface","modules/clean/em_string","modules/clean/filename_highlights","modules/clean/filepath","modules/clean/filetypes","modules/clean/react/browse/models","modules/clean/react/files_view/constants","modules/clean/react/files_view/file_snippets","modules/clean/react/files_view/file_thumbnail","modules/clean/react/files_view/name_input","modules/clean/react/files_view/star","modules/clean/react/files_view/types","modules/clean/react/files_view/util","modules/clean/react/retrieval_success_banner/util","modules/clean/react/title_bubble","modules/clean/user_education/react/user_education_effect","modules/core/i18n"],function(e,t,r,o,n,i,s,a,l,c,d,u,p,f,_,m,h,S,g,v,E,w,b,T,F){"use strict";function y(e,t,r,o){if(o&&o>O){var n=(o-O)/t,i=Math.max(r,n-r);return c.Emstring.em_snippet(e,Math.floor(i),.5)}return e}Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),n=r.__importDefault(n),u=r.__importStar(u),t.FileSubtitle=function(e){var t=e.file,r=e.renameState,o=e.renderAsLink,i=void 0===o||o,s=e.showLocation,a=e.user,c=e.containerWidth,d=e.onClick,p=e.focusable;if(!E.isFile(t))return n.default.createElement(n.default.Fragment,null,F._("Shared with you",{comment:"A subtitle noting that a search result is a file that is shared with the user (Specifically it is unmounted, meaning it is not located in their Dropbox folder hierarchy)"}));if(r||!s)return null;var f=u.parent_dir(t.fq_path),_="/"===f?l.get_browse_root_name(a):f.slice(1);if(t.is_unmounted)return n.default.createElement(n.default.Fragment,null,F._("not added yet, in %(location)s",{comment:"Describes the parent directory of a file in a list of search results."}).format({location:_}));var m=F._("in %(location)s",{comment:"Describes the parent directory of a file in a list of search results."}).format({location:_}),h=y(m,I,C,c);if(!i||t.isDeleted)return n.default.createElement(n.default.Fragment,null,h);var S=l.browse_uri_for_fq_path(a,f);return n.default.createElement("a",{className:"brws-file-name-cell-location",href:S.toString(),onClick:d,tabIndex:p?0:-1},h)};var C=6,I=12,O=32,R=function(e){return e instanceof f.FileSharedWithMe},P=(function(e){function l(t){var r=e.call(this,t)||this;return r.handleNameInputSubmit=function(e){r.props.onRenameSubmit&&E.isFile(r.props.file)&&r.props.onRenameSubmit(r.props.file,e)},r.handleNameInputCancel=function(){r.props.onRenameCancel&&E.isFile(r.props.file)&&r.props.onRenameCancel(r.props.file)},r.handleOnClickNameInput=function(e){e.stopPropagation()},r.handleOnClickName=function(e){if(r.updateSearchSuccessBannerVisible(),r.props.selectionMethod===v.SelectionMethod.CLICK&&r.props.onNameClick_clickSelectionMethod)return void r.props.onNameClick_clickSelectionMethod(e);if(!r.props.isTextSelectable&&!r.props.isSelectMode&&E.shouldHandleClick(e)){if(e.preventDefault(),e.stopPropagation(),R(r.props.file))return void(r.props.onOpenFileSharedWithMe&&r.props.onOpenFileSharedWithMe(r.props.file));r.props.onNavigateToFileOrFolder&&r.props.onNavigateToFileOrFolder(r.props.file,{actionSource:v.FilesViewActionSource.ROW_TITLE})}},r.handleOnClickLocationLink=function(e){r.updateSearchSuccessBannerVisible();var t=r.props,o=t.file,n=t.onLocationLinkClick,i=!E.shouldHandleClick(e);i||(e.preventDefault(),e.stopPropagation()),n&&E.isFile(o)&&n(o,i)},r._setFilenameRef=function(e){return r._filenameDiv=e},r.onStarClick=function(e){var t=r.props,o=t.file,n=t.onStarClick;n&&E.isFile(o)&&n(o,e)},r.state={shouldShowTooltip:r.shouldShowTooltip(t)},r}return r.__extends(l,e),l.prototype.componentDidUpdate=function(e,t){var r=this.shouldShowTooltip(this.props);r!==t.shouldShowTooltip&&this.setState({shouldShowTooltip:r})},l.prototype.componentWillReceiveProps=function(e){var t=this.shouldShowTooltip(e);t!==this.state.shouldShowTooltip&&this.setState({shouldShowTooltip:t})},l.prototype.shouldShowTooltip=function(e){if(R(e.file))return!1;var t=this._filenameDiv,r=u.filename(e.file.fq_path);return!!(e.showTooltip&&t&&(t.offsetWidth<t.scrollWidth||t.textContent!==r))},l.prototype.updateSearchSuccessBannerVisible=function(){var e=this.props,t=e.useSearchSuccessBanner,r=e.isSearchMode;t&&r&&w.setSearchSuccessBannerVisible()},l.prototype.renderScreenReaderExtraInfo=function(){var e=[],t=this.props,r=t.file,o=t.isSelected;if(E.isFile(r)&&r.isDeleted&&e.push(F._("Deleted")),o&&e.push(F._("Selected")),E.isFile(r)&&r.is_dir&&(r.type===p.FileTypes.SHARED_FOLDER?f.File.isReadOnlySharedFolder(r)?e.push(F._("Read-only shared folder")):e.push(F._("Shared folder")):r.type===p.FileTypes.TEAM_SHARED_FOLDER?f.File.isReadOnlySharedFolder(r)?e.push(F._("Read-only team shared folder")):e.push(F._("Team shared folder")):e.push(F._("Folder"))),e.length>0)return n.default.createElement("span",{className:"ax-visually-hidden"},""+e.join(" "))},l.prototype.splitTruncatedParts=function(e,t){for(var r=0;r<e.length&&e.charAt(r)===t.charAt(r);)++r;return r===e.length||"…"!==e.charAt(r)?[e]:[e.substring(0,r),e.substring(r+1)]},l.prototype.getHighlightedSpan=function(e,t){var r=E.getFilename(t),o=this.splitTruncatedParts(e,r);if(1===o.length)return E.isFile(t)&&!t.highlight_spans?d.highlightMatchReact(e,t.filename_highlights):d.highlightReactFromHighlightSpans(e,t.highlight_spans);var i,s;return E.isFile(t)&&!t.highlight_spans?(i=d.highlightMatchReact(r,t.filename_highlights,0,o[0].length),s=d.highlightMatchReact(r,t.filename_highlights,r.lastIndexOf(o[1]))):(i=d.highlightReactFromHighlightSpans(r,t.highlight_spans,0,o[0].length),s=d.highlightReactFromHighlightSpans(r,t.highlight_spans,r.lastIndexOf(o[1]))),n.default.createElement("span",null,i,"…",s)},l.prototype.getHighlightedSpansForHighlightedTruncatedString=function(e,t){if(E.isFile(t)||R(t)){if(t.highlight_spans)return t.highlight_spans.map(function(e){return{string:e.highlight_str,isHighlighted:e.is_highlighted}});if(E.isFile(t)&&t.filename_highlights){return d.highlightMatchSections(e,t.filename_highlights).map(function(e){return{string:e.text,isHighlighted:e.isHighlighted}})}}},l.prototype.renderTitle=function(e){var t=this.props,r=t.file,o=t.renameState,s=t.user,a=t.hrefForFile,l=t.expHighlightedTruncatedString;if(o===v.RenameState.SAVING_INPUT)return n.default.createElement("span",{role:"status"},F._("Renaming…"));var c,d=E.getFilename(r);if(l)c=n.default.createElement(i.HighlightedTruncatedString,{text:d,className:"brws-file-name-element",fontSize:14,availableWidth:e,highlightSpans:this.getHighlightedSpansForHighlightedTruncatedString(d,r),cellBuffer:3});else{var u=y(d,14,3,e);if(c=this.props.showHighlights&&(r.highlight_spans||E.isFile(r)&&r.filename_highlights)?this.getHighlightedSpan(u,r):n.default.createElement("span",null,u),c=n.default.createElement("div",{className:"brws-file-name-element",ref:this._setFilenameRef},c),this.state.shouldShowTooltip){var p=d.length<=_.FILE_NAME_TOOLTIP_MAX_LINE_LENGTH?d:n.default.createElement("div",{className:"brws-file-name-cell-tooltip"},d);c=n.default.createElement(b.TitleBubble,{content:p,position:b.TitleBubble.POSITIONS.BOTTOM,className:"list-label__title-bubble"},c)}}if(E.isFile(r)&&a&&!(r.is_unmounted||r.isDeleted)||R(r)){var f=R(r)?r.href:a(s,r);c=n.default.createElement("a",{className:"brws-file-name-cell-filename",href:f,onClick:this.handleOnClickName,tabIndex:this.props.isSelected?0:-1},c)}return this.props.showUserEducationEffects?n.default.createElement(T.UserEducationEffect,{containerName:"FileItemRow",name:this.props.userEducationEffectName||"FileNameLabel",useSpan:!0},c):c},l.prototype.renderContent=function(e){var r,o=void 0===e?{}:e,i=o.width,s=o.hasMediaActions,l=this.props,c=l.file,d=l.renameState,p=l.showLocation,f=l.showSnippets,_=l.snippetRows,h=l.user;if(E.isFile(c)&&d===v.RenameState.PENDING_INPUT){var g=c.is_dir?F._("Rename directory…"):F._("Rename file…");r=n.default.createElement(S.NameInput,{defaultValue:u.filename(c.fq_path),label:g,onClick:this.handleOnClickNameInput,onSubmit:this.handleNameInputSubmit,onCancel:this.handleNameInputCancel,isDir:c.is_dir})}else if(r=[n.default.createElement(a.MediaCellText,{key:"title",highlight:this.props.isHovered},n.default.createElement("div",{className:"brws-file-name-cell-title-container"},this.renderTitle(i),this.renderScreenReaderExtraInfo(),this.renderStar())),n.default.createElement(a.MediaCellText,{highlight:this.props.isHovered,key:"subtitle",variant:"subtitle"},n.default.createElement(t.FileSubtitle,{containerWidth:i,file:c,onClick:this.handleOnClickLocationLink,renameState:d,renderAsLink:!0,showLocation:p,user:h,focusable:this.props.isSelected}))],f){var w=i?{width:s?i-48:i}:void 0;r.push(n.default.createElement(a.MediaCellText,{highlight:this.props.isHovered,key:"snippets",variant:"subtitle",style:w},n.default.createElement(m.FileSnippets,{snippets:c.snippets,lineClamp:_})))}return r},l.prototype.renderStar=function(){var e=this.props,t=e.file,r=e.renameState,o=e.user,i=e.showStar,s=e.responsive,a=s&&!s.isMatchedMedium&&!s.isMatchedLarge;return i&&!r?n.default.createElement(g.StarContainer,{item:t,user:o,className:"brws-file-name-cell-star",
onStarClick:this.onStarClick,isReadOnly:a,tabIndex:-1}):null},l.prototype.render=function(){var e=this,t=this.props,i=t.mediaActions,l=t.file,c=t.thumbStore,d=t.showCDMUserEducationEffects,u=t.expHighlightedTruncatedString,p=t.fileNameCellWidth,f=t.height,_=o.default("brws-file-name-cell-text","brws-vertically-center",{"brws-file-name-cell-text-rename":!!this.props.renameState}),m=n.default.createElement(h.FileThumbnail,{file:l,thumbStore:c,showCDMUserEducationEffects:d}),S={icon:m,style:{minHeight:f-1}};return this.props.shouldTruncateMiddleFilename?R(l)&&u&&p?n.default.createElement(a.MediaCell,r.__assign({},S),n.default.createElement("div",{className:"brws-file-name-container"},n.default.createElement("div",{className:_},this.renderContent({width:p,hasMediaActions:!!i}))),i):n.default.createElement(a.MediaCell,r.__assign({},S),n.default.createElement(s.Dimensions,{className:"brws-file-name-container"},function(t){var r=t.width;return n.default.createElement("div",{className:"brws-file-name-container"},n.default.createElement("div",{className:_},e.renderContent({width:r,hasMediaActions:!!i})))}),i):n.default.createElement(a.MediaCell,r.__assign({},S),n.default.createElement("div",{className:_},this.renderContent()),i)},l.defaultProps={selectionMethod:v.SelectionMethod.CHECKBOX},l})(n.default.Component);t.FileNameCell=P}),define("modules/clean/react/files_view/file_row",["require","exports","tslib","external/classnames","external/react-dom","react","spectrum/checkbox","spectrum/media_table","modules/clean/cloud_docs/constants","modules/clean/filepath","modules/clean/react/browse/models","modules/clean/react/files_view/double_click","modules/clean/react/files_view/file_media_actions","modules/clean/react/files_view/file_name_cell","modules/clean/react/files_view/keyboard_focus","modules/clean/react/files_view/types","modules/clean/react/files_view/util","modules/clean/react/selectable_list","modules/clean/react/title_bubble","modules/clean/user_education/react/user_education_effect","modules/core/browser","modules/core/exception","modules/core/i18n"],function(e,t,r,o,n,i,s,a,l,c,d,u,p,f,_,m,h,S,g,v,E,w,b){"use strict";function T(e){switch(h.isFile(e)?c.split_filename(e.fq_path).ext:e.ext.slice(1)){case l.PaperFileTypes.PAPER:case l.PaperFileTypes.PAPER_TEMPLATE:return!0;default:return!1}}Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),n=r.__importStar(n),i=r.__importDefault(i),c=r.__importStar(c),E=r.__importStar(E),w=r.__importStar(w);var F=function(){return i.default.createElement("span",{"aria-hidden":!0},"--")},y=function(){return i.default.createElement("svg",{width:"20px",height:"20px",viewBox:"0 0 20 20",version:"1.1"},i.default.createElement("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},i.default.createElement("g",{id:"Group",transform:"translate(2.000000, 2.000000)"},i.default.createElement("circle",{id:"Oval-65",cx:"8",cy:"8",r:"8"}),i.default.createElement("path",{d:"M8,13 L8,14.5 L5.5,12.5 L8,10.5 L8,12 C10.209139,12 12,10.209139 12,8 C12,6.93104698 11.5806921,5.96002857 10.8975817,5.24245012 L11.4674192,4.39763124 C12.4121861,5.30722218 13,6.58496544 13,8 C13,10.7614237 10.7614237,13 8,13 Z M8,3 L8,1.5 L10.5,3.5 L8,5.5 L8,4 C5.790861,4 4,5.790861 4,8 C4,8.96511539 4.34180174,9.8503987 4.91095749,10.5414022 L4.33270318,11.3986995 C3.5056268,10.5066799 3,9.3123877 3,8 C3,5.23857625 5.23857625,3 8,3 Z",id:"Oval-67",fill:"#637282"}))))},C=function(){return i.default.createElement("svg",{width:"20px",height:"20px",viewBox:"0 0 20 20",version:"1.1"},i.default.createElement("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},i.default.createElement("g",{id:"icon-warning",fill:"#637282"},i.default.createElement("path",{d:"M13.9298189,16.125 C16.4624689,16.125 17.5138484,14.3377448 16.2785476,12.1337797 L12.238298,4.92535765 C11.002815,2.72106753 8.99951926,2.72139251 7.76421846,4.92535765 L3.7239688,12.1337797 C2.48848585,14.3380698 3.54098311,16.125 6.07269759,16.125 L13.9298189,16.125 Z M11.002944,14.0995516 L8.99957244,14.0995516 L8.99957244,12.0741033 L11.002944,12.0741033 L11.002944,14.0995516 L11.002944,14.0995516 Z M11.002944,11.0613791 L8.99957244,11.0613791 L8.99957244,7.01048239 L11.002944,7.01048239 L11.002944,11.0613791 L11.002944,11.0613791 Z",id:"Shape"}))))},I=function(){return i.default.createElement("div",{className:"error-tooltip"},i.default.createElement("div",{className:"error-tooltip__title"},b._("This folder is too large")),b._("We can’t calculate the full size of this folder right now. This can happen when there are a large number of files inside of the folder or if the request takes too long."))};t.isCloudDocProviderStored=T;var O=function(e){var t=e.file;if(!t.is_dir)return t.is_cloud_doc&&T(t)?i.default.createElement(F,null):i.default.createElement("span",null,t.size);switch(t.fetchFolderSizesStatus){case m.FetchFolderSizeState.LOADING:return i.default.createElement("span",{className:"item-cell-title item-cell-title--loading"},i.default.createElement("span",{className:"ax-visually-hidden"},b._("Calculating folder sizes...")),i.default.createElement(y,null),b._("Calculating..."));case m.FetchFolderSizeState.ERROR:return i.default.createElement("span",{className:"item-cell-title"},i.default.createElement(g.TitleBubble,{content:i.default.createElement(I,null),position:g.TitleBubble.POSITIONS.TOP,isTargetPositionFixed:!1},i.default.createElement("span",{className:"item-cell-title item-cell-title--error"},i.default.createElement("span",{className:"ax-visually-hidden"},b._("Error in calculating folder sizes")),i.default.createElement(C,null))));case m.FetchFolderSizeState.COMPLETE:return i.default.createElement("span",{className:"item-cell-title"},t.size);default:return i.default.createElement(F,null)}},R=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.checkboxRef=null,t.handleClick=function(e){if(!t.shouldHandleClick(e))return void e.preventDefault();if(t.props.selectionMethod!==m.SelectionMethod.CLICK){if(t.props.isSelectMode&&t.props.onDeselect&&t.props.onSelect){e.preventDefault();var r=t.props.file.fq_path;return void(t.props.isSelected?t.props.onDeselect(r,e.shiftKey):t.props.onSelect(r,e.shiftKey?S.SelectOptions.EXTEND:S.SelectOptions.DEFAULT))}t.handleOpenNewTabOrNavigate(e,m.FilesViewActionSource.ROW_SINGLE_CLICK)}else if(t.props.onSelect){var o=S.SelectOptions.ONLY;e.shiftKey?o=S.SelectOptions.EXTEND:(e.ctrlKey||e.metaKey)&&(o=S.SelectOptions.DEFAULT),t.props.onSelect(t.props.file.fq_path,o)}},t.handleDoubleClick=function(e){if(!t.shouldHandleClick(e))return void e.preventDefault();t.handleOpenNewTabOrNavigate(e,m.FilesViewActionSource.ROW_DOUBLE_CLICK)},t.isCheckboxNode=function(e){var r=t.getCheckboxNode();return!!r&&r.contains(e)},t.handleOpenFileClick=function(e){return t.handleOpenNewTabOrNavigate(e,m.FilesViewActionSource.ROW_PREVIEW_ICON)},t.handleTitleClick=function(e){return t.handleOpenNewTabOrNavigate(e,m.FilesViewActionSource.ROW_TITLE)},t.handleOpenNewTabOrNavigate=function(e,r){if(0===e.button){if(e.preventDefault(),e.stopPropagation(),h.hasModifierKey(e)){var o=t.props,n=o.file,i=o.user,s=o.hrefForFile;return void E.open_tab(s(i,n))}t.props.onNavigateToFileOrFolder(t.props.file,{actionSource:r})}},t.handleChangeCheckbox=function(e,r){if(t.props.onSelect&&t.props.onDeselect){var o=t.props.file.fq_path;"checked"===e?t.props.onSelect(o,r.shiftKey?S.SelectOptions.EXTEND:S.SelectOptions.DEFAULT):t.props.onDeselect(o,r.shiftKey)}},t.handleCheckboxTouchTargetClick=function(e){if(t.isCheckboxNode(e.target))return void e.preventDefault();if(!t.props.isCheckboxDisabled&&t.props.onDeselect&&t.props.onSelect){e.preventDefault();var r=t.props.file.fq_path;t.props.isSelected?t.props.onDeselect(r,e.shiftKey):t.props.onSelect(r,e.shiftKey?S.SelectOptions.EXTEND:S.SelectOptions.DEFAULT)}},t.handleDragEnter=function(e){var r=t.props,o=r.file,n=r.isSelected,i=r.isActiveDropTarget;t.props.onDragEnter(e,o,!!n,!!i)},t.handleDragStart=function(e){var r=t.props,o=r.file,n=r.isSelected,i=r.onDragStart,s=r.onSelect;i&&(n?i(e):(s&&s(o.fq_path),i(e,[o])))},t.onKeyboardFocus=function(){var e=t.props,r=e.rowFocusable,o=e.isSelected,n=e.onSelect;if(r&&n&&!o){n(t.props.file.fq_path)}},t.setCheckboxRef=function(e){t.checkboxRef=e},t.getCheckboxNode=function(){return t.checkboxRef&&n.findDOMNode(t.checkboxRef)},t.onShowShare=function(){t.props.onShowShare(t.props.file,"BROWSE_FILE_ROW")},t.onPresentInZoom=function(){t.props.onPresentInZoom&&t.props.onPresentInZoom(t.props.file)},t.getAriaLabelForColumn=function(e,t){switch(e.sortField){case m.SortField.FILENAME:return e.label+" "+c.filename(t.fq_path);case m.SortField.MODIFIED:return e.label+" "+t.ago;case m.SortField.CATEGORY:return e.label+" "+d.File.getCategoryDescription(t);case m.SortField.EXTENSION:return e.label+" "+d.File.getExtension(t);case m.SortField.SIZE:return e.label+" "+t.size;case m.SortField.SHARED_WITH:default:return}},t.rowChildFn=function(e){var r,n=e.isHovered,l=t.props,c=l.isCompactMode,d=l.isPinned,u=l.isSelectMode,p=l.isSelected,f=l.showUserEducationEffects,_=l.visibleColumns;if(!d){var m=!(n||p||u||c);r=i.default.createElement(s.Checkbox,{disabled:t.props.isCheckboxDisabled,checked:p?"checked":"unchecked",className:o.default("brws-checkbox",{"brws-checkbox-checked":p}),onChange:t.handleChangeCheckbox,ref:t.setCheckboxRef,variant:m?"invisible":"default",ariaLabel:b._("Select item"),tabIndex:p?0:-1}),f&&(r=i.default.createElement(v.UserEducationEffect,{containerName:"FileItemRow",name:"FirstFileSelectCheckbox",useSpan:!0},r))}return[i.default.createElement(a.MediaCell,{key:"checkboxCell",className:"brws-checkbox-cell"},i.default.createElement("div",{className:"brws-vertically-center brws-file-row-checkbox-target",onClick:t.handleCheckboxTouchTargetClick,"aria-controls":"brws-sidebar-view"},r))].concat(_.map(function(e,r){return t.renderCell({isHovered:n,isLastCell:r===_.length-1,sortField:e.sortField,renderCell:e.renderCell})}))},t}return r.__extends(t,e),t.prototype.componentDidUpdate=function(e){var t=this;(this.props.isFocused&&!e.isFocused||this.props.isFocused&&this.props.isSelected&&!e.isSelected)&&this.checkboxRef&&Promise.resolve().then(function(){var e=t.getCheckboxNode();e&&e.focus()})},t.prototype.shouldHandleClick=function(e){return!e.defaultPrevented&&!this.isCheckboxNode(e.target)},t.prototype.renderModifiedCell=function(e,t,r){var o=r&&e.agoFromLastActionByUserTs,n=e.is_dir&&!this.props.isSearchMode?void 0:o?e.agoFromLastActionByUserTs:e.ago,s=o?r:e.last_modified_name||void 0,l=s&&b._("by %(modified_by)s",{comment:"name of the person that modified the file"}).format({modified_by:s});return i.default.createElement(a.MediaCell,{className:"brws-file-modified-at-cell",key:"modifiedAt",subtitle:l,title:n||i.default.createElement(F,null)},t)},t.prototype.renderCell=function(e){var t=e.isHovered,r=e.isLastCell,o=e.sortField,n=e.renderCell,s=this.props,l=s.arePostTTIModulesLoaded,c=s.canDisplayFolderSizes,u=s.extensionsFeatureFlags,_=s.file,h=s.getOverflowMenuActions,S=s.hasResponsiveOverflowMenu,g=s.hrefForFile,v=s.isCompactMode,E=s.isSearchMode,b=s.isSelectMode,T=s.isSelected,y=s.isSharingDisabled,C=s.onLocationLinkClick,I=s.onNavigateToFileOrFolder,R=s.onRenameCancel,P=s.onRenameSubmit,D=s.onStarClick,N=s.renameState,A=s.responsive,L=s.shareButtonLabel,x=s.sharingServiceInfo,M=s.showCDMUserEducationEffects,U=s.showShareButton,k=s.showUserEducationEffects,B=s.thumbStore,V=s.useSearchSuccessBanner,H=s.user,W=s.userEducationEffectName,q=s.viewportTopOffset,G=s.expHighlightedTruncatedString,z=s.showSnippets,j=s.snippetRows,Y=s.height,Q=s.selectionMethod,K=s.filteredContactName,J=s.expBrowseStickyOverflowMenu,X=r&&!(v&&N),Z=X?i.default.createElement(p.FileMediaActions,{arePostTTIModulesLoaded:l,canDisplayFolderSizes:c,extensionsFeatureFlags:u,file:_,getOverflowMenuActions:h,hasResponsiveOverflowMenu:!!S,isCompactMode:!!v,isHovered:t,isSearchMode:!!E,isSelectMode:!!b,isSelected:!!T,isSharingDisabled:!!y,onOpenFileClick:this.handleOpenFileClick,onPresentInZoom:this.onPresentInZoom,onShowShare:this.onShowShare,shareButtonLabel:L,sharingServiceInfo:x,showShareButton:U,thumbStore:B,useSearchSuccessBanner:V,user:H,viewportTopOffset:q,expBrowseStickyOverflowMenu:J,logOverflowMenuOpen:this.props.logOverflowMenuOpen}):void 0;if(n)return n({file:_,mediaActions:Z});switch(o){case m.SortField.FILENAME:return i.default.createElement(f.FileNameCell,{key:"fileName",user:H,file:_,isHovered:t,isSelectMode:b,isSelected:T,mediaActions:Z,onNavigateToFileOrFolder:I,onLocationLinkClick:C,onRenameCancel:R,onRenameSubmit:P,renameState:N,responsive:A,showCDMUserEducationEffects:M,showTooltip:l,showHighlights:E,showLocation:E,showUserEducationEffects:k,userEducationEffectName:W,showStar:l&&!d.File.isNoAccessSharedFolder(_),onStarClick:D,thumbStore:B,shouldTruncateMiddleFilename:l,hrefForFile:g,expHighlightedTruncatedString:G,showSnippets:z,snippetRows:j,height:Y,selectionMethod:Q,onNameClick_clickSelectionMethod:this.handleTitleClick,isSearchMode:!!E,useSearchSuccessBanner:V});case m.SortField.RELEVANCE:case m.SortField.MODIFIED:return this.renderModifiedCell(_,Z,K);case m.SortField.SHARED_WITH:return i.default.createElement(a.MediaCell,{className:"brws-file-shared-with-cell",key:"sharedWith"},this.props.renderSharedWithController(_,this.props.rowFocusable?0:void 0),Z);case m.SortField.CATEGORY:return i.default.createElement(a.MediaCell,{className:"brws-file-category-cell",key:"category",title:d.File.getCategoryDescription(_)},Z);case m.SortField.EXTENSION:return i.default.createElement(a.MediaCell,{className:"brws-file-extension-cell",key:"extension",title:d.File.getExtension(_)},Z);case m.SortField.SIZE:return i.default.createElement(a.MediaCell,{className:"brws-file-size-cell",key:"size",title:i.default.createElement(O,{file:_})},Z);case m.SortField.LOCKED_FILES:return i.default.createElement(a.MediaCell,{className:"brws-file-size-cell",key:"locked_files",title:""},Z);default:return w.reportException({err:new Error("renderCell function for "+o+"is not implemented"),severity:w.SEVERITY.NONCRITICAL,tags:["js:browse"]}),i.default.createElement(F,null)}},t.prototype.render=function(){var e=this,t=this.props,n=t.file,s=t.isActiveDropTarget,l=t.isAvailableDropTarget,c=t.isPinned,p=t.isSearchMode,f=t.isSelected,h=t.renameState,S=t.rowIndex,g=t.topOffset,v=t.selectionMethod,E=t.visibleColumns,w=o.default("brws-file-row",{"brws-file-row-selected":f,"brws-file-row-deleted":n.isDeleted,"brws-file-row-droppable":l&&!s,"brws-file-row-dragover":s,"brws-file-row-no-access":d.File.isNoAccessSharedFolder(n),"brws-file-row-pinned":c,"brws-row-click-selection-method":v===m.SelectionMethod.CLICK}),b=s?"dragover":l&&!s?"droppable":f?"selected":"default",T=!(h||p||d.File.isTeamMemberFolder(n)||d.File.isReadOnlySharedFolder(n)||d.File.isNoAccessSharedFolder(n)),F="";E.forEach(function(t){var r=e.getAriaLabelForColumn(t,n);r&&(F+=r+", ")});var y=r.__assign({"aria-rowindex":void 0!==S?S+1:void 0,className:w,"data-filename":n.fq_path.split("/").slice(-1),"aria-label":F,onDragEnter:this.handleDragEnter,variant:b},v===m.SelectionMethod.CLICK&&{"aria-controls":"brws-sidebar-view"}),C=this.props.selectionMethod===m.SelectionMethod.CLICK?this.handleDoubleClick:void 0;return i.default.createElement(u.WithDoubleClick,{onClick:this.handleClick,onDoubleClick:C},function(t){var o=t.onClick;return i.default.createElement(_.WithKeyboardFocus,{onKeyboardFocus:e.onKeyboardFocus},function(t){var n=t.onMouseDown,s=t.onFocus;return c?i.default.createElement(a.MediaRow,r.__assign({},y,{onClick:o,onMouseDown:n,onFocus:s}),e.rowChildFn):i.default.createElement(a.CulledMediaRow,r.__assign({},y,{onClick:o,draggable:T,topOffset:g,onDragStart:e.handleDragStart,onMouseDown:n,onFocus:s}),e.rowChildFn)})})},t.defaultProps={isSelectionEmpty:!0,topOffset:0,selectionMethod:m.SelectionMethod.CHECKBOX},t})(i.default.PureComponent);t.FileRow=R}),define("modules/clean/react/files_view/file_shared_with_me_row",["require","exports","tslib","external/classnames","external/react-dom","react","spectrum/checkbox","spectrum/media_table","spectrum/util/raf_throttle","modules/clean/react/files_view/double_click","modules/clean/react/files_view/file_media_actions","modules/clean/react/files_view/file_name_cell","modules/clean/react/files_view/file_row","modules/clean/react/files_view/keyboard_focus","modules/clean/react/files_view/types","modules/clean/react/files_view/util","modules/clean/react/selectable_list","modules/clean/user_education/react/user_education_effect","modules/core/browser","modules/core/exception","modules/core/i18n"],function(e,t,r,o,n,i,s,a,l,c,d,u,p,f,_,m,h,S,g,v,E){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),n=r.__importStar(n),i=r.__importDefault(i),g=r.__importStar(g),v=r.__importStar(v);var w=function(){return i.default.createElement("span",{"aria-hidden":!0},"--")},b=function(e){var t=e.file;return t.is_cloud_doc&&p.isCloudDocProviderStored(t)?i.default.createElement(w,null):i.default.createElement("span",null,t.size)},T=(function(e){function t(t){var r=e.call(this,t)||this;return r.setRef=function(e){r.brwsFilenameContainerDiv=e},r.checkboxRef=null,r.handleWindowResize=function(){r.throttledWindowResize.request()},r.handleResize=function(){if(r.brwsFilenameContainerDiv){var e=r.state.brwsFilenameContainerDivWidth,t=r.brwsFilenameContainerDiv.getBoundingClientRect().width;t&&t!==e&&r.setState({brwsFilenameContainerDivWidth:t})}},r.handleClick=function(e){if(r.props.expSelectableFswm){if(e.defaultPrevented||r.isCheckboxNode(e.target))return void e.preventDefault();if(r.props.selectionMethod===_.SelectionMethod.CLICK&&r.props.onSelect){var t=h.SelectOptions.ONLY;return e.shiftKey?t=h.SelectOptions.EXTEND:(e.ctrlKey||e.metaKey)&&(t=h.SelectOptions.DEFAULT),void r.props.onSelect(r.props.file.file_id,t)}if(r.props.isSelectMode&&r.props.onDeselect&&r.props.onSelect){e.preventDefault();var o=r.props.file.file_id;return void(r.props.isSelected?r.props.onDeselect(o,e.shiftKey):r.props.onSelect(o,e.shiftKey?h.SelectOptions.EXTEND:h.SelectOptions.DEFAULT))}r.handleOpenNewTabOrNavigate(e)}else if(0===e.button){if(e.preventDefault(),e.stopPropagation(),r.props.selectionMethod===_.SelectionMethod.CLICK&&r.props.onSelect)return;r.handleOpenNewTabOrNavigate(e)}},r.handleDoubleClick=function(e){if(e.defaultPrevented||r.isCheckboxNode(e.target))return void e.preventDefault();r.handleOpenNewTabOrNavigate(e)},r.handleOpenNewTabOrNavigate=function(e){var t=r.props.file;0===e.button&&(e.preventDefault(),e.stopPropagation(),m.hasModifierKey(e)?g.open_tab(t.href):r.props.onOpenFileSharedWithMe(t))},r.getCheckboxNode=function(){return r.checkboxRef&&n.findDOMNode(r.checkboxRef)},r.isCheckboxNode=function(e){var t=r.getCheckboxNode();return!!t&&t.contains(e)},r.handleChangeCheckbox=function(e,t){if(r.props.onSelect&&r.props.onDeselect){var o=r.props.file.file_id;"checked"===e?r.props.onSelect(o,t.shiftKey?h.SelectOptions.EXTEND:h.SelectOptions.DEFAULT):r.props.onDeselect(o,t.shiftKey)}},r.onKeyboardFocus=function(){var e=r.props,t=e.rowFocusable,o=e.isSelected,n=e.onSelect;if(t&&n&&!o){n(r.props.file.file_id)}},r.setCheckboxRef=function(e){r.checkboxRef=e},r.handleCheckboxTouchTargetClick=function(e){if(r.isCheckboxNode(e.target))return void e.preventDefault();if(!r.props.isCheckboxDisabled&&r.props.onDeselect&&r.props.onSelect){e.preventDefault();var t=r.props.file.file_id;r.props.isSelected?r.props.onDeselect(t,e.shiftKey):r.props.onSelect(t,e.shiftKey?h.SelectOptions.EXTEND:h.SelectOptions.DEFAULT)}},r.rowChildFn=function(e){var t=e.isHovered,n=r.props,l=n.isCompactMode,c=n.isSelectMode,d=n.isSelected,u=n.showUserEducationEffects,p=n.visibleColumns,f=null;if(r.props.expSelectableFswm){var _=!(t||d||c||l);f=i.default.createElement(s.Checkbox,{disabled:r.props.isCheckboxDisabled,checked:d?"checked":"unchecked",className:o.default("brws-checkbox",{"brws-checkbox-checked":d}),onChange:r.handleChangeCheckbox,ref:r.setCheckboxRef,variant:_?"invisible":"default",ariaLabel:E._("Select item"),tabIndex:d?0:-1}),u&&(f=i.default.createElement(S.UserEducationEffect,{containerName:"FileSharedWithMeRow",name:"FirstFileSelectCheckbox",useSpan:!0},f))}return[i.default.createElement(a.MediaCell,{key:"checkboxCell",className:"brws-checkbox-cell"},i.default.createElement("div",{className:"brws-vertically-center brws-file-row-checkbox-target",onClick:r.handleCheckboxTouchTargetClick},f))].concat(p.map(function(e,o){return r.renderCell({isHovered:t,sortField:e.sortField,isLastCell:o===p.length-1})}))},r.state={brwsFilenameContainerDivWidth:void 0},r.throttledWindowResize=new l.RafThrottle(function(){return r.handleResize()}),r}return r.__extends(t,e),t.prototype.componentDidMount=function(){this.handleResize(),window.addEventListener("resize",this.handleWindowResize)},t.prototype.componentWillUnmount=function(){window.removeEventListener("resize",this.handleWindowResize)},t.prototype.componentDidUpdate=function(e){var t=this;(this.props.isFocused&&!e.isFocused||this.props.isFocused&&this.props.isSelected&&!e.isSelected)&&this.checkboxRef&&Promise.resolve().then(function(){var e=t.getCheckboxNode();e&&e.focus()})},t.prototype.renderModifiedCell=function(e,t,r){var o=r&&e.agoFromLastActionByUserTs,n=o?e.agoFromLastActionByUserTs:e.ago,s=o?r:e.last_modified_name||void 0,l=s&&E._("by %(modified_by)s",{comment:"name of the person that modified the file"}).format({modified_by:s});return i.default.createElement(a.MediaCell,{className:"brws-file-modified-at-cell",key:"modifiedAt",subtitle:l,title:n||i.default.createElement(w,null)},t)},t.prototype.renderCell=function(e){var t=e.isHovered,o=e.sortField,n=e.isLastCell,s=this.props,l=s.arePostTTIModulesLoaded,c=s.file,p=s.onOpenFileSharedWithMe,f=s.getOverflowMenuActions,m=s.thumbStore,h=s.isCompactMode,S=s.isSelectMode,g=s.isSelected,E=s.responsive,T=s.user,F=s.expHighlightedTruncatedString,y=s.showSnippets,C=s.snippetRows,I=s.height,O=s.selectionMethod,R=s.hasResponsiveOverflowMenu,P=s.useSearchSuccessBanner,D=s.expSelectableFswm,N=s.filteredContactName,A=f(c,!1).some(function(e){return e.length>0}),L=D&&n&&!h&&l&&A,x=L?i.default.createElement(d.FileMediaActions,{arePostTTIModulesLoaded:l,canDisplayFolderSizes:!1,file:c,getOverflowMenuActions:f,hasResponsiveOverflowMenu:!!R,isCompactMode:!!h,isHovered:t,isSearchMode:!0,isSelectMode:!!S,isSelected:!!g,isSharingDisabled:!0,thumbStore:m,useSearchSuccessBanner:P,user:T,onOpenFileClick:this.handleOpenNewTabOrNavigate,logOverflowMenuOpen:this.props.logOverflowMenuOpen}):void 0;switch(o){case _.SortField.FILENAME:var M={file:c,isHovered:t,onOpenFileSharedWithMe:p,isSelectMode:S,isSelected:g,responsive:E,user:T,thumbStore:m,mediaActions:x,shouldTruncateMiddleFilename:l,showHighlights:!0,showLocation:!0,showStar:!1,showSnippets:y,snippetRows:C,height:I,selectionMethod:O,onNameClick_clickSelectionMethod:this.handleOpenNewTabOrNavigate,isSearchMode:!0,useSearchSuccessBanner:P};if(F){var U=this.state.brwsFilenameContainerDivWidth;return i.default.createElement("div",{className:"brws-file-name-container",ref:this.setRef},i.default.createElement(u.FileNameCell,r.__assign({},M,{expHighlightedTruncatedString:F,fileNameCellWidth:U?U-64:void 0})))}return i.default.createElement(u.FileNameCell,r.__assign({key:"fileName"},M));case _.SortField.RELEVANCE:case _.SortField.MODIFIED:return this.renderModifiedCell(c,x,N);case _.SortField.SIZE:return i.default.createElement(a.MediaCell,{className:"brws-file-size-cell",key:"size",title:i.default.createElement(b,{file:c})},x);default:case _.SortField.CATEGORY:case _.SortField.EXTENSION:case _.SortField.SHARED_WITH:return v.reportException({err:new Error("FileSharedWithMe.renderCell is not implemented for "+o),severity:v.SEVERITY.NONCRITICAL,tags:["js:search"]}),i.default.createElement(a.MediaCell,{key:o,title:i.default.createElement(w,null)})}},t.prototype.render=function(){var e,t=this,r=this.props,n=r.expSelectableFswm,s=r.rowIndex,l=r.topOffset,d=r.selectionMethod,u=r.isSelected,p=r.rowFocusable,m=d===_.SelectionMethod.CLICK?this.handleDoubleClick:void 0,h=o.default("brws-filesharedwithme-row",{"brws-file-row-selected":u,"brws-row-click-selection-method":d===_.SelectionMethod.CLICK});return n&&(e=p?0:-1),i.default.createElement(c.WithDoubleClick,{onClick:this.handleClick,onDoubleClick:m},function(r){var o=r.onClick;return i.default.createElement(f.WithKeyboardFocus,{onKeyboardFocus:t.onKeyboardFocus},function(r){var n=r.onMouseDown,c=r.onFocus;return i.default.createElement(a.CulledMediaRow,{"aria-rowindex":void 0!==s?s+1:void 0,className:h,draggable:!1,onClick:o,topOffset:l,variant:"default",tabIndex:e,onFocus:c,onMouseDown:n},t.rowChildFn)})})},t.defaultProps={selectionMethod:_.SelectionMethod.CHECKBOX},t})(i.default.PureComponent);t.FileSharedWithMeRow=T}),define("modules/clean/react/files_view/file_snippets",["require","exports","tslib","react","modules/clean/filename_highlights","modules/clean/react/files_view/constants","modules/clean/react/files_view/selectors"],function(e,t,r,o,n,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),n=r.__importStar(n);var a=(function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(n,e),n.prototype.render=function(){var e=this.props,r=e.snippets,n=e.lineClamp,a={maxHeight:i.SNIPPET_HEIGHT_PER_ROW*n,WebkitLineClamp:n},l=s.getFirstValidSnippet(r);return l?o.default.createElement("span",{className:"brws-file-snippets",style:a},o.default.createElement(t.FileSnippet,{snippet:l})):null},n.defaultProps={lineClamp:3},n})(o.default.PureComponent);t.FileSnippets=a,t.FileSnippet=function(e){var t=e.snippet;return n.highlightReactFromAllHighlightSpans(t.highlight_spans||[])}}),define("modules/clean/react/files_view/fixed_table_head",["require","exports","tslib","spectrum/vertically_fixed","spectrum/table","react"],function(e,t,r,o,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=r.__importDefault(i),t.FixedTableHead=function(e){var t=e.children,s=e.offsetHeight,a=e.style,l=void 0===a?{}:a,c=r.__rest(e,["children","offsetHeight","style"]),d=void 0===s?l:r.__assign({flexBasis:s},l);return i.default.createElement("thead",r.__assign({className:"mc-table-head mc-table-head-fixed brws-column-header",style:d},c),i.default.createElement(o.VerticallyFixed,{tag:function(e){var o=e.style;return i.default.createElement(n.TableRow,{className:"mc-table-head-row mc-table-head-row-fixed",style:r.__assign({height:s},o),role:"presentation"},t)}}))}}),define("modules/clean/react/files_view/internal_drag_status",["require","exports","tslib","external/classnames","react","modules/clean/react/icon/file_folder_icon"],function(e,t,r,o,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),n=r.__importDefault(n);var s=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.className,r=e.files,s=o.default("active",t);return n.default.createElement("div",{id:"drag-status",className:s},n.default.createElement("div",{id:"drag-selection-status"},r.slice(0,4).map(function(e,t){return e.thumbnail_url_tmpl?n.default.createElement("img",{key:t,src:e.thumbnail_url_tmpl,className:"icon icon"+t,alt:""}):n.default.createElement(i.FileOrFolderIcon,{key:t,file:e,className:"icon icon"+t})}),n.default.createElement("span",{className:"badge"},r.length)))},t})(n.default.PureComponent);t.InternalDragStatus=s}),define("modules/clean/react/files_view/list",["require","exports","tslib","react","modules/clean/react/browse/models","modules/clean/react/files_view/culled_table_body","modules/clean/react/files_view/drag_and_drop","modules/clean/react/files_view/file_row","modules/clean/react/files_view/file_shared_with_me_row","modules/clean/react/files_view/keyboard_shortcuts","modules/clean/react/files_view/new_folder_row","modules/clean/react/files_view/paper_row","modules/clean/react/files_view/selectors","modules/clean/react/files_view/types","modules/clean/react/files_view/user_defined_item_row","modules/clean/react/browse/action_logger","modules/clean/web_user_action_events"],function(e,t,r,o,n,i,s,a,l,c,d,u,p,f,_,m,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o);var S=function(){},g=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleFileViewerUnmount=function(){var e=t.props.selectedFiles.first();e&&t.props.onFocusFile(e.fq_path)},t.getIsListEvent=function(e){return t.props.isSelectableListEvent()&&(!(e.target instanceof Element)||"BUTTON"!==e.target.tagName)},t.getSelectedFiles=function(){return t.props.selectedFiles},t.handleNavigateToFileOrFolder=function(e,o){t.props.onNavigateToFileOrFolder(e,r.__assign({},o,{onFileViewerUnmount:t.handleFileViewerUnmount}))},t.getActiveDropTarget=function(){return t.props.activeDropTarget},t.getIsDraggingInternalFiles=function(){return!!t.props.isDraggingInternalFiles},t.getIsDraggingExternalFiles=function(){return!!t.props.isDraggingExternalFiles},t.logOverflowMenuOpen=function(){var e=t.props,r=e.selectedFiles,o=e.user,n=r?r.count(function(e){return e.is_dir}):0,i=r?r.count()-n:0;m.logContextMenuClick({uid:o.id,viewType:f.ViewType.List,action_surface:h.ActionSurfaceLogValue.CENTER_PANE,numFilesSelected:i,numFoldersSelected:n})},t.renderRow=function(e,r,i){if("NewFolderRow"===e.type)return o.default.createElement(d.NewFolderRow,{createNewFolderState:e.props.createNewFolderState,isInsideMyTeamFolderTree:e.props.isInsideMyTeamFolderTree,onCancel:t.props.onNewFolderCancel,onSubmit:t.props.onNewFolderSubmit,rowIndex:r,topOffset:i});if("PaperRow"===e.type)return o.default.createElement(u.PaperRow,{paper:e.props.paper,rowIndex:r,topOffset:i,user:t.props.user,visibleColumns:e.props.visibleColumns,onOpenPaper:t.props.onOpenPaper,arePostTTIModulesLoaded:e.props.arePostTTIModulesLoaded,expHighlightedTruncatedString:t.props.expHighlightedTruncatedString,showSnippets:e.props.showSnippets,snippetRows:e.props.snippetRows,height:e.props.height,selectionMethod:t.props.selectionMethod});if("UserDefinedItemRow"===e.type)return o.default.createElement(_.UserDefinedItemRow,{userDefinedItem:e.props.userDefinedItem,rowIndex:r,topOffset:i});var s=t.props.selection,c=e.props.file instanceof n.File?s.selected.last()===e.props.file.fq_path:s.selected.last()===e.props.file.file_id,p=c||!s.selected.size&&0===r;if("FileSharedWithMeRow"===e.type)return o.default.createElement(l.FileSharedWithMeRow,{arePostTTIModulesLoaded:t.props.arePostTTIModulesLoaded,file:e.props.file,visibleColumns:t.props.visibleColumns,isCompactMode:e.props.isCompactMode,getOverflowMenuActions:t.props.getOverflowMenuActions,hasResponsiveOverflowMenu:t.props.hasResponsiveOverflowMenu,onOpenFileSharedWithMe:t.props.onOpenFileSharedWithMe,rowIndex:r,rowFocusable:p,topOffset:i,thumbStore:t.props.thumbStore,user:t.props.user,responsive:t.props.responsive,expHighlightedTruncatedString:t.props.expHighlightedTruncatedString,showSnippets:e.props.showSnippets,snippetRows:e.props.snippetRows,height:e.props.height,isSelectMode:e.props.isSelectMode,isSelected:e.props.isSelected,onSelect:t.props.onSelectFile,onDeselect:t.props.onDeselectFile,isFocused:e.props.isFocused,expSelectableFswm:t.props.expSelectableFswm,selectionMethod:t.props.selectionMethod,useSearchSuccessBanner:t.props.useSearchSuccessBanner,filteredContactName:t.props.filteredContactName,logOverflowMenuOpen:t.logOverflowMenuOpen});var f=e.props.file,m=0===r||t.props.user.is_cdm_member&&(2===r||1===r);return o.default.createElement(a.FileRow,{extensionsFeatureFlags:e.props.extensionsFeatureFlags,sharingServiceInfo:e.props.sharingServiceInfo,context:t.props.context,file:f,getOverflowMenuActions:t.props.getOverflowMenuActions,isActiveDropTarget:e.props.isActiveDropTarget,isCheckboxDisabled:e.props.isCheckboxDisabled,
isAvailableDropTarget:e.props.isAvailableDropTarget,isCompactMode:e.props.isCompactMode,isFocused:e.props.isFocused,isSearchMode:e.props.isSearchMode,isSelectMode:e.props.isSelectMode,isSelected:e.props.isSelected,arePostTTIModulesLoaded:e.props.arePostTTIModulesLoaded,isSharingDisabled:e.props.isSharingDisabled,key:f.fq_path,onDeselect:t.props.onDeselectFile,onDragStart:t.props.onDragStart,onDragEnter:t.props.onDragEnter,onLocationLinkClick:t.props.onLocationLinkClick,onNavigateToFileOrFolder:t.handleNavigateToFileOrFolder,onRenameCancel:t.props.onRenameCancel,onRenameSubmit:t.props.onRenameSubmit,onSelect:t.props.onSelectFile,onStarClick:t.props.onStarClick,renameState:e.props.renameState,responsive:t.props.responsive,rowIndex:r,showUserEducationEffects:m,userEducationEffectName:m?"FileNameLabel-"+r:void 0,showCDMUserEducationEffects:n.File.isTeamMemberFolder(f),rowFocusable:p,topOffset:i,user:t.props.user,visibleColumns:t.props.visibleColumns,canDisplayFolderSizes:t.props.canDisplayFolderSizes,thumbStore:t.props.thumbStore,renderSharedWithController:t.props.renderSharedWithController,hrefForFile:t.props.hrefForFile,onShowShare:t.props.onShowShare,onPresentInZoom:t.props.onPresentInZoom,shareButtonLabel:t.props.shareButtonLabel,showShareButton:t.props.showShareButton,expHighlightedTruncatedString:t.props.expHighlightedTruncatedString,hasResponsiveOverflowMenu:t.props.hasResponsiveOverflowMenu,showSnippets:e.props.showSnippets,snippetRows:e.props.snippetRows,height:e.props.height,selectionMethod:t.props.selectionMethod,filteredContactName:t.props.filteredContactName,useSearchSuccessBanner:t.props.useSearchSuccessBanner,expBrowseStickyOverflowMenu:t.props.expBrowseStickyOverflowMenu,logOverflowMenuOpen:t.logOverflowMenuOpen})},t}return r.__extends(t,e),t.prototype.componentDidMount=function(){var e=this.props.onTTI;e&&e(),this.setupKeyboardShortcuts(),this.setupExternalDragHandler()},t.prototype.componentWillUnmount=function(){this.cleanupKeyboardShortcuts(),s.cleanupExternalDragHandler(this.props.keyScope)},t.prototype.cleanupKeyboardShortcuts=function(){c.resetFilesViewKeyboardShortcuts(this.props.keyScope),c.resetFileJumpKeyboardShortcuts(this.props.keyScope)},t.prototype.setupKeyboardShortcuts=function(){var e=this,t=this.props,r=t.user,o=t.onDelete,n=t.onShowRename,i=t.getIsFileJumping,s=t.onAddFileJumpKeyCode,a=t.onResetFileJump,l=t.keyScope,d=t.onCopyToClipboard,u=t.onNavigateToParentFolder,p=t.onPasteFromClipboard;c.setupFileJumpKeyboardShortcuts({user:r,viewType:f.ViewType.List,scope:l,getIsFileJumping:i,onAddFileJumpKeyCode:s,onResetFileJump:a}),c.setupFilesViewKeyboardShortcuts({user:r,viewType:f.ViewType.List,getIsGlobalEvent:this.getIsGlobalEvent(),getIsItemEvent:this.getIsListEvent,getSelectedFiles:this.getSelectedFiles,isCurrentPathWriteable:this.props.getIsCurrentPathWriteable,selectAllAction:S,deselectAllAction:S,onCopyToClipboard:d,onDelete:o,onFocusSearchBar:this.props.onFocusSearchBar,onNavigateToFileOrFolder:function(t){return e.handleNavigateToFileOrFolder(t,{actionSource:f.FilesViewActionSource.KEYBOARD})},onNavigateToParentFolder:u,onPasteFromClipboard:p,onShowRename:n,scope:l,onShowHelpMenu:function(){return e.props.onOpenKeyboardShortcutModal()}})},t.prototype.setupExternalDragHandler=function(){s.setupExternalDragHandler(this.props.keyScope,this.getIsDraggingInternalFiles,this.getIsDraggingExternalFiles,this.props.onSetFileUploaderPath,".brws-file-row",this.getActiveDropTarget,this.props.onSetDropTarget)},t.prototype.getIsGlobalEvent=function(){return function(){return!0}},t.prototype.render=function(){var e=this.props,t=e.scrollPositionOffset,r=e.viewportTopOffset,n=e.focusedFileIndex,s=e.onRangeInView,a=e.scrollContainer,l=p.getFilesViewListRowItemsAndHeights(this.props),c=l.rowItems,d=l.heights;return o.default.createElement(i.CulledTableBodyWithScrollContainer,{items:c,listItemHeight:d,renderRow:this.renderRow,scrollPositionOffset:t,scrollToRow:n,shouldUseWindowAsScrollContainer:!0,viewportTopOffset:r,onRangeInView:s,scrollContainer:a})},t.defaultProps={isFileViewerShown:function(){return!1},selectionMethod:f.SelectionMethod.CHECKBOX},t})(o.default.PureComponent);t.FilesViewList=g}),define("modules/clean/react/files_view/new_folder_row",["require","exports","tslib","spectrum/media_table","spectrum/table","react","spectrum/icon_content","modules/clean/react/files_view/name_input","modules/core/i18n"],function(e,t,r,o,n,i,s,a,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=r.__importDefault(i),t.NewFolderRow=function(e){var r,s=e.createNewFolderState,c=e.isInsideMyTeamFolderTree,d=void 0!==c&&c,u=e.onCancel,p=e.onSubmit,f=e.rowIndex,_=e.topOffset;r="SAVING_INPUT"===s?i.default.createElement("p",{className:"brws-new-folder-row-status",role:"status","aria-live":"polite"},l._("Creating new folder…")):i.default.createElement(a.NameInput,{defaultValue:"",label:l._("Folder name"),onSubmit:p,onCancel:u});var m=i.default.createElement(t.NewFolderIcon,{isInsideMyTeamFolderTree:d});return i.default.createElement(o.CulledMediaRow,{"aria-rowindex":void 0!==f?f+1:void 0,className:"brws-new-folder-row",topOffset:_},i.default.createElement(n.TableCell,{className:"brws-checkbox-cell"}),i.default.createElement(o.MediaCell,{icon:m},i.default.createElement("div",{className:"brws-new-folder-row-content brws-vertically-center"},r)),i.default.createElement(n.TableCell,null),i.default.createElement(n.TableCell,null))},t.NewFolderIcon=function(e){var t=e.isInsideMyTeamFolderTree,r=e.className||"";return i.default.createElement(s.IconContent,{className:r,name:t?"folder_team-small":"folder-small"})}}),define("modules/clean/react/files_view/paper_row",["require","exports","tslib","external/classnames","react","retrieval-components/highlighted-truncated-string","spectrum/media_table","spectrum/util/raf_throttle","modules/clean/emoji_utils","modules/clean/filename_highlights","modules/clean/paper_formatting_utils","modules/clean/react/files_view/double_click","modules/clean/react/files_view/file_snippets","modules/clean/react/files_view/star","modules/clean/react/files_view/types","modules/clean/react/files_view/util","modules/core/browser","modules/core/i18n"],function(e,t,r,o,n,i,s,a,l,c,d,u,p,f,_,m,h,S){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),n=r.__importDefault(n),l=r.__importStar(l),d=r.__importStar(d),h=r.__importStar(h);var g=(function(e){function t(t){var r=e.call(this,t)||this;return r.setRef=function(e){r.brwsFilenameContainerDiv=e},r.handleWindowResize=function(){r.throttledWindowResize.request()},r.handleResize=function(){if(r.brwsFilenameContainerDiv){var e=r.state.brwsFilenameContainerDivWidth,t=r.brwsFilenameContainerDiv.getBoundingClientRect().width;t&&t!==e&&r.setState({brwsFilenameContainerDivWidth:t})}},r.handleOpenNewTabOrNavigate=function(e){if(0===e.button){e.preventDefault(),e.stopPropagation();var t=r.props.paper;if(m.hasModifierKey(e))return void h.open_tab(t.url);r.props.onOpenPaper(t)}},r.throttledWindowResize=new a.RafThrottle(function(){return r.handleResize()}),r.state=r.calcState(t),r}return r.__extends(t,e),t.prototype.componentWillReceiveProps=function(e){if(this.props.paper.title!==e.paper.title||this.props.paper.highlight_spans!==e.paper.highlight_spans){var t=this.calcState(e);this.setState(t)}},t.prototype.componentDidMount=function(){this.handleResize(),window.addEventListener("resize",this.handleWindowResize)},t.prototype.componentWillUnmount=function(){window.removeEventListener("resize",this.handleWindowResize)},t.prototype.calcState=function(e){return{titleParts:d.getPaperDocTitleParts(e.paper,"brws-file-name-cell-icon","brws-file-name-cell-icon-emoji")}},t.prototype.getHighlightedSpansForHighlightedTruncatedString=function(e){var t=e.title,r=e.highlight_spans,o=e.title_highlights,n=r&&r.length>0,i=l.getFirstEmojiFromTitle(t);if(n){if(i){r=[{highlight_str:r[0].highlight_str.substr(i.length),is_highlighted:r[0].is_highlighted}].concat(r.slice(1))}return r.map(function(e){return{string:e.highlight_str,isHighlighted:e.is_highlighted}})}if(o){if(i){t=t.substr(i.length);var s=i.length/2;o=o.slice().map(function(e){return{pos:e.pos-s,len:e.string.length,string:e.string}})}return c.highlightMatchSections(t,o).map(function(e){return{string:e.text,isHighlighted:e.isHighlighted}})}},t.prototype.renderTitleElement=function(e){var t=this.props,r=t.paper,o=t.showHighlights,s=t.expHighlightedTruncatedString,a=this.state.titleParts,l=a.title,c=a.highlightedTitle;if(s){if(e){var d=n.default.createElement(i.HighlightedTruncatedString,{text:l,className:"brws-file-name-element",fontSize:14,highlightSpans:this.getHighlightedSpansForHighlightedTruncatedString(r),cellBuffer:3,availableWidth:e});return n.default.createElement("a",{className:"brws-paper-doc-name-cell-title",href:r.url,onClick:this.handleOpenNewTabOrNavigate},o?d:n.default.createElement("span",null,l))}return null}return n.default.createElement("a",{className:"brws-paper-doc-name-cell-title",href:r.url,onClick:this.handleOpenNewTabOrNavigate},o?c:n.default.createElement("span",null,l))},t.prototype.renderPaperCellContent=function(e,t){var r=this.props,o=r.paper,i=r.user,a=r.arePostTTIModulesLoaded,l=r.showSnippets,c=r.snippetRows,d=a?n.default.createElement(f.StarContainer,{item:o,user:i,key:"paperStar",className:"brws-file-name-cell-star"}):null;return n.default.createElement("div",{className:"brws-paper-doc-name-cell-content brws-vertically-center"},n.default.createElement("div",{className:"brws-paper-doc-name-cell-title-container"},n.default.createElement(s.MediaCellText,{highlight:e},this.renderTitleElement(t)),d),n.default.createElement(s.MediaCellText,{highlight:e,variant:"subtitle"},S._("in Paper",{comment:"The Dropbox Paper page"})),l&&n.default.createElement(s.MediaCellText,{highlight:e,key:"snippets",variant:"subtitle"},n.default.createElement(p.FileSnippets,{snippets:o.snippets,lineClamp:c})))},t.prototype.renderDocName=function(e){var t=this.props,o=t.expHighlightedTruncatedString,i=t.height,a=this.state.titleParts.icon,l={highlight:e,icon:a,style:{minHeight:i-1}};if(o){var c=this.state.brwsFilenameContainerDivWidth;return n.default.createElement(s.MediaCell,r.__assign({key:"docName"},l),n.default.createElement("div",{className:"brws-file-name-container",ref:this.setRef},this.renderPaperCellContent(e,c)))}return n.default.createElement(s.MediaCell,r.__assign({key:"docName"},l),this.renderPaperCellContent(e))},t.prototype.renderDocInfo=function(){var e=this.props.paper,t=e.last_modified_date||"",r=S._("by %(modified_by)s",{comment:"name of the person that modified the file"}).format({modified_by:e.last_editor_name||e.creator_name});return n.default.createElement(s.MediaCell,{key:"docInfo",subtitle:r,title:t})},t.prototype.renderCell=function(e){var t=e.isHovered,r=e.sortField;switch(r){case _.SortField.FILENAME:return this.renderDocName(t);case _.SortField.RELEVANCE:case _.SortField.MODIFIED:return this.renderDocInfo();default:return n.default.createElement(s.MediaCell,{key:r,title:n.default.createElement("span",{"aria-hidden":!0},"--")})}},t.prototype.render=function(){var e=this,t=this.props,r=t.rowIndex,i=t.topOffset,a=t.visibleColumns,l=t.selectionMethod,c=o.default("brws-paper-row",{"brws-row-click-selection-method":l===_.SelectionMethod.CLICK}),d=l===_.SelectionMethod.CLICK?this.handleOpenNewTabOrNavigate:void 0,p=l===_.SelectionMethod.CLICK?function(){}:this.handleOpenNewTabOrNavigate;return n.default.createElement(u.WithDoubleClick,{onClick:p,onDoubleClick:d},function(t){var o=t.onClick;return n.default.createElement(s.CulledMediaRow,{"aria-rowindex":void 0!==r?r+1:void 0,className:c,draggable:!1,onClick:o,topOffset:i,variant:"default"},function(t){var r=t.isHovered;return[n.default.createElement(s.MediaCell,{key:"checkboxCell",className:"brws-checkbox-cell"})].concat(a.map(function(t){return e.renderCell({isHovered:r,sortField:t.sortField})}))})})},t.defaultProps={showHighlights:!0},t})(n.default.PureComponent);t.PaperRow=g}),define("modules/clean/react/files_view/pinned_team_folder_view",["require","exports","tslib","external/classnames","react","spectrum/table","modules/clean/browse_uri_interface","modules/clean/react/browse/models","modules/clean/react/files_view/constants","modules/clean/react/files_view/file_list_utils","modules/clean/react/files_view/file_row","modules/clean/react/files_view/types","modules/clean/react/sprite","modules/clean/react/tooltip","modules/clean/user_education/react/user_education_effect","modules/clean/user_education/user_education_client","modules/constants/trademark","modules/core/i18n"],function(e,t,r,o,n,i,s,a,l,c,d,u,p,f,_,m,h,S){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),n=r.__importDefault(n);var g=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.displayName="PinnedTeamFolderView",t.renderTeamFolderRow=function(e,r){var o=t.props,i=o.activeDropTarget,u=o.context,p=o.dropTargetHighlightMode,f=o.getOverflowMenuActions,m=o.onDragEnter,h=o.onNavigateToFileOrFolder,S=o.onRenameCancel,g=o.onRenameSubmit,v=o.user,E=o.arePostTTIModulesLoaded,w=o.thumbStore,b=o.onShowShare,T=o.renderSharedWithController,F=o.selectionMethod,y=c.shouldFileBeHighlightedDropTarget({dropTargetHighlightMode:p,file:e,isSelected:!1}),C=n.default.createElement(d.FileRow,{context:u,file:e,getOverflowMenuActions:f,key:encodeURI(e.fq_path),isAvailableDropTarget:y,isActiveDropTarget:e===i,isPinned:!0,arePostTTIModulesLoaded:E,onDragEnter:m,onNavigateToFileOrFolder:h,onRenameCancel:S,onRenameSubmit:g,showUserEducationEffects:0===r,showCDMUserEducationEffects:a.File.isTeamMemberFolder(e),user:v,visibleColumns:l.LIST_VIEW_COLUMNS.slice(0,1),canDisplayFolderSizes:!1,thumbStore:w,onShowShare:b,renderSharedWithController:T,hrefForFile:s.href_for_file,selectionMethod:F});return r>0?C:n.default.createElement(_.UserEducationEffect,{containerName:"PinnedTeamFolder",name:"TeamFolder",key:encodeURI(e.fq_path)+"-UserEducationEffect"},C)},t}return r.__extends(t,e),t.prototype.componentDidMount=function(){m.UEClient.sendEvent(this.displayName,"componentDidMount",JSON.stringify(this.props.context))},t.prototype.renderHeaderTitle=function(e,t){var r=t?n.default.createElement("div",{className:"brws-pinned-team-folder-info-button"},n.default.createElement(f.Tooltip,{position:f.TooltipPosition.RIGHT,tooltip_contents:n.default.createElement("div",null,t),tooltip_classname:"brws-pinned-team-folder-tooltip"},n.default.createElement(p.Sprite,{group:"web",name:"info",alt:S._("File section information")}))):null;return n.default.createElement("div",{className:"brws-pinned-team-folder-header-title-button-group"},n.default.createElement("h2",{className:"brws-pinned-team-folder-header-title"},e),r)},t.prototype.render=function(){var e=this.props,t=e.columnFlex,r=e.isCompactMode,s=e.teamFolders,a=S.ungettext("Team folder","Team folders",s.size);return n.default.createElement("div",{className:"brws-pinned-team-folder-view"},n.default.createElement(i.Table,{columnFlex:t},n.default.createElement(i.TableHead,{className:o.default("brws-column-header","brws-pinned-team-folder-header",{"brws-column-header-compact brws-pinned-team-folder-header-compact ":r})},n.default.createElement(i.TableHeadCell,{className:"brws-checkbox-cell"}),n.default.createElement(i.TableHeadCell,{className:"brws-vertically-center"},this.renderHeaderTitle(a,S._("Team folders are the hub of content for a team and contents are                 automatically shared with team folder members. %(trademark_business)s                 team admins own and manage team folders.").format({trademark_business:h.TRADEMARK_BUSINESS})))),n.default.createElement(i.TableBody,null,s.map(this.renderTeamFolderRow))),n.default.createElement(i.Table,{columnFlex:t},n.default.createElement(i.TableHead,{className:o.default("brws-column-header","brws-pinned-team-folder-header","brws-pinned-team-folder-header-secondary",{"brws-column-header-compact brws-pinned-team-folder-header-compact ":r})},n.default.createElement(i.TableHeadCell,{className:"brws-checkbox-cell"}),n.default.createElement(i.TableHeadCell,{className:"brws-vertically-center"},this.renderHeaderTitle(S._("Everything else"))))))},t.defaultProps={selectionMethod:u.SelectionMethod.CHECKBOX},t})(n.default.Component);t.PinnedTeamFolderView=g}),define("modules/clean/react/files_view/scroll_updater",["require","exports","tslib","external/react-redux","react","modules/clean/react/files_view/data/selectors"],function(e,t,r,o,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importDefault(n),i=r.__importStar(i);var s=function(e){return{currentScroll:i.currentScroll(e)}},a=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.componentDidMount=function(){this.updateScroll()},t.prototype.componentDidUpdate=function(e){var t=e.currentScroll,r=e.path;t!==this.props.currentScroll?this.updateScroll():r!==this.props.path&&this.scrollTo(0)},t.prototype.updateScroll=function(){var e=this.props.currentScroll;if(e){var t=e.scrollTop;this.scrollTo(t)}},t.prototype.scrollTo=function(e){var t=this.props.scrollContainer;t&&t.current?t.current.scrollTop=e:window.scrollTo(0,e)},t.prototype.render=function(){return null},t})(n.default.Component);t.ScrollUpdater=o.connect(s)(a)}),define("modules/clean/react/files_view/selectors",["require","exports","tslib","external/reselect","modules/clean/react/browse/models","modules/clean/react/files_view/constants","modules/clean/react/files_view/file_list_utils"],function(e,t,r,o,n,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){return{activeDropTarget:e.activeDropTarget,arePostTTIModulesLoaded:e.arePostTTIModulesLoaded,canDisplayFolderSizes:e.canDisplayFolderSizes,context:e.context,createNewFolderState:e.createNewFolderState,dropTargetHighlightMode:e.dropTargetHighlightMode,extensionsFeatureFlags:e.extensionsFeatureFlags,fileRename:e.fileRename,focusedFileIndex:e.focusedFileIndex,isCheckboxDisabled:e.disabledMultiselect,isCompactMode:e.isCompactMode,isSearchMode:e.isSearchMode,isSelectMode:e.isSelectMode,items:e.items,selection:e.selection,sharingServiceInfo:e.sharingServiceInfo,starredState:e.starredState,user:e.user,visibleColumns:e.visibleColumns,responsive:e.responsive,expSnippets:e.expSnippets,containerWidth:e.containerWidth,highDensity:e.highDensity}},l=function(e,t){return Object.keys(e).length===Object.keys(t).length&&Object.keys(e).every(function(r){return t.hasOwnProperty(r)&&e[r]===t[r]})},c=o.createSelectorCreator(o.defaultMemoize,l);t.getFilesViewListRowItems=c(a,function(e){var o=e.activeDropTarget,a=e.context,l=e.createNewFolderState,c=e.dropTargetHighlightMode,d=e.items,u=e.fileRename,p=e.focusedFileIndex,f=e.selection,_=e.user,m=e.visibleColumns,h=e.responsive,S=e.expSnippets,g=e.containerWidth,v=e.highDensity,E=r.__rest(e,["activeDropTarget","context","createNewFolderState","dropTargetHighlightMode","items","fileRename","focusedFileIndex","selection","user","visibleColumns","responsive","expSnippets","containerWidth","highDensity"]),w=d.toArray().map(function(e,l){if(e instanceof n.UserDefinedItem)return{type:"UserDefinedItemRow",props:{userDefinedItem:e},height:v?i.DEFAULT_ROW_HEIGHT_DENSE:i.DEFAULT_ROW_HEIGHT};var d=g?g*i.FILE_NAME_CELL_WITH_SNIPPETS_FLEX_BASIS[m.length]/100:void 0,w=t.shouldShowSnippets({file:e,expSnippets:S,responsive:h}),b=t.estimateSnippetRowsNeeded({snippets:e.snippets,fileNameCellWidth:d}),T=t.getFileRowHeight({file:e,showSnippets:w,snippetRows:b,highDensity:v});if(e instanceof n.Paper)return{type:"PaperRow",props:{isSearchMode:E.isSearchMode,paper:e,visibleColumns:m,arePostTTIModulesLoaded:E.arePostTTIModulesLoaded,showSnippets:w,snippetRows:b,height:T},height:T};var F="fq_path"in e?e.fq_path:e.file_id,y=f.selected.has(F);if(e instanceof n.FileSharedWithMe)return{type:"FileSharedWithMeRow",props:{file:e,visibleColumns:m,showSnippets:w,snippetRows:b,height:T,isSelected:y,arePostTTIModulesLoaded:E.arePostTTIModulesLoaded,isSelectMode:E.isSelectMode,isFocused:l===p},height:T};var C=s.shouldFileBeHighlightedDropTarget({file:e,isSelected:y,dropTargetHighlightMode:c});return{type:"FileRow",props:r.__assign({},E,{file:e,isActiveDropTarget:C&&o===e,isAvailableDropTarget:C,isFocused:l===p,isSelected:y,isSharingDisabled:s.isSharingDisabledForFile({context:a,file:e,user:_}),renameState:u&&u.file.fq_path===e.fq_path?u.state:void 0,visibleColumns:m,showSnippets:w,snippetRows:b,height:T}),height:T}});return l&&"CREATE_FOLDER_INACTIVE"!==l&&w.unshift({type:"NewFolderRow",props:{createNewFolderState:l,isInsideMyTeamFolderTree:a.isInsideTeamFolderTree},height:v?i.DEFAULT_ROW_HEIGHT_DENSE:i.DEFAULT_ROW_HEIGHT}),w}),t.getFilesViewListRowItemsAndHeights=o.createSelector(t.getFilesViewListRowItems,function(e){return{rowItems:e,heights:e.map(function(e){return e.height})}}),t.getItemIds=o.createSelector(function(e){return e.items},function(e){return e.toArray().map(function(e){return e.fq_path||e.file_id})}),t.getFirstValidSnippet=function(e){return e.find(function(e){var t=e.highlight_spans;return!!t&&t.length>0})},t.shouldShowSnippets=function(e){var r=e.file.snippets,o=e.expSnippets,n=void 0!==o&&o,i=e.responsive;return!!n&&!!r&&!!t.getFirstValidSnippet(r)&&(i.isMatchedLarge||i.isMatchedMedium)},t.getFileRowHeight=function(e){var t=e.file,r=e.showSnippets,o=e.snippetRows,n=e.highDensity;return t.snippets&&r?o?i.ROW_VERTICAL_PADDING+i.ROW_TITLE_HEIGHT+i.ROW_SUBTITLE_HEIGHT+i.ROW_SNIPPET_VERTICAL_MARGIN+i.SNIPPET_HEIGHT_PER_ROW*o:i.DEFAULT_ROW_HEIGHT_WITH_SNIPPETS:n?i.DEFAULT_ROW_HEIGHT_DENSE:i.DEFAULT_ROW_HEIGHT};t.estimateSnippetRowsNeeded=function(e){var r=e.snippets,o=e.fileNameCellWidth;if(!r)return 0;var n=t.getFirstValidSnippet(r);if(!n||!n.highlight_spans)return 0;if(!o)return 3;var s=n.highlight_spans.map(function(e){return e.highlight_str}).join().length,a=Math.max(o-i.MEDIA_CELL_ICON_WIDTH-i.SNIPPET_HORIZONTAL_PADDING,1),l=6*s;return Math.min(Math.ceil(l/a),3)}}),define("modules/clean/react/files_view/share_button",["require","exports","tslib","spectrum/button","react","modules/clean/react/retrieval_success_banner/util","modules/core/i18n","modules/clean/react/extensions/data/types"],function(e,t,r,o,n,i,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importDefault(n);var l=(function(t){function l(){var o=null!==t&&t.apply(this,arguments)||this;return o.handleClick=function(t){return r.__awaiter(o,void 0,void 0,function(){var o,n,s,l,c,d;return r.__generator(this,function(u){switch(u.label){case 0:return this.props.useSearchSuccessBanner&&this.props.isSearchMode&&i.setSearchSuccessBannerVisible(),t.preventDefault(),o=this.props,n=o.file,s=o.onShowShare,s(n,"BROWSE_FILE_ROW"),t.stopPropagation(),[4,new Promise(function(t,r){e(["modules/clean/react/app_actions/telemetry_client"],t,r)}).then(r.__importStar)];case 1:return l=u.sent(),c=l.createTelemetryClient,d=l.getPiiSafeExtension,c({component:"share-btn"}).session({surface:this.props.isSearchMode?"search":"browse",ext:d(this.props.file.ext)}).event("click_share",{trigger_type:a.TriggerType.PrimaryButton}),[2]}})})},o}return r.__extends(l,t),l.prototype.render=function(){var e=this.props,t=e.isVisible,r=e.shareButtonLabel,i=e.showShareButton;return n.default.createElement(o.Button,{"aria-label":r,className:"inline-share-button",onClick:this.handleClick,tabIndex:t&&i?void 0:-1,variant:t&&i?"secondary":"invisible"},r)},l.defaultProps={isVisible:!0,shareButtonLabel:s._("Share"),showShareButton:!0},l})(n.default.PureComponent);t.ShareButton=l}),define("modules/clean/react/files_view/sticky_table_head",["require","exports","tslib","spectrum/dimensions","spectrum/table","react","modules/clean/react/sticky/sticky","modules/clean/react/sticky/container"],function(e,t,r,o,n,i,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i=r.__importDefault(i),t.StickyTableHead=function(e){var t=e.children,l=e.columnFlex,c=e.offsetHeight,d=e.offsetTop,u=r.__rest(e,["children","columnFlex","offsetHeight","offsetTop"]);return i.default.createElement("thead",{className:"brws-sticky-table-head"},i.default.createElement(o.Dimensions,{tagName:"tr"},function(e){var o=e.width;return i.default.createElement("td",{className:"brws-sticky-table-cell"},i.default.createElement(a.StickyContainer,{offsetTop:d,useNativeSticky:!0,useWindowToDetermineBottom:!0},i.default.createElement(s.Sticky,{offsetHeight:c},i.default.createElement(n.Table,{columnFlex:l,style:{width:o}},i.default.createElement(n.TableHead,r.__assign({},u),t)))))}))}}),define("modules/clean/react/files_view/user_defined_item_row",["require","exports","tslib","react"],function(e,t,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o);var n=(function(e){function t(t){return e.call(this,t)||this}return r.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.rowIndex,r=e.topOffset;return e.userDefinedItem.renderUserDefinedItemRow({rowIndex:t,topOffset:r})},t})(o.default.PureComponent);t.UserDefinedItemRow=n}),define("modules/clean/react/files_view/view_type_column_header_menu",["require","exports","tslib","react","spectrum/icon_form","spectrum/icon_mode","spectrum/popover","modules/clean/react/files_view/types","modules/core/i18n"],function(e,t,r,o,n,i,s,a,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o);var c=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleSelection=function(e){e!==t.props.viewType&&t.props.onSwitchViewType(e)},t}return r.__extends(t,e),t.prototype.componentDidMount=function(){this.props.onTTI()},t.prototype.viewTypeIcon=function(e){switch(e){case a.ViewType.List:return"list";case a.ViewType.Grid:return"grid";case a.ViewType.LargeGrid:return"tiles"}return"list"},t.prototype.viewTypeLabel=function(e){switch(e){case a.ViewType.List:return l._("Layout: List");case a.ViewType.Grid:return l._("Layout: Grid");case a.ViewType.LargeGrid:return l._("Layout: Large Grid")}return l._("Layout: List")},t.prototype.render=function(){var e=this,t=this.props,r=t.viewType,a=t.viewTypes,c=t.viewTypeLabels;return 1===a.length?null:o.default.createElement(s.Popover,{className:"brws-view-type-column-header-menu",onSelection:this.handleSelection,closeOnSelection:!0},o.default.createElement(s.PopoverTrigger,{className:"brws-view-type-column-header-menu-trigger","aria-label":l._("Select view type")},o.default.createElement(i.IconMode,{name:this.viewTypeIcon(r)}),o.default.createElement(n.IconForm,{name:"caret-down"})),o.default.createElement(s.PopoverContent,{attachment:"right",className:"brws-view-type-column-header-menu-content"},o.default.createElement(s.PopoverItemGroup,null,o.default.createElement(s.PopoverItemGroupTitle,null,l._("View As")),a.map(function(t){return o.default.createElement(s.PopoverSelectableItem,{"data-viewtype":t,key:t,icon:o.default.createElement(i.IconMode,{name:e.viewTypeIcon(t)}),selected:r===t,value:t,"aria-label":e.viewTypeLabel(t)},c[t])}))))},t})(o.default.PureComponent);t.ViewTypeColumnHeaderMenu=c});var __importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};define("modules/clean/react/folder_dialog/async",["require","exports","modules/clean/css"],function(e,t,r){"use strict";function o(t){new Promise(function(t,r){e(["modules/clean/react/folder_dialog/folder_dialog"],t,r)}).then(__importStar).then(function(e){return e.FolderDialog.show(t)})}function n(){new Promise(function(t,r){e(["modules/clean/react/folder_dialog/folder_dialog"],t,r)}).then(__importStar).then(function(){r.require_css("/static/css/react/folder_picker-vflv6X0zc.css")})}Object.defineProperty(t,"__esModule",{value:!0}),t.showFolderDialog=o,t.prewarmFolderDialog=n}),define("modules/clean/react/folder_overview/api",["require","exports","modules/clean/api_v2/user_client"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=new r.UserApiV2Client;t.getDescription=function(e,t){return o.ns("files").rpc("get_description_batch",{file_ids:[t]},{subjectUserId:e}).then(function(e){if(!e||!e.items||1!==e.items.length)throw new Error("Unexpected response from get_description_batch");return e.items[0]})},t.setDescription=function(e,t,r,n,i){return o.ns("files").rpc("set_description",{file_id:t,current_revision_id:r,text:n,format_version:i},{subjectUserId:e})},t.getContentReferences=function(e,t){return o.ns("files").rpc("get_content_references_info",{file_id:t},{subjectUserId:e})},t.removeContentReferences=function(e,t,r){return o.ns("files").rpc("remove_content_references",{anchor_file_id:t,return_roots_as_ns_ids:!0,file_ids:r},{subjectUserId:e})},t.addContentReferences=function(e,t,r){return o.ns("files").rpc("add_content_references",{anchor_file_id:t,return_roots_as_ns_ids:!0,file_ids:r},{subjectUserId:e})},t.addContentReferencesToPath=function(e,t,r){return o.ns("files").rpc("add_content_references_to_path",{path:t,return_roots_as_ns_ids:!0,file_ids:r},{subjectUserId:e})},t.getFolderAccess=function(e){var t=e.userId,r=e.sharedFolderId,n=e.accountId,i=e.accountEmail;return o.ns("folder_overview").rpc("has_folder_access",{shared_folder_id:r,account_id:n,account_email:i},{subjectUserId:t})},t.getSharedFolderPath=function(e){var t=e.userId,r=e.sharedFolderId;return o.ns("files").rpc("get_metadata",{path:"ns:"+r},{subjectUserId:t}).then(function(e){return e.is_shareable?e.path_display:void 0})},t.getLoggingFileId=function(e){var t=e.userId,r=e.path;return o.ns("files").rpc("get_metadata",{path:r},{subjectUserId:t}).then(function(e){return e.id})},t.isConflictError=function(e){return e.error&&e.error.status&&"conflict"===e.error.status[".tag"]},t.isFormatVersionError=function(e){return e.error&&e.error.status&&"bad_format_version"===e.error.status[".tag"]},t.getUserAccount=function(e){var t=e.userId,r=e.accountId;return o.ns("users").rpc("get_account",{account_id:r},{subjectUserId:t})}}),define("modules/clean/react/folder_overview/async_components",["require","exports","tslib","react","modules/clean/react/async/loadable","modules/clean/react/folder_overview/placeholder"],function(e,t,r,o,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),t.AsyncFolderOverviewDescription=n.Loadable({loader:function(){return new Promise(function(t,r){e(["modules/clean/react/folder_overview/description"],t,r)}).then(r.__importStar).then(function(e){return e.FolderOverviewDescription})},loading:function(e){return o.default.createElement(i.WrappedFolderOverviewPlaceholder,{showExamples:e.showExamplesInPlaceholder,isReadOnly:e.isReadOnly,showExamplesAsButton:"V3"===e.expFolderOverview})}}),t.AsyncFolderOverviewContentReferences=n.Loadable({loader:function(){return new Promise(function(t,r){e(["modules/clean/react/folder_overview/content_references"],t,r)}).then(r.__importStar).then(function(e){return e.FolderOverviewContentReferences})}}),t.AsyncFolderOverviewLastEdit=n.Loadable({loader:function(){return new Promise(function(t,r){e(["modules/clean/react/folder_overview/last_edit"],t,r)}).then(r.__importStar).then(function(e){return e.FolderOverviewLastEdit})}}),t.asyncShowOverviewExamples=function(){new Promise(function(t,r){e(["modules/clean/react/folder_overview/examples_modal"],t,r)}).then(r.__importStar).then(function(e){return e.OverviewExamplesModal.show()})},t.asyncShowPinToModal=function(t){new Promise(function(t,r){e(["modules/clean/react/folder_overview/pin_to_modal"],t,r)}).then(r.__importStar).then(function(e){return e.FolderOverviewPinToModal.show(t)})}}),
define("modules/clean/react/folder_overview/connected",["require","exports","tslib","external/react-redux","react","modules/clean/react/browse/data/selectors","modules/clean/react/browse/logger","modules/clean/react/css","modules/clean/react/folder_overview/controller","modules/clean/react/folder_overview/data/action_creators","modules/clean/react/folder_overview/data/selectors","modules/clean/react/folder_overview/data/store","modules/clean/react/folder_overview/logging"],function(e,t,r,o,n,i,s,a,l,c,d,u,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importDefault(n),i=r.__importStar(i),c=r.__importStar(c);var f=u.getStoreForFolderOverview(),_=d.makeSelectors();s.browseLogger.registerRowInjector(function(){var e=f.getState(),t=i.path(e),r=p.extractNsIdAndPath(_.folderNsId(e,{path:t})),o=r.nsPath,n=r.nsId;return{extra:{in_folder_with_overview:_.doesFolderOverviewExist(e,{path:t})?"1":"0",folder_file_id:_.folderFileId(e,{path:t})||null,ns_id:n||null,resource_namespace_path:p.hashPath(o)}}});var m=function(){return function(e,t){return{user:i.user(e),haveAllComponentsLoaded:_.haveAllComponentsLoaded(e,t),hasFailedToLoad:!!_.hasFailedToLoad(e,t),loadedComponents:_.loadedComponents(e,t)||[],folderFileId:_.folderFileId(e,t),folderNsId:_.folderNsId(e,t),isOpen:!_.isCollapsed(e,t),descriptionBaseRevision:_.descriptionBaseRevision(e,t),descriptionFormatValid:_.descriptionFormatValid(e,t),doesFolderOverviewExist:_.doesFolderOverviewExist(e,t),descriptionHasFocus:_.descriptionHasFocus(e,t)}}},h={updateFolderData:c.updateFolderDataCache,saveFolderData:c.saveFolderPreferences,addLoadedComponent:c.addLoadedComponent,removeLoadedComponent:c.removeLoadedComponent,fetchDataForFolder:c.fetchDataForFolder,reloadDescription:c.reloadDescription,reloadContentReferences:c.reloadContentReferences},S=o.connect(m,h)(l.FolderOverviewController),g=function(e){return n.default.createElement(o.Provider,{store:f},n.default.createElement(S,r.__assign({},e)))};t.FolderOverview=a.requireCssWithComponent(g,["/static/css/browse/folder_overview-vflGIgHnV.css","/static/js/comments2/index.web-vflARkr3t.css","/static/js/retrieval-components/index.web-vflEwNrla.css"])}),define("modules/clean/react/folder_overview/constants",["require","exports","tslib","modules/clean/react/comments2/components/comments_translations","modules/core/i18n"],function(e,t,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DATA_CACHE_TTL_MS=3e4,t.DESCRIPTION_PLACEHOLDER=n._("Click here to describe this folder and turn it into a Space"),t.DESCRIPTION_PLACEHOLDER_EXAMPLES_BUTTON=n._("Show examples"),t.DESCRIPTION_PLACEHOLDER_READ_ONLY=n._("To edit this overview, ask the folder admin for access"),t.FOLDER_EXAMPLES_LINK_LABEL=n._("Show examples"),t.FOLDER_EXAMPLES_LINK_URI="https://www.dropbox.com/help/desktop-web/folder-overviews",t.ERROR_DESCRIPTION_CONFLICT=n._("Can’t save changes. Paste text elsewhere to save, then click Refresh."),t.ERROR_DESCRIPTION_FORMAT_VERSION=n._("Can’t save changes. Reload the page and try again."),t.ERROR_DESCRIPTION_SAVE=n._("Can’t save changes."),t.ERROR_SHARE_PERSONAL_FOLDER=n._("Can’t @mention someone in your Personal Dropbox."),t.ERROR_SHARE_MEMBER_FOLDER=n._("Can’t @mention someone in your member folder."),t.ERROR_SHARE_NO_PERMISSION=n._("You don’t have permission to share this folder."),t.DESCRIPTION_SAVE_DELAY_MS=3e3,t.DESCRIPTION_SAVE_ERROR_DELAY_MS=10*t.DESCRIPTION_SAVE_DELAY_MS,t.OPT_KEY=n._("opt",{comment:"'opt' refers to the option key on the keyboard. This string is used to create labels for shortcuts."}),t.ALT_KEY=n._("alt",{comment:"'alt' refers to the alt key on the keyboard. This string is used to create labels for shortcuts."}),t.CTRL_KEY=n._("ctrl",{comment:"'ctrl' refers to the ctrl key on the keyboard. This string is used to create labels for shortcuts."}),t.CMD_KEY=n._("⌘",{comment:"'⌘' refers to the ⌘ key on the keyboard. This string is used to create labels for shortcuts."}),t.FOLDER_OVERVIEW_EDITOR_STRINGS=r.__assign({},o.commentsMasterLocalization,{searchingMsg:n._("@mention someone to share this folder"),folderOverviewToolbar:{boldMsg:n._("Bold"),italicMsg:n._("Italic"),strikeThroughMsg:n._("Strikethrough"),mentionMsg:n._("Mention someone"),orderedListMsg:n._("Start numbered list"),unorderedListMsg:n._("Start bulleted list"),linkMsg:n._("Create link"),taskMsg:n._("Create to-do"),onboardingMsg:n._("Folder examples"),mentionShortcutMsg:n._("@someone",{comment:"used in a tooltip to tell the user that they can mention someone by typing the '@'     character followed by the name of a user. In english, the tooltip will display just '@someone'"}),spaceKey:n._("space",{comment:"'space' refers to the spacebar key on the keyboard. This string is used to create labels for     shortcuts e.g. '@ + space' to insert a mention"}),doneMsg:n._("Done",{comment:"Button to close the editor toolbar"})},folderOverviewSharePopover:{cancelLabel:n._("Cancel"),continueLabel:n._("Continue"),shareTitle:function(e){return e?n._("Share folder with %(user_name)s?").format({user_name:e}):""},shareMessage:function(e,t){return e&&t?n._("%(user_name)s is not yet a member of “%(folder_name)s”. If you don’t share this folder,             they won’t be able to view its content").format({folder_name:t,user_name:e}):""}},folderOverviewTaskPlaceholder:n._("Set a task and assign @someone"),a11yFolderOverviewLabel:n._("Type notes, list, to-dos, and links here")}),t.FOLDER_OVERVIEW_EDITOR_EDITING=n._("Everyone in this folder can see notes, tasks, and pinned items"),t.SHARING_MODAL_MESSAGE_SAME_FOLDER=n._("Hi %(user_name)s, I @mentioned you in this folder. Take a look."),t.SHARING_MODAL_MESSAGE_PARENT_FOLDER=n._("Hi %(user_name)s, I @mentioned you in the %(folder_name)s folder. Take a look."),t.SHARING_MODAL_MESSAGE_SAME_FOLDER_NO_NAME=n._("I @mentioned you in this folder. Take a look."),t.SHARING_MODAL_MESSAGE_PARENT_FOLDER_NO_NAME=n._("I @mentioned you in the %(folder_name)s folder. Take a look."),t.DESCRIPTION_VERSION=[1,0,1],t.PIN_TO_SUCCESS_SINGLE=n._("Pinned %(file)s to %(path)s"),t.PIN_TO_SUCCESS_MULTIPLE=n._("Pinned %(num)d files to %(path)s"),t.PIN_TO_MODAL_TITLE_SINGLE=n._("Pin “%(name)s” to..."),t.PIN_TO_MODAL_TITLE_MULTIPLE=n._("Pin %(num)d files to..."),t.PIN_TO_FAILURE_SINGLE=n._("Failed to pin %(file)s to %(path)s"),t.PIN_TO_FAILURE_MULTIPLE=n._("Failed to pin %(num)d files to %(path)s"),t.PIN_TO_FAILURE_PERMISSION_DENIED=n._("You do not have permission to pin to %(path)s"),t.DESCRIPTION_LAST_EDIT_EMPTY_YOU=n._("Deleted %(time_ago)s by you"),t.DESCRIPTION_LAST_EDIT_EMPTY=n._("Deleted %(time_ago)s by %(name)s"),t.DESCRIPTION_LAST_EDIT_YOU=n._("Updated %(time_ago)s by you"),t.DESCRIPTION_LAST_EDIT=n._("Updated %(time_ago)s by %(name)s"),t.CONFLICT_POPUP_TITLE=n._("Your changes weren’t saved because you and %(user)s are editing at the same time."),t.CONFLICT_POPUP_TITLE_YOU=n._("Your changes weren’t saved because you are editing this description elsewhere."),t.CONFLICT_POPUP_CONTENT=n._("Please wait until they’re done before making changes.",{comment:'"they\'re" here refers to another user who is also currently making changes to the folder overview'}),t.CONFLICT_POPUP_CONTENT_YOU=n._("Please save your other changes before making them here."),t.CONFLICT_POPUP_BUTTON=n._("OK")}),define("modules/clean/react/folder_overview/controller",["require","exports","tslib","external/classnames","react","retrieval-components/collapsable-section","modules/clean/filepath","modules/clean/react/browse/uri_helper","modules/clean/react/files_view/types","modules/clean/react/folder_overview/async_components","modules/clean/react/folder_overview/live_update","modules/clean/react/folder_overview/logging","modules/clean/react/folder_overview/placeholder","modules/clean/web_timing_logger","modules/clean/web_user_action_events","modules/core/i18n"],function(e,t,r,o,n,i,s,a,l,c,d,u,p,f,_,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),n=r.__importDefault(n),s=r.__importStar(s);var h=(function(e){function t(t){var r=e.call(this,t)||this;return r.handleHeaderClick=function(){var e=r.props,t=e.folderFileId,o=e.isOpen;t&&(r.props.updateFolderData({fileId:t,folderData:{isCollapsed:o}}),r.props.saveFolderData({folderFileId:t}),u.logFolderOverviewAction(_.WebUserActionLogEvent.FOLDER_OVERVIEW_TOGGLED,r.props.user.id,null,{opened:o?"0":"1"}))},r.handleLiveUpdate=function(e){var t=e.type,o=r.props,n=o.folderFileId,i=o.componentNamespace;if(n)switch(t){case"description":r.props.reloadDescription({folderFileId:n,componentNamespace:i});break;case"content_references":r.props.reloadContentReferences({folderFileId:n,componentNamespace:i})}},r.shouldRenderFolderOverview=function(e){return!("OFF"===e.expFolderOverview&&e.loadedComponents.includes("description")&&e.loadedComponents.includes("content_references")&&!e.doesFolderOverviewExist)},r.handlePlaceholderClick=function(){r.setState({showPlaceholder:!1})},r.handleExamplesButtonClick=function(){c.asyncShowOverviewExamples()},r.setContainerRef=function(e){return r.container=e},r.state={showPlaceholder:!0},r}return r.__extends(t,e),t.prototype.componentDidMount=function(){var e=this,t=this.props,r=t.path,o=t.expFolderOverview,n=t.componentNamespace;(this.props.folderFileId||this.props.folderNsId)&&this.props.fetchDataForFolder({path:r,expFolderOverview:o,componentNamespace:n,fetchContentReferences:!0}),"V2"!==this.experimentVariant&&"V3"!==this.experimentVariant||d.folderOverviewLiveUpdateManager.addListener("update",this.handleLiveUpdate),this.shouldRenderFolderOverview(this.props)||this.props.addLoadedComponent({componentNamespace:n,component:"draftjs"}),this.props.loadedComponents.includes("description")&&(this.props.descriptionBaseRevision?this.setState({showPlaceholder:!1}):this.props.addLoadedComponent({componentNamespace:n,component:"draftjs"})),f.waitForTTI().then(function(){e.setState({showPlaceholder:!1})})},t.prototype.componentWillReceiveProps=function(e){var t=e.path,r=e.expFolderOverview,o=e.componentNamespace;(!s.paths_are_equal(t,this.props.path)&&(e.folderFileId||e.folderNsId)||!this.props.folderNsId&&!this.props.folderFileId&&e.folderNsId)&&this.props.fetchDataForFolder({path:t,expFolderOverview:r,componentNamespace:o,fetchContentReferences:!0}),!this.props.folderFileId&&e.folderFileId&&a.getQueryArgs().folder_overview&&(this.props.updateFolderData({fileId:e.folderFileId,folderData:{isCollapsed:!1}}),this.props.saveFolderData({folderFileId:e.folderFileId}))},t.prototype.componentDidUpdate=function(e){this.container&&this.props.onChangeHeight(this.container.getBoundingClientRect().height),!e.loadedComponents.includes("description")&&this.props.loadedComponents.includes("description")&&(this.props.descriptionBaseRevision?this.setState({showPlaceholder:!1}):this.props.addLoadedComponent({componentNamespace:this.props.componentNamespace,component:"draftjs"}))},t.prototype.componentWillUnmount=function(){"V2"!==this.experimentVariant&&"V3"!==this.experimentVariant||(d.folderOverviewLiveUpdateManager.removeListener("update",this.handleLiveUpdate),d.folderOverviewLiveUpdateManager.stop())},Object.defineProperty(t.prototype,"experimentVariant",{get:function(){return"V1"===this.props.expFolderOverview||"V2"===this.props.expFolderOverview||"V3"===this.props.expFolderOverview?this.props.expFolderOverview:"V3"},enumerable:!0,configurable:!0}),t.prototype.render=function(){if(!this.shouldRenderFolderOverview(this.props))return null;var e=!this.props.haveAllComponentsLoaded||this.props.hasFailedToLoad||this.props.browseLoadingState===l.LoadingState.LOADING_FIRST_PAGE;return n.default.createElement("div",{"aria-hidden":e||!this.props.isOpen,className:o.default({"folder-overview":!0,"folder-overview--expanded":this.props.isOpen,"folder-overview--loading":e}),ref:this.setContainerRef},n.default.createElement(i.CollapsableSection,{title:m._("Overview",{comment:"Overview of collapsible folder overview section"}),isOpen:this.props.isOpen,onHeaderClick:this.handleHeaderClick,strings:{buttonClose:m._("Hide"),buttonOpen:m._("Show")},containerClassName:o.default({"folder-overview__border":"V3"===this.props.expFolderOverview&&this.props.descriptionHasFocus,"folder-overview__fixed-toolbar-container":"V3"===this.props.expFolderOverview})},this.state.showPlaceholder?n.default.createElement(p.WrappedFolderOverviewPlaceholder,{showExamples:!0,isReadOnly:this.props.isReadOnly,showExamplesAsButton:"V3"===this.props.expFolderOverview,onClick:this.handlePlaceholderClick,onExampleButtonClick:this.handleExamplesButtonClick}):n.default.createElement(c.AsyncFolderOverviewDescription,{path:this.props.path,componentNamespace:this.props.componentNamespace,expFolderOverview:this.experimentVariant,isReadOnly:this.props.isReadOnly||!this.props.descriptionFormatValid,showReadOnlyIcon:!0,showDraftIcon:"V3"!==this.props.expFolderOverview,descriptionKey:[this.props.folderFileId,this.props.descriptionBaseRevision].join("-"),showExamplesInPlaceholder:!0,shouldHidePlaceholder:!1,limitedWidth:!1,toolbarTopMargin:146,canShareFolder:this.props.canShareFolder}),n.default.createElement(c.AsyncFolderOverviewContentReferences,{path:this.props.path,componentNamespace:this.props.componentNamespace,isReadOnly:this.props.isReadOnly,onNavigateToFileOrFolder:this.props.onNavigateToFileOrFolder}),n.default.createElement(c.AsyncFolderOverviewLastEdit,{path:this.props.path,componentNamespace:this.props.componentNamespace})))},t})(n.default.PureComponent);t.FolderOverviewController=h}),define("modules/clean/react/folder_overview/data/action_creators",["require","exports","tslib","modules/clean/filepath","modules/clean/react/browse/data/selectors","modules/clean/react/folder_overview/api","modules/clean/react/folder_overview/constants","modules/clean/react/folder_overview/data/selectors","modules/clean/react/folder_overview/data/types","modules/clean/react/folder_overview/errors","modules/clean/react/folder_overview/live_update","modules/clean/react/folder_overview/logging","modules/clean/react/folder_overview/utils","modules/clean/react/snackbar","modules/clean/storage","modules/clean/viewer","modules/clean/web_user_action_events","modules/core/exception"],function(e,t,r,o,n,i,s,a,l,c,d,u,p,f,_,m,h,S){"use strict";var g=this;Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),n=r.__importStar(n),i=r.__importStar(i),a=r.__importStar(a),p=r.__importStar(p),S=r.__importStar(S),t.fetchDataForFolder=function(e){var o=e.path,n=e.nsId,c=e.expFolderOverview,d=e.componentNamespace,u=e.fetchContentReferences;return function(e,f){return r.__awaiter(g,void 0,void 0,function(){var _,m,h,g,v,E,w,F,y,C,I,O,R,P,D,N;return r.__generator(this,function(r){switch(r.label){case 0:m=!1,h=!1,g=p.normalizePath(o),v=Date.now(),E=a.componentDataCache(f())[d],E&&0!==E.requiredComponents.length||(w=u?["content_references","description","draftjs"]:["description","draftjs"],e(t.setRequiredComponents({componentNamespace:d,requiredComponents:w}))),F=[],r.label=1;case 1:if(r.trys.push([1,3,,4]),y=a.user(f()).id,_=a.fileIdCache(f())[g],C=_||a.nsIdCache(f())[g]||n,!C)throw new Error("Unable to get file ID or NS ID for current folder");return e(t.setFailedToLoad({componentNamespace:d,hasFailedToLoad:!1})),I=_?a.folderDataCache(f())[_]:void 0,I&&I.descriptionLastUpdated&&v-I.descriptionLastUpdated<s.DATA_CACHE_TTL_MS?(m=!!I.descriptionBaseRevision,F.push(Promise.resolve(null))):(e(t.removeLoadedComponent({componentNamespace:d,component:"description"})),F.push(i.getDescription(y,C))),I&&I.contentReferencesLastUpdated&&v-I.contentReferencesLastUpdated<s.DATA_CACHE_TTL_MS?(h=!!I.contentReferencesRevision,F.push(Promise.resolve(null))):u&&(e(t.removeLoadedComponent({componentNamespace:d,component:"content_references"})),F.push(i.getContentReferences(y,C))),[4,Promise.all(F)];case 2:if(O=r.sent(),R=O[0],P=O[1],R&&(_=R.file_obj_id),!_)throw new Error("Did not get a file ID from the Sprinkle description payload");return e({type:l.ActionTypes.UPDATE_FILE_ID_CACHE,payload:{fileIdCache:(N={},N[p.normalizePath(o)]=_,N)}}),m=!!R&&b(e,_,R,d,v),h=!!P&&T(e,_,P,m,d,v,c),"V1"===c||"V2"===c||"V3"===c||h||m||e(t.addLoadedComponent({componentNamespace:d,component:"draftjs"})),I=a.folderDataCache(f())[_],I&&I.sharedFolderPath||e(t.fetchSharedFolderName({path:o})),I&&I.loggingFileId||e(t.fetchLoggingFileId({path:o})),e(t.loadFolderPreferences({folderFileId:_})),[3,4];case 3:return D=r.sent(),S.reportException({err:D,severity:"non-critical",exc_extra:{path:o,expFolderOverview:c}}),e(t.setFailedToLoad({componentNamespace:d,hasFailedToLoad:!0})),[3,4];case 4:return[2]}})})}},t.handlePrefetch=function(e){var o=e.path,n=e.expFolderOverview,i=e.content_references,s=e.description,a=e.componentNamespace,c=e.ts,d=void 0===c?Date.now():c;return function(e){return r.__awaiter(g,void 0,void 0,function(){var c,u,f,_,m,h;return r.__generator(this,function(r){try{if(c=s||{},u=i||{},f=c.file_obj_id,!f)throw new Error("Did not get a file ID from the Odyssey prefetch payload");e({type:l.ActionTypes.UPDATE_FILE_ID_CACHE,payload:{fileIdCache:(h={},h[p.normalizePath(o)]=f,h)}}),_=c&&b(e,f,c,a,d),m=u&&T(e,f,u,_,a,d,n),"V1"===n||"V2"===n||"V3"===n||m||_||e(t.addLoadedComponent({componentNamespace:a,component:"draftjs"}))}catch(r){S.reportException({err:r,severity:"non-critical",exc_extra:{path:o,expFolderOverview:n}}),e(t.setFailedToLoad({componentNamespace:a,hasFailedToLoad:!0}))}return[2]})})}},t.loadFolderPreferences=function(e){var o=e.folderFileId;return function(e,n){return r.__awaiter(g,void 0,void 0,function(){var i,s;return r.__generator(this,function(r){return i=a.user(n()).id,_.UserLocalStorage.clearOtherUsers([i]),(s=_.UserLocalStorage.get(i,"folder-overview-"+o))?(e(t.updateFolderDataCache({fileId:o,folderData:s})),[2]):[2]})})}},t.saveFolderPreferences=function(e){var t=e.folderFileId;return function(e,o){return r.__awaiter(g,void 0,void 0,function(){var e,n;return r.__generator(this,function(r){return e=a.user(o()).id,_.UserLocalStorage.clearOtherUsers([e]),(n=a.folderDataCache(o())[t])?(_.UserLocalStorage.set(e,"folder-overview-"+t,{isCollapsed:n.isCollapsed}),[2]):[2]})})}},t.addLoadedComponent=function(e){var t=e.componentNamespace,r=e.component;return{type:l.ActionTypes.ADD_LOADED_COMPONENT,payload:{componentNamespace:t,component:r}}},t.removeLoadedComponent=function(e){var t=e.componentNamespace,r=e.component;return{type:l.ActionTypes.REMOVE_LOADED_COMPONENT,payload:{componentNamespace:t,component:r}}},t.setFailedToLoad=function(e){var t=e.componentNamespace,r=e.hasFailedToLoad;return{type:l.ActionTypes.SET_FAILED_TO_LOAD,payload:{componentNamespace:t,hasFailedToLoad:r}}},t.setDescriptionData=function(e,r,o){var n=e.text,i=e.latest_revision_id,s=e.file_obj_id,a=e.bolt_channel_state,c=e.format_version,d=e.last_modified_time,u=e.last_modified_user;if(!s)throw new Error("Unexpected response from Sprinkle");var p=i||"";r(t.updateFolderDataCache({fileId:s,folderData:{description:n,descriptionBaseRevision:p,descriptionDraft:void 0,descriptionSaveState:l.DescriptionSaveState.IDLE,descriptionFormatVersion:c,descriptionBoltChannelState:a,descriptionLastUpdated:Date.now()}})),r(t.addLoadedComponent({componentNamespace:o,component:"description"})),r(E({folderFileId:s,time:d,userId:u})),t.subscribeToBolt("description",a)},t.reloadDescription=function(e){var o=e.folderFileId,n=e.componentNamespace;return function(e,s){return r.__awaiter(g,void 0,void 0,function(){var l,c,d;return r.__generator(this,function(r){switch(r.label){case 0:l=a.user(s()),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,i.getDescription(l.id,o)];case 2:return c=r.sent(),e(t.updateFolderDataCache({fileId:o,folderData:{descriptionBaseRevision:""}})),t.setDescriptionData(c,e,n),[3,4];case 3:return d=r.sent(),S.reportException({err:d,severity:S.SEVERITY.NONCRITICAL,tags:["browse","folder_overview"],exc_extra:{fileId:o,isReload:!0}}),[3,4];case 4:return[2]}})})}},t.saveDescriptionDraft=function(e){var o=e.folderFileId,n=e.componentNamespace;return function(e,d){return r.__awaiter(g,void 0,void 0,function(){function p(r){e(t.updateFolderDataCache({fileId:o,folderData:r}))}var f,_,m,S,g,E,b,T,F,y,C;return r.__generator(this,function(t){switch(t.label){case 0:f=a.user(d()).id,t.label=1;case 1:return t.trys.push([1,3,,4]),_=a.folderDataCache(d()),m=_[o],m&&v(m)?(p({descriptionSaveState:l.DescriptionSaveState.SAVING}),[4,i.setDescription(f,o,m.descriptionLatestRevision,m.descriptionDraft,s.DESCRIPTION_VERSION.join("."))]):[2];case 2:return S=t.sent(),g=S.text,E=S.latest_revision_id,b=S.last_modified_time,T=S.last_modified_user,p({description:g,descriptionSaveState:l.DescriptionSaveState.IDLE,lastModifiedTime:b,lastModifiedUserId:T,descriptionBaseRevision:E,descriptionLatestRevision:E}),F="BROWSE"===n?h.ActionSurfaceLogValue.CENTER_PANE:h.ActionSurfaceLogValue.RIGHT_SIDEBAR,y="search-sidebar"===n?h.RetrievalSourceValue.SEARCH:h.RetrievalSourceValue.BROWSE,u.logOverviewEdited({folderFileId:o,action_surface:F,retrievalSource:y,loggingFileId:m.loggingFileId}),[3,4];case 3:return C=t.sent(),i.isConflictError(C)?(p({descriptionSaveState:l.DescriptionSaveState.CONFLICT,lastModifiedUserId:void 0}),e(w({folderFileId:o}))):i.isFormatVersionError(C)?(c.showDescriptionFormatError(),p({descriptionSaveState:l.DescriptionSaveState.ERROR})):(c.showDescriptionSaveError(),p({descriptionSaveState:l.DescriptionSaveState.ERROR})),[3,4];case 4:return[2]}})})}},t.setContentReferencesData=function(e,r,o,n){var i=r.content_references||[],s=r.latest_revision_id,a=r.last_modified_time,l=r.last_modified_user;o(t.updateFolderDataCache({fileId:e,folderData:{contentReferences:i,contentReferencesRevision:s,contentReferencesBoltChannelState:r.bolt_channel_state,contentReferencesLastUpdated:Date.now()}})),o(E({folderFileId:e,time:a,userId:l})),o(t.addLoadedComponent({componentNamespace:n,component:"content_references"})),t.subscribeToBolt("content_references",r.bolt_channel_state)},t.reloadContentReferences=function(e){var o=e.folderFileId,n=e.componentNamespace;return function(e,s){return r.__awaiter(g,void 0,void 0,function(){var l,c,d;return r.__generator(this,function(r){switch(r.label){case 0:l=a.user(s()),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,i.getContentReferences(l.id,o)];case 2:return c=r.sent(),t.setContentReferencesData(o,c,e,n),[3,4];case 3:return d=r.sent(),S.reportException({err:d,severity:S.SEVERITY.NONCRITICAL,tags:["browse","folder_overview"],exc_extra:{fileId:o,isReload:!0}}),[3,4];case 4:return[2]}})})}},t.addContentReferences=function(e){var o=e.folderFileId,n=e.fileIds,s=e.componentNamespace;return function(e,l){return r.__awaiter(g,void 0,void 0,function(){var c,d,p,f,_,m;return r.__generator(this,function(r){switch(r.label){case 0:c=a.user(l()).id,d=a.folderDataCache(l())[o],p=d&&d.loggingFileId,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,i.addContentReferences(c,o,n)];case 2:return r.sent(),e(t.reloadContentReferences({folderFileId:o,componentNamespace:s})),f="BROWSE"===s?h.ActionSurfaceLogValue.CENTER_PANE:h.ActionSurfaceLogValue.RIGHT_SIDEBAR,_="search-sidebar"===s?h.RetrievalSourceValue.SEARCH:h.RetrievalSourceValue.BROWSE,u.logOverviewEdited({folderFileId:o,action_surface:f,retrievalSource:_,loggingFileId:p}),[3,4];case 3:return m=r.sent(),S.reportException({err:m,severity:S.SEVERITY.NONCRITICAL,tags:["browse","folder_overview"]}),[3,4];case 4:return[2]}})})}},t.addContentReferencesForPath=function(e){var n=e.path,l=e.files;return function(e,c){return r.__awaiter(g,void 0,void 0,function(){var d,u,_,h;return r.__generator(this,function(r){switch(r.label){case 0:d=a.user(c()),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,i.addContentReferencesToPath(d.id,n,l.map(p.fileToContentReferenceId))];case 2:return r.sent(),1===l.length?f.Snackbar.complete(s.PIN_TO_SUCCESS_SINGLE.format({file:o.filename(l[0].fq_path),path:o.filename(n,m.Viewer.get_root_name(d))}),"folder-overview-pin"):f.Snackbar.complete(s.PIN_TO_SUCCESS_MULTIPLE.format({num:l.length,path:o.filename(n,m.Viewer.get_root_name(d))}),"folder-overview-pin"),u=a.fileIdCache(c())[p.normalizePath(n)],u&&e(t.reloadContentReferences({folderFileId:u,componentNamespace:"BROWSE"})),[3,4];case 3:_=r.sent(),S.reportException({err:_,severity:S.SEVERITY.NONCRITICAL,tags:["browse","folder_overview"]});try{if(h=_.error.status[".tag"],"permission_denied"===h)return f.Snackbar.fail(s.PIN_TO_FAILURE_PERMISSION_DENIED.format({file:o.filename(l[0].fq_path),path:o.filename(n,m.Viewer.get_root_name(d))}),"folder-overview-pin"),[2]}catch(e){}return 1===l.length?f.Snackbar.fail(s.PIN_TO_FAILURE_SINGLE.format({file:o.filename(l[0].fq_path),path:o.filename(n,m.Viewer.get_root_name(d))}),"folder-overview-pin"):f.Snackbar.fail(s.PIN_TO_FAILURE_MULTIPLE.format({num:l.length,path:o.filename(n,m.Viewer.get_root_name(d))}),"folder-overview-pin"),[3,4];case 4:return[2]}})})}},t.removeContentReferences=function(e){var o=e.folderFileId,n=e.fileIds,s=e.componentNamespace;return function(e,l){return r.__awaiter(g,void 0,void 0,function(){var c,d,p,f,_,m;return r.__generator(this,function(r){switch(r.label){case 0:c=a.user(l()).id,d=a.folderDataCache(l())[o],p=d&&d.loggingFileId,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,i.removeContentReferences(c,o,n)];case 2:return r.sent(),e(t.reloadContentReferences({folderFileId:o,componentNamespace:s})),f="BROWSE"===s?h.ActionSurfaceLogValue.CENTER_PANE:h.ActionSurfaceLogValue.RIGHT_SIDEBAR,_="search-sidebar"===s?h.RetrievalSourceValue.SEARCH:h.RetrievalSourceValue.BROWSE,u.logOverviewEdited({folderFileId:o,action_surface:f,retrievalSource:_,loggingFileId:p}),[3,4];case 3:return m=r.sent(),S.reportException({err:m,severity:S.SEVERITY.NONCRITICAL,tags:["browse","folder_overview"]}),[3,4];case 4:return[2]}})})}},t.updateFolderDataCache=function(e){var t=e.fileId,r=e.folderData;return{type:l.ActionTypes.UPDATE_FOLDER_DATA_CACHE,payload:{fileId:t,folderData:r}}},t.setRequiredComponents=function(e){var t=e.componentNamespace,r=e.requiredComponents;return{type:l.ActionTypes.SET_REQUIRED_COMPONENTS,payload:{componentNamespace:t,requiredComponents:r}}},t.setDescriptionHasFocus=function(e){var r=e.componentNamespace,o=e.descriptionHasFocus,n=e.folderFileId;return function(e,i){var s=a.componentDataCache(i())[r];if(o&&s&&!s.descriptionHasFocus){var c=a.folderDataCache(i())[n].descriptionBaseRevision;e(t.updateFolderDataCache({fileId:n,folderData:{descriptionLatestRevision:c}}))}e({type:l.ActionTypes.SET_DESCRIPTION_HAS_FOCUS,payload:{componentNamespace:r,descriptionHasFocus:o}})}};var v=function(e){return!!e&&(e.descriptionSaveState!==l.DescriptionSaveState.CONFLICT&&(e.descriptionSaveState!==l.DescriptionSaveState.SAVING&&p.hasUnsavedDescriptionDraft(e)))};t.fetchSharedFolderName=function(e){var n=e.path;return function(e,s){return r.__awaiter(g,void 0,void 0,function(){var l,c,d,u,f,_,m;return r.__generator(this,function(r){switch(r.label){case 0:if(o.paths_are_equal(n,"/"))return[2];if(l=p.normalizePath(n),c=a.nsIdCache(s())[l],!c)return[2];if(d=a.fileIdCache(s())[l],u=a.user(s()).id,f=p.extractSharedFolderId(c),!f)return[2];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,i.getSharedFolderPath({userId:u,sharedFolderId:f})];case 2:return _=r.sent(),e(t.updateFolderDataCache({fileId:d,folderData:{sharedFolderPath:_}})),[3,4];case 3:return m=r.sent(),S.reportException({err:m,severity:S.SEVERITY.NONCRITICAL,tags:["browse","folder_overview"]}),[3,4];case 4:return[2]}})})}},t.fetchAccountForUserId=function(e){var t=e.accountId;return function(e,o){return r.__awaiter(g,void 0,void 0,function(){var n,s,c;return r.__generator(this,function(r){switch(r.label){case 0:return n=a.user(o()),t?t in a.accountCache(o())?[2]:t===n.account_id?[2]:[4,i.getUserAccount({userId:n.id,accountId:t})]:[2];case 1:return s=r.sent(),e({type:l.ActionTypes.UPDATE_ACCOUNT_CACHE,payload:{accountCache:(c={},c[t]=s,c)}}),[2]}})})}},t.fetchLoggingFileId=function(e){var s=e.path;return function(e,l){return r.__awaiter(g,void 0,void 0,function(){var c,d,u,f,_;return r.__generator(this,function(r){switch(r.label){case 0:if(o.paths_are_equal(s,"/"))return[2];if(o.paths_are_equal(n.context(l()).currentFQPath,s)&&!n.context(l()).currentNSPath)return[2];c=p.normalizePath(s),d=a.fileIdCache(l())[c],u=a.user(l()).id,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,i.getLoggingFileId({userId:u,path:c})];case 2:return f=r.sent(),e(t.updateFolderDataCache({fileId:d,folderData:{loggingFileId:f}})),[3,4];case 3:return _=r.sent(),S.reportException({err:_,severity:S.SEVERITY.NONCRITICAL,tags:["browse","folder_overview"]}),[3,4];case 4:return[2]}})})}};var E=function(e){var r=e.folderFileId,o=e.time,n=e.userId;return function(e,i){if(o&&n){var s=a.folderDataCache(i())[r];s&&(s.lastModifiedTime&&o<s.lastModifiedTime||(e(t.updateFolderDataCache({fileId:r,folderData:{lastModifiedTime:o,lastModifiedUserId:n}})),e(t.fetchAccountForUserId({accountId:n}))))}}};t.subscribeToBolt=function(e,t){if(void 0!==t)try{var r=t.channel_id,o=t.revision,n=t.token;if(void 0===r||void 0===o||void 0===n)return;var i=r.unique_id,s=r.app_id;if(void 0===i||void 0===s)return;d.folderOverviewLiveUpdateManager.setUpdateChannelForType(e,{uniqueId:i,appId:s,token:n,revision:""+o})}catch(e){S.reportException({err:e,severity:S.SEVERITY.NONCRITICAL,tags:["browse","folder_overview"]})}};var w=function(e){var t=e.folderFileId;return function(e,o){return r.__awaiter(g,void 0,void 0,function(){var n,s,l,c;return r.__generator(this,function(r){switch(r.label){case 0:return n=a.user(o()),[4,i.getDescription(n.id,t)];case 1:return s=r.sent(),l=s.last_modified_time,c=s.last_modified_user,e(E({folderFileId:t,time:l,userId:c})),[2]}})})}},b=function(e,r,o,n,i){return o.latest_revision_id?(t.setDescriptionData(o,e,n),!0):(e(t.addLoadedComponent({componentNamespace:n,component:"description"})),e(t.updateFolderDataCache({fileId:r,folderData:{descriptionBoltChannelState:o.bolt_channel_state,descriptionLastUpdated:i}})),t.subscribeToBolt("description",o.bolt_channel_state),!1)},T=function(e,r,o,n,i,s,a){if(o.latest_revision_id)return t.setContentReferencesData(r,o,e,i),!0;var l="V1"===a||"V2"===a||"V3"===a||n;return e(t.updateFolderDataCache({fileId:r,folderData:{contentReferences:l?[]:void 0,contentReferencesBoltChannelState:l?o.bolt_channel_state:void 0,contentReferencesLastUpdated:s}})),e(t.addLoadedComponent({componentNamespace:i,component:"content_references"})),!1}}),define("modules/clean/react/folder_overview/data/reducer",["require","exports","tslib","modules/clean/react/browse/data/types","modules/clean/react/browse/models","modules/clean/react/folder_overview/data/types","modules/clean/react/folder_overview/utils","modules/clean/search/single_page/data/types"],function(e,t,r,o,n,i,s,a){"use strict";function l(e,r){switch(void 0===e&&(e=t.defaultFolderOverviewState),r.type){case i.ActionTypes.UPDATE_FOLDER_DATA_CACHE:return p(e,r.payload);case i.ActionTypes.UPDATE_FILE_ID_CACHE:return d(e,r.payload);case i.ActionTypes.UPDATE_ACCOUNT_CACHE:return u(e,r.payload);case i.ActionTypes.SET_REQUIRED_COMPONENTS:return _(e,r.payload);case o.ActionTypes.SET_CONTEXT:return c(e,r.payload);case i.ActionTypes.REMOVE_LOADED_COMPONENT:return m(e,r.payload);case i.ActionTypes.ADD_LOADED_COMPONENT:return h(e,r.payload);case i.ActionTypes.SET_FAILED_TO_LOAD:return S(e,r.payload);case i.ActionTypes.SET_DESCRIPTION_HAS_FOCUS:return g(e,r.payload);case o.ActionTypes.SET_UNSORTED_FILES:return v(e,r.payload);case a.ActionTypes.SET_RESULTS:case a.ActionTypes.APPEND_RESULTS:return E(e,r.payload)}return e}Object.defineProperty(t,"__esModule",{value:!0}),t.defaultFolderOverviewState={folderDataCache:{},fileIdCache:{},accountCache:{},nsIdCache:{},componentDataCache:{}};var c=function(e,t){var o,n=t.context;return r.__assign({},e,{nsIdCache:r.__assign({},e.nsIdCache,(o={},o[s.normalizePath(n.currentFQPath)]="ns:"+n.currentNSID+"/"+n.currentNSPath,o))})},d=function(e,t){var o=t.fileIdCache;return r.__assign({},e,{fileIdCache:r.__assign({},e.fileIdCache,o)
})},u=function(e,t){var o=t.accountCache;return r.__assign({},e,{accountCache:r.__assign({},e.accountCache,o)})},p=function(e,t){var o,n=t.fileId,i=t.folderData;return r.__assign({},e,{folderDataCache:r.__assign({},e.folderDataCache,(o={},o[n]=r.__assign({},e.folderDataCache[n],i),o))})},f=function(e,t){var r=e.componentDataCache[t];return r?r:{requiredComponents:[],loadedComponents:[],hasFailedToLoad:!1,descriptionHasFocus:!1}},_=function(e,t){var o,n=t.componentNamespace,i=t.requiredComponents,s=f(e,n);return r.__assign({},e,{componentDataCache:r.__assign({},e.componentDataCache,(o={},o[n]=r.__assign({},s,{requiredComponents:i}),o))})},m=function(e,t){var o,n=t.componentNamespace,i=t.component,s=f(e,n),a=s.loadedComponents;return r.__assign({},e,{componentDataCache:r.__assign({},e.componentDataCache,(o={},o[n]=r.__assign({},s,{loadedComponents:a.filter(function(e){return e!==i})}),o))})},h=function(e,t){var o,n=t.componentNamespace,i=t.component,s=f(e,n),a=s.loadedComponents;return a.includes(i)?e:r.__assign({},e,{componentDataCache:r.__assign({},e.componentDataCache,(o={},o[n]=r.__assign({},s,{loadedComponents:a.concat([i])}),o))})},S=function(e,t){var o,n=t.componentNamespace,i=t.hasFailedToLoad,s=f(e,n);return r.__assign({},e,{componentDataCache:r.__assign({},e.componentDataCache,(o={},o[n]=r.__assign({},s,{hasFailedToLoad:i}),o))})},g=function(e,t){var o,n=t.componentNamespace,i=t.descriptionHasFocus,s=f(e,n);return r.__assign({},e,{componentDataCache:r.__assign({},e.componentDataCache,(o={},o[n]=r.__assign({},s,{descriptionHasFocus:i}),o))})},v=function(e,t){var o=t.unsortedFiles,n=o.filter(function(e){return e.is_dir}).toArray();return r.__assign({},e,{nsIdCache:r.__assign({},e.nsIdCache,w(n))})},E=function(e,t){var o=t.searchResults,i=o.results.filter(function(e){return e instanceof n.File&&e.is_dir});return r.__assign({},e,{nsIdCache:r.__assign({},e.nsIdCache,w(i))})},w=function(e){var t={};return e.forEach(function(e){t[s.normalizePath(e.fq_path)]=e.target_ns?"ns:"+e.target_ns+"/":"ns:"+e.ns_id+"/"+e.ns_path}),t};t.folderOverviewReducer=l}),define("modules/clean/react/folder_overview/data/selectors",["require","exports","tslib","external/reselect","modules/clean/filepath","modules/clean/react/folder_overview/constants","modules/clean/react/folder_overview/data/reducer","modules/clean/react/folder_overview/utils","comments2/components/folder_overview_utils","modules/clean/redux/namespaces","modules/clean/redux/selectors","modules/clean/user"],function(e,t,r,o,n,i,s,a,l,c,d,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n=r.__importStar(n),a=r.__importStar(a);var p=function(e,t){return t.path},f=function(e,t){return t.componentNamespace},_=[],m=function(e){return d.getStateAtNamespace(e,c.FOLDER_OVERVIEW_NAMESPACE_KEY)||s.defaultFolderOverviewState};t.folderDataCache=function(e){return m(e).folderDataCache},t.fileIdCache=function(e){return m(e).fileIdCache},t.nsIdCache=function(e){return m(e).nsIdCache},t.accountCache=function(e){return m(e).accountCache},t.componentDataCache=function(e){return m(e).componentDataCache},t.user=function(e){return e.BROWSE&&e.BROWSE.user||u.mkUser(e.SEARCH.user)},t.makeSelectors=function(){var e=o.createSelector(t.componentDataCache,f,function(e,t){return e[t]}),r=o.createSelector(e,function(e){return e?e.loadedComponents:void 0}),s=o.createSelector(e,function(e){return!(!e||0===e.requiredComponents.length)&&0===e.requiredComponents.filter(function(t){return!e.loadedComponents.includes(t)}).length}),c=o.createSelector(e,function(e){return!!e&&e.hasFailedToLoad}),d=o.createSelector(e,function(e){return!!e&&e.descriptionHasFocus}),u=o.createSelector(t.fileIdCache,p,function(e,t){return e[a.normalizePath(t)]}),m=o.createSelector(t.nsIdCache,p,function(e,t){return e[a.normalizePath(t)]}),h=o.createSelector(t.nsIdCache,p,function(e,t){var r=e[a.normalizePath(t)];if(r)return a.extractSharedFolderId(r)}),S=o.createSelector(t.user,a.convertDbxUserToIUser),g=o.createSelector(t.folderDataCache,u,function(e,t){return e[t]}),v=o.createSelector(g,function(e){return!!e&&!!e.isCollapsed}),E=o.createSelector(g,function(e){return e?e.descriptionBaseRevision:void 0}),w=o.createSelector(g,function(e){return e?e.lastModifiedTime:void 0}),b=o.createSelector(g,function(e){return e?e.lastModifiedUserId:void 0}),T=o.createSelector(b,t.accountCache,function(e,t){return e?t[e]:void 0}),F=o.createSelector(g,function(e){return e?e.descriptionSaveState:void 0}),y=o.createSelector(g,function(e){if(e&&e.description)try{return JSON.parse(e.description)}catch(e){return}}),C=o.createSelector(g,function(e){return e?e.descriptionFormatVersion:void 0}),I=o.createSelector(C,function(e){if(!e)return!0;var t=e.split(".").map(function(e){return parseInt(e,10)});return!(t[0]>i.DESCRIPTION_VERSION[0])&&!(t[0]===i.DESCRIPTION_VERSION[0]&&t[1]>i.DESCRIPTION_VERSION[1])}),O=o.createSelector(y,l.isEmptyDescription),R=o.createSelector(g,a.hasUnsavedDescriptionDraft),P=o.createSelector(g,p,function(e,t){return e?e.sharedFolderPath||t:void 0}),D=o.createSelector(g,p,function(e,t){return e?n.filename(e.sharedFolderPath||t):void 0}),N=o.createSelector(g,function(e){return e?e.loggingFileId:void 0}),A=o.createSelector(g,function(e){if(void 0!==e&&void 0!==e.contentReferences)return 0===e.contentReferences.length?_:a.convertContentReferencesToSortedFiles(e.contentReferences)});return{loadedComponents:r,haveAllComponentsLoaded:s,hasFailedToLoad:c,folderFileId:u,folderNsId:m,sharedFolderId:h,descriptionAuthor:S,isCollapsed:v,descriptionBaseRevision:E,lastModifiedTime:w,lastModifiedUserId:b,lastModifiedUser:T,descriptionSaveState:F,descriptionContent:y,descriptionFormatVersion:C,descriptionFormatValid:I,descriptionContentIsEmpty:O,descriptionHasFocus:d,hasUnsavedDescriptionDraft:R,sharedFolderPath:P,sharedFolderName:D,loggingFileId:N,pinnedItems:A,isFolderOverviewEmpty:o.createSelector(O,A,function(e,t){return e&&!(t&&t.length)}),doesFolderOverviewExist:o.createSelector(g,function(e){return!(!e||!e.descriptionBaseRevision&&!e.contentReferencesRevision)})}}}),define("modules/clean/react/folder_overview/data/store",["require","exports","modules/clean/react/folder_overview/data/reducer","modules/clean/redux/store","modules/clean/redux/namespaces"],function(e,t,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i;t.getStoreForFolderOverview=function(){var e;return i||(i=o.getStoreAndRegisterReducers((e={},e[n.FOLDER_OVERVIEW_NAMESPACE_KEY]=r.folderOverviewReducer,e))),i}}),define("modules/clean/react/folder_overview/data/types",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e.UPDATE_FOLDER_DATA_CACHE="FOLDER_OVERVIEW/UPDATE_FOLDER_DATA_CACHE",e.UPDATE_FILE_ID_CACHE="FOLDER_OVERVIEW/UPDATE_FILE_ID_CACHE",e.REMOVE_LOADED_COMPONENT="FOLDER_OVERVIEW/REMOVE_LOADED_COMPONENT",e.ADD_LOADED_COMPONENT="FOLDER_OVERVIEW/ADD_LOADED_COMPONENT",e.SET_FAILED_TO_LOAD="FOLDER_OVERVIEW/SET_FAILED_TO_LOAD",e.SET_DESCRIPTION_HAS_FOCUS="FOLDER_OVERVIEW/SET_DESCRIPTION_HAS_FOCUS",e.UPDATE_ACCOUNT_CACHE="FOLDER_OVERVIEW/UPDATE_ACCOUNT_CACHE",e.SET_REQUIRED_COMPONENTS="FOLDER_OVERVIEW/SET_REQUIRED_COMPONENTS"})(t.ActionTypes||(t.ActionTypes={}));(function(e){e.IDLE="IDLE",e.SAVING="SAVING",e.CONFLICT="CONFLICT",e.ERROR="ERROR"})(t.DescriptionSaveState||(t.DescriptionSaveState={}))}),define("modules/clean/react/folder_overview/errors",["require","exports","modules/clean/react/folder_overview/constants","modules/clean/react/snackbar"],function(e,t,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.showDescriptionFormatError=function(){o.Snackbar.fail(r.ERROR_DESCRIPTION_FORMAT_VERSION,"folder-overview")},t.showDescriptionSaveError=function(){o.Snackbar.fail(r.ERROR_DESCRIPTION_SAVE,"folder-overview")}}),define("modules/clean/react/folder_overview/live_update",["require","exports","tslib","external/lodash","external/eventemitter3","modules/clean/bolt"],function(e,t,r,o,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o);var s=(function(e){function t(){var t=e.call(this)||this;return t.setUpdateChannelForType=function(e,r){t.signedChannelStates[e]=new i.SignedChannelState(r.appId,r.uniqueId,r.revision,r.token),t.boltClient.update_states(o.values(t.signedChannelStates)),t.boltClient.start()},t.handleUpdate=function(e){var r=[];e.forEach(function(e){var n=o.findKey(t.signedChannelStates,{app_id:e.app_id,unique_id:e.unique_id});n&&!r.includes(n)&&(t.emit("update",{type:n}),r.push(n))})},t.handleRefresh=function(){t.boltClient.update_states(o.values(t.signedChannelStates))},t.boltClient=new i.BoltClient([],t.handleUpdate,t.handleRefresh),t.signedChannelStates={},t}return r.__extends(t,e),t.prototype.stop=function(){this.boltClient.unsubscribe()},t})(n.EventEmitter);t.FolderOverviewLiveUpdateManager=s,t.folderOverviewLiveUpdateManager=new s}),define("modules/clean/react/folder_overview/logging",["require","exports","tslib","external/sjcl","immutable","modules/clean/filepath","modules/clean/logging/hive/schemas/web-user-action","modules/clean/logging/telemetry","modules/clean/react/folder_overview/data/selectors","modules/clean/react/folder_overview/data/store","modules/clean/react/folder_overview/utils","modules/clean/web_user_action_events"],function(e,t,r,o,n,i,s,a,l,c,d,u){"use strict";function p(e){var t=m(e);return{length:e?f(e):0,features:e?_(e):[],tasks:t.all,checkedTasks:t.checked}}function f(e){return e.blocks.map(function(e){return e.text.length}).reduce(function(e,t){return e+t},0)}function _(e){var t=n.OrderedSet();return t=t.merge(e.blocks.map(function(e){return e.type}).filter(function(e){return"unstyled"!==e})),e.blocks.forEach(function(e){return e.inlineStyleRanges.forEach(function(e){t=t.add(e.style)})}),e.blocks.forEach(function(r){return r.entityRanges.forEach(function(r){t=t.add(e.entityMap[r.key].type)})}),t.toArray().sort()}function m(e){var t={all:0,checked:0};return e?(e.blocks.forEach(function(e){"task-block"===e.type&&(t.all+=1,e.data&&e.data.checked&&(t.checked+=1))}),t):t}Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),i=r.__importStar(i),a=r.__importStar(a),l=r.__importStar(l),t.hiveLogger=new a.HiveLogger;var h=function(e,t){var r=l.folderDataCache(t)[e];if(r&&r.descriptionDraft)try{return JSON.parse(r.descriptionDraft)}catch(e){return}},S=function(e,t){var r=l.folderDataCache(t)[e];return r?r.contentReferences||[]:[]},g=function(e){if(!e)return"";var t=o.hash.sha256.hash(e.toLowerCase());return o.codec.hex.fromBits(t)};t.hashPath=function(e){return(e||"/").split("/").map(g).join("/")};var v=function(e){return g(i.normalize(e).split("/").pop())},E=function(e,t){var r=l.fileIdCache(t);for(var o in r)if(r[o]===e)return o};t.extractNsIdAndPath=function(e){return e?{nsId:d.extractSharedFolderId(e),nsPath:d.extractSharedFolderPath(e)}:{}},t.makeEditedData=function(e){var o=e.folderFileId,n=e.loggingFileId,i=e.action_surface,s=e.retrievalSource,a=c.getStoreForFolderOverview().getState(),l=p(h(o,a)),d=t.makeOverviewResourceExtras({folderFileId:o,loggingFileId:n,action_surface:i,retrievalSource:s});if(d)return r.__assign({},d,{length:l.length.toString(),formatting:JSON.stringify(l.features),tasks:l.tasks.toString(),checkedTasks:l.checkedTasks.toString(),pins:JSON.stringify(S(o,a).map(function(e){return{file_id:e.ns_path?e.file_id:e.ns_id,file_obj_id:e.file_id,resource:{resource_title:v(e.fq_path),resource_type:e.is_dir?"SFJ_FOLDER":"SFJ_FILE",ns_id:""+e.ns_id,resource_path:t.hashPath(e.fq_path),resource_namespace_path:t.hashPath(e.ns_path)}}}))})},t.makeOverviewResourceExtras=function(e){var r=e.folderFileId,o=e.loggingFileId,n=e.action_surface,i=e.retrievalSource,s=c.getStoreForFolderOverview().getState(),a=E(r,s);if(void 0!==a){var d=t.extractNsIdAndPath(l.nsIdCache(s)[a]),u=d.nsId,p=d.nsPath;if(u)return{resource_type:"SFJ_FOLDER",resource_title:v(a),ns_id:u,resource_path:t.hashPath(a),resource_namespace_path:t.hashPath(p),file_id:(p?o:u)||null,file_obj_id:r,is_offline:"false",action_surface:n,retrieval_source:i}}},t.logOverviewEdited=function(e){var r=e.folderFileId,o=e.loggingFileId,n=e.action_surface,i=e.retrievalSource,s=c.getStoreForFolderOverview().getState();t.logFolderOverviewAction(u.WebUserActionLogEvent.FOLDER_OVERVIEW_EDITED,l.user(s).id,null,t.makeEditedData({folderFileId:r,loggingFileId:o,action_surface:n,retrievalSource:i}))},t.logFolderOverviewAction=function(e,o,n,a){void 0===a&&(a={});var l={user_id:o,event_name:e};n&&(l=r.__assign({},l,{file_nsid:n.ns_id,file_sjid:n.sjid,file_id:n.file_id,file_name:i.filename(n.fq_path),file_path:n.fq_path,file_extension:n.ext})),t.hiveLogger.log(new s.WebUserActionRow(r.__assign({},l,{extra:r.__assign({},a)})))}}),define("modules/clean/react/folder_overview/placeholder",["require","exports","tslib","react","spectrum/button","modules/clean/react/folder_overview/constants"],function(e,t,r,o,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),t.FolderOverviewPlaceholder=function(e){var r=e.isReadOnly?i.DESCRIPTION_PLACEHOLDER_READ_ONLY:i.DESCRIPTION_PLACEHOLDER;return o.default.createElement("div",{className:"folder-overview__description--placeholder",onClick:e.onClick},o.default.createElement("span",null,r),e.showExamples&&o.default.createElement(t.FolderOverviewPlaceholderExample,{showExamplesAsButton:e.showExamplesAsButton,onExampleButtonClick:e.onExampleButtonClick}))},t.FolderOverviewPlaceholderExample=function(e){return e.showExamplesAsButton?o.default.createElement(n.Button,{"aria-label":i.FOLDER_EXAMPLES_LINK_LABEL,onClick:e.onExampleButtonClick,className:"folder_overview__examples-button",variant:"secondary"},i.DESCRIPTION_PLACEHOLDER_EXAMPLES_BUTTON):o.default.createElement("a",{"aria-label":i.FOLDER_EXAMPLES_LINK_LABEL,href:i.FOLDER_EXAMPLES_LINK_URI,target:"_blank",rel:"noreferrer"},i.DESCRIPTION_PLACEHOLDER_EXAMPLES_BUTTON)},t.WrappedFolderOverviewPlaceholder=function(e){return o.default.createElement("div",{className:"folder-overview__description folder-overview__placeholder folder-overview__fixed-toolbar"},o.default.createElement(t.FolderOverviewPlaceholder,{showExamples:e.showExamples,isReadOnly:e.isReadOnly,showExamplesAsButton:e.showExamplesAsButton,onClick:e.onClick}))}}),define("modules/clean/react/folder_overview/sidebar_connected",["require","exports","tslib","react","external/react-redux","modules/clean/react/css","modules/clean/react/folder_overview/data/action_creators","modules/clean/react/folder_overview/data/selectors","modules/clean/react/folder_overview/data/store","modules/clean/react/folder_overview/sidebar_controller"],function(e,t,r,o,n,i,s,a,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),s=r.__importStar(s);var d=l.getStoreForFolderOverview(),u=function(){var e=a.makeSelectors();return function(t,r){return{user:a.user(t),haveAllComponentsLoaded:e.haveAllComponentsLoaded(t,r),hasFailedToLoad:e.hasFailedToLoad(t,r),folderFileId:e.folderFileId(t,r),descriptionBaseRevision:e.descriptionBaseRevision(t,r),descriptionFormatValid:e.descriptionFormatValid(t,r),descriptionHasFocus:e.descriptionHasFocus(t,r),doesFolderOverviewExist:e.doesFolderOverviewExist(t,r)}}},p={fetchDataForFolder:s.fetchDataForFolder,reloadDescription:s.reloadDescription},f=n.connect(u,p)(c.SidebarFolderOverviewController),_=function(e){return o.default.createElement(n.Provider,{store:d},o.default.createElement(f,r.__assign({},e)))};t.SidebarFolderOverview=i.requireCssWithComponent(_,["/static/css/browse/folder_overview-vflGIgHnV.css","/static/js/comments2/index.web-vflARkr3t.css","/static/js/retrieval-components/index.web-vflEwNrla.css"])}),define("modules/clean/react/folder_overview/sidebar_controller",["require","exports","tslib","external/classnames","react","modules/clean/react/folder_overview/async_components","modules/clean/react/folder_overview/live_update"],function(e,t,r,o,n,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),n=r.__importDefault(n);var a=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleLiveUpdate=function(e){"description"===e.type&&t.props.reloadDescription({folderFileId:t.props.folderFileId,componentNamespace:t.props.componentNamespace})},t}return r.__extends(t,e),t.prototype.componentDidMount=function(){this.props.fetchDataForFolder({path:this.props.path,nsId:this.props.nsId,expFolderOverview:"V3",componentNamespace:this.props.componentNamespace,fetchContentReferences:!1}),s.folderOverviewLiveUpdateManager.addListener("update",this.handleLiveUpdate)},t.prototype.componentWillUnmount=function(){s.folderOverviewLiveUpdateManager.removeListener("update",this.handleLiveUpdate),s.folderOverviewLiveUpdateManager.stop()},t.prototype.render=function(){return!this.props.doesFolderOverviewExist&&this.props.onlyRenderExistingFolderOverviews?null:n.default.createElement("div",{className:o.default({"folder-overview":!0,"folder-overview--loading":!this.props.haveAllComponentsLoaded||this.props.hasFailedToLoad,"folder-overview__fixed-toolbar-container":!0,"folder-overview__border":this.props.descriptionHasFocus})},n.default.createElement(i.AsyncFolderOverviewDescription,{path:this.props.path,componentNamespace:this.props.componentNamespace,expFolderOverview:"V3",isReadOnly:this.props.isReadOnly||!this.props.descriptionFormatValid,showReadOnlyIcon:!0,showDraftIcon:!1,descriptionKey:[this.props.folderFileId,this.props.descriptionBaseRevision].join("-"),showExamplesInPlaceholder:!1,limitedWidth:!0,canShareFolder:this.props.canShareFolder}),n.default.createElement(i.AsyncFolderOverviewLastEdit,{path:this.props.path,componentNamespace:this.props.componentNamespace}))},t})(n.default.PureComponent);t.SidebarFolderOverviewController=a}),define("modules/clean/react/folder_overview/utils",["require","exports","tslib","modules/clean/filepath","modules/clean/react/browse/models","modules/core/i18n"],function(e,t,r,o,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),t.convertDbxUserToIUser=function(e){return{id:e.id.toString(),name:{display:e.display_name,initials:[e.fname.substr(0,1),e.lname.substr(0,1)].join(""),public:e.familiar_name},photoUrl:e.initials_url}},t.normalizePath=function(e){return o.normalize(e).toLowerCase()},t.hasUnsavedDescriptionDraft=function(e){return!!e&&(void 0!==e.descriptionDraft&&e.description!==e.descriptionDraft)},t.convertContentReferencesToSortedFiles=function(e){var r=[];e.forEach(function(e){var o={file_id:e.file_id,fq_path:e.fq_path,href:e.href,icon:e.icon,is_cloud_doc:e.is_cloud_doc,is_dir:e.is_dir,thumbnail_url_tmpl:e.thumbnail_url_tmpl,ns_id:e.ns_id,ns_path:e.ns_path,sjid:e.sjid,isDeleted:e.is_deleted,ext:t.getFileExtension(e.fq_path)},i=new n.File(o);r.push(i)});var o=i.case_insensitive_comparator(!0);return r.sort(function(e,t){return o(n.File.getFilename(e),n.File.getFilename(t))})},t.getFileExtension=function(e){if(!e)return"";var t=o.file_extension(e);return t?"."+t:""},t.extractSharedFolderId=function(e){var t=/^ns:([0-9]+)\/?/.exec(e);return t?t[1]:void 0},t.extractSharedFolderPath=function(e){var t=/^ns:[0-9]+\/?(.*)/.exec(e);return t?t[1]:void 0},t.pathFromSharingFolder=function(e,t){return e.length>=t.length?o.filename(t):[o.filename(e)].concat(t.substr(e.length).split("/").filter(function(e){return!!e})).join(" › ")},t.fileToContentReferenceId=function(e){return e.is_dir&&e.target_ns?"ns:"+e.target_ns:e.file_id};var s=function(e){return"fname"in e};t.userInitials=function(e){return s(e)?e.fname.substr(0,1)+e.lname.substr(0,1):e.name.given_name.substr(0,1)+e.name.surname.substr(0,1)},t.canEditOverviewForFile=function(e){return e.target_ns?null===e._mount_access_perms||!(!e._mount_access_perms||!e._mount_access_perms.includes("can_edit")):!e.read_only}}),define("modules/clean/react/growth/connected_checklist_banner",["require","exports","tslib","react","modules/core/browser","external/lodash","modules/core/i18n","premium-growth/checklist-banner","premium-growth/checklist-banner-item","modules/clean/react/css","modules/constants/trademark","modules/clean/analytics","modules/clean/api_v2/user_client"],function(e,t,r,o,n,i,s,a,l,c,d,u,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),n=r.__importStar(n),i=r.__importStar(i);t.fetchModules=function(e,t){return(new p.UserApiV2Client).ns("onboarding_tracker").rpc("get_checklist_modules_for_user",{},{subjectUserId:t.id})};var f=(function(e){function c(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={tracker:t.mapUserToTracker(t.props.user),modules:null,dimmed:!1},t}return r.__extends(c,e),c.prototype.mapUserToTracker=function(e){return e.is_team_admin?"team_creator_checklist_banner":"team_joiner_checklist_banner"},c.prototype.componentDidMount=function(){var e=this;t.fetchModules(this.state.tracker,this.props.user).then(function(t){return e.postFetchActions(t)})},c.prototype.componentDidUpdate=function(e,r){var o=this;e.user!==this.props.user&&this.setState({tracker:this.mapUserToTracker(this.props.user)}),r.tracker!==this.state.tracker&&t.fetchModules(this.state.tracker,this.props.user).then(function(e){return o.postFetchActions(e)})},c.prototype.postFetchActions=function(e){this.updateStateWithFetchedData(e),this.isUserEduEnabled()?this.setState({dimmed:!0}):this.logOnboardingChecklistImpression(e.modules)},c.prototype.isUserEduEnabled=function(){var e=n.get_uri().getQuery();return this.props.isUserEduEnabled||e&&!!e.uem_wop},c.prototype.logOnboardingChecklistImpression=function(e){var t={checklist_version:this.state.tracker,url:n.get_uri().path};e.forEach(function(e){t[e.name+"_status"]=e.completed?"complete":"incomplete"}),u.TeamsWebActionsLogger.log("onboarding_checklist_impression",t)},c.prototype.updateStateWithFetchedData=function(e){this.setState({modules:e.modules})},c.prototype.redirectToUrl=function(e){e&&n.redirect(e)},c.prototype.mapModulesToChecklistItems=function(e){var t=this;return null===e?i.range(3).map(function(e){return o.default.createElement(l.ChecklistBannerItem,{loaded:!1,key:e})}):e.map(function(e){return o.default.createElement(l.ChecklistBannerItem,{key:e.name,status:e.completed?"complete":"incomplete",title:e.label,onClick:function(){t.redirectToUrl(e.url)}})})},c.prototype.mapModulesToCopy=function(e,t){return null===e?{title:"",subtitle:""}:t.is_team_admin&&!i.some(e,"completed")?{title:s._("First things first"),subtitle:s._("We picked the most important tasks to get you started with %(trademark_business)s.").format({trademark_business:d.TRADEMARK_BUSINESS})}:{title:s._("Finish setting up"),subtitle:s._("You’re almost done getting up and running with %(trademark_business)s.").format({trademark_business:d.TRADEMARK_BUSINESS})}},c.prototype.render=function(){var e=this.state,t=e.modules,n=e.dimmed,i=this.props.user;return o.default.createElement(a.ChecklistBanner,r.__assign({loaded:!!t},this.props,this.mapModulesToCopy(t,i),{dimmed:n}),this.mapModulesToChecklistItems(t))},c})(o.default.PureComponent);t.OnboardingChecklistBanner=c.requireCssWithComponent(f,["/static/js/premium-growth/index.web-vflb9JTu1.css","/static/css/font_sharp_grotesk-vfle4tE4q.css"])}),define("modules/clean/react/growth/education_module_event_bridge",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=(function(){function e(){this.requestSectionHandler=null,this.requestSharingCalloutHandler=null}return e.prototype.registerRequestSectionHandler=function(e){this.requestSectionHandler=e},e.prototype.requestSection=function(e){this.requestSectionHandler&&this.requestSectionHandler(e)},e.prototype.registerRequestSharingCalloutHandler=function(e){this.requestSharingCalloutHandler=e},e.prototype.requestSharingCallout=function(){this.requestSharingCalloutHandler&&this.requestSharingCalloutHandler()},e})();t.educationEventBridge=new r});var __importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};define("modules/clean/react/growth/education_module_experiment",["require","exports","modules/clean/react/async/loadable","modules/clean/web_timing_logger","modules/clean/react/css"],function(e,t,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r.Loadable({loader:function(){return o.waitForTTI().then(function(){return new Promise(function(t,r){e(["modules/clean/react/growth/education_module_experiment_sync"],t,r)}).then(__importStar)}).then(function(e){return e.UnstyledEducationModuleExperiment})}});t.EducationModuleExperiment=n.requireCssWithComponent(i,["/static/js/premium-growth/index.web-vflb9JTu1.css","/static/css/growth/experiments/education_module_experiment-vflFlYQXJ.css","/static/css/font_sharp_grotesk-vfle4tE4q.css"])}),define("modules/clean/react/path_breadcrumbs",["require","exports","tslib","external/classnames","react","spectrum/icon_arrow","spectrum/icon_content","spectrum/popover","modules/clean/em_string","modules/clean/filepath","modules/clean/react/icon/icon_helper","modules/clean/react/title_bubble","modules/clean/user_education/react/user_education_effect","modules/clean/user_education/user_education_client","modules/clean/web_timing_logger","modules/core/i18n"],function(e,t,r,o,n,i,s,a,l,c,d,u,p,f,_,m){"use strict";function h(e,t,r){void 0===r&&(r=20);var o=t?2.625:new l.Emstring(e).length;return Math.max(r,20)-o}function S(e){return e>769?(e-417)/20:e/20}function g(e,t,r,o,n){void 0===n&&(n=20);for(var i=e.split("/").filter(Boolean),s=[{path:"",icon:"folder_dropbox-small",folderName:t,alt:r}],a=d.spectrumFolderIcon({size:d.SpectrumIconSize.Small}),u=0;u<i.length;u++)e="/"+i.slice(0,u+1).join("/"),s.push({path:e,folderName:c.filename(e),icon:a,alt:m._("Folder")});if(s.length<3)return{dropdownCrumbs:[],inlineCrumbs:s,root:s[0]};for(var p=s[0]&&s[0].folderName||"",f=h(p,!1,n),_=s.map(function(e){return new l.Emstring(e.folderName||"").length}),S=1,g=_[s.length-1],u=s.length-2;u>=1&&(g+=1.64,g+=_[u],!(g>f));u--)S+=1;s.length===S+1&&(S+=1),1===S&&o===E.SMALL&&S++;var v=s.length-S;return{dropdownCrumbs:s.slice(0,v),inlineCrumbs:s.slice(v),root:s[0]}}function v(e){switch(e){case E.LARGE:return"right";case E.SMALL:return"right-small"}}Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),n=r.__importDefault(n),c=r.__importStar(c);t.generateBreadcrumbData=g;var E;(function(e){e.LARGE="LARGE",e.SMALL="SMALL"})(E=t.PathBreadcrumbsSize||(t.PathBreadcrumbsSize={}));var w=(function(e){function t(t){var r=e.call(this,t)||this;r._breadcrumbContainerElement=null,r.resizeListener=function(){var e=r.getBreadcrumbsContainerSpan();if(e){var t=S(e.getBoundingClientRect().width);t!==r.state.maxWidthInEm&&r.setState({maxWidthInEm:t})}};var o=r.getBreadcrumbsContainerSpan();return r.state={maxWidthInEm:o?S(o.getBoundingClientRect().width):20},r}return r.__extends(t,e),t.prototype.getBreadcrumbsContainerSpan=function(){if(!this._breadcrumbContainerElement){var e=document.getElementsByClassName("maestro-app-content");e&&1===e.length&&(this._breadcrumbContainerElement=e[0])}return this._breadcrumbContainerElement},t.prototype.componentDidMount=function(){var e=this;window.addEventListener("resize",this.resizeListener),_.waitForTTI().then(function(){return e.resizeListener()})},t.prototype.componentWillUnmount=function(){window.removeEventListener("resize",this.resizeListener)},t.prototype.render=function(){var e=this.props.path,t=this.props,i=t.firstBreadcrumbName,s=t.firstBreadcrumbAlt,a=t.isDraggingInternalFiles,l=t.shouldHighlightDropTargets,d=t.setFileUploaderPath,u=t.getUrlForPath,f=t.setUrl,_=t.size,S=t.disableDragging,v=this.state.maxWidthInEm?this.state.maxWidthInEm:20,w=g(e,i,s,_,v),T=w.dropdownCrumbs,y=w.inlineCrumbs,C=w.root,I=h(C&&C.folderName||"",T.length>0,v),O=o.default({"brws-path-breadrumbs":!0,"brws-path-breadrumbs--small":this.props.size===E.SMALL}),R="page-header-text u-l-fl";return y.length>1||T.length>0?n.default.createElement("span",{className:O},n.default.createElement("h1",{className:"ax-visually-hidden"},c.filename(e)),n.default.createElement("nav",{className:R,id:"path-breadcrumbs","aria-label":m._("Folder hierarchy"),role:"navigation"},T.length>0&&n.default.createElement(F,{crumbs:T,currentPath:e,isDraggingInternalFiles:a,shouldHighlightDropTargets:l,setFileUploaderPath:d,setUrl:f,size:_,disableDragging:S}),y.map(function(t,o){return n.default.createElement(b,r.__assign({},t,{key:encodeURI(t.path),isOnlyCrumb:0===o&&1===y.length&&0===T.length,index:o,isLastCrumb:o===y.length-1,maxWidth:I,currentPath:e,isDraggingInternalFiles:a,isHighlightedDropTarget:l,setFileUploaderPath:d,getUrlForPath:u,setUrl:f,size:_,disableDragging:S}))}))):n.default.createElement("span",{className:O},n.default.createElement("h1",{className:R},n.default.createElement(p.UserEducationEffect,{containerName:"PathBreadcrumbs",name:"HomeTitle",useSpan:!0},i)))},t.defaultProps={path:"/",isDraggingInternalFiles:!1,shouldHighlightDropTargets:!1,setFileUploaderPath:function(){},size:E.LARGE,disableDragging:!1},t})(n.default.PureComponent);t.PathBreadcrumbs=w;var b=(function(e){function t(t){var r=e.call(this,t)||this;return r.onDragEnterBreadcrumb=function(e){e.preventDefault(),e.target!==r.lastEnteredElement&&(r.props.disableDragging||(r.lastEnteredElement=e.target,r.dragEnterCount+=1,r.setState({isDraggedOver:!0}),r.props.isLastCrumb||r.props.setFileUploaderPath({path:r.props.path})))},r.onDragLeaveBreadcrumb=function(e){e.preventDefault(),r.props.disableDragging||(r.lastEnteredElement=null,r.dragEnterCount-=1,r.dragEnterCount<1&&(r.dragEnterCount=0,r.state.isDraggedOver&&(r.props.setFileUploaderPath({path:r.props.currentPath}),r.setState({isDraggedOver:!1}))))},r.onDropBreadcrumb=function(){r.setState({isDraggedOver:!1})},r.onDragOverBreadcrumb=function(e){e.preventDefault(),e.stopPropagation()},r.handleMouseEnter=function(){r.props.isDraggingInternalFiles&&r.setState({isDraggedOver:!0})},r.handleMouseLeave=function(){r.state.isDraggedOver&&r.setState({isDraggedOver:!1})},r.handleMouseUp=function(){r.state.isDraggedOver&&r.setState({isDraggedOver:!1})},r.navigateToFolder=function(e){var t=r.props.path;f.UEClient.sendEvent("BreadCrumbSegment","linkClicked",{path:t}),e.preventDefault(),r.props.setUrl({path:t})},r.eventHandlers={onDragEnter:r.onDragEnterBreadcrumb,onDragLeave:r.onDragLeaveBreadcrumb,onDrop:r.onDropBreadcrumb,onDragOver:r.onDragOverBreadcrumb,onMouseEnter:r.handleMouseEnter,onMouseLeave:r.handleMouseLeave,onMouseUp:r.handleMouseUp},r.state={isDraggedOver:!1},r}return r.__extends(t,e),t.prototype.componentDidMount=function(){this.dragEnterCount=0,this.lastEnteredElement=null},t.prototype.render=function(){var e,t=this.props,s=t.getUrlForPath,a=t.path,c=t.index,d=t.isOnlyCrumb,f=t.maxWidth,_=t.isLastCrumb,m=t.isHighlightedDropTarget,h=t.size,S=d?this.props.folderName:l.Emstring.em_snippet(this.props.folderName,f),g={"breadcrumb-segment":!0,"breadcrumb-segment--is-drop-target":!_&&m,"breadcrumb-segment--file-dragged-over":!_&&this.state.isDraggedOver},E=v(h);return e=_?n.default.createElement("span",r.__assign({"aria-current":"page"},this.eventHandlers),S):n.default.createElement("span",r.__assign({className:"breadcrumb-segment__wrapper"},this.eventHandlers),n.default.createElement(p.UserEducationEffect,{containerName:"BreadCrumbSegment",name:"link-"+c,useSpan:!0},n.default.createElement("a",{href:s(a).toString(),onClick:this.navigateToFolder,className:o.default(g)},S)),n.default.createElement(i.IconArrow,{name:E})),this.props.folderName!==S?n.default.createElement(u.TitleBubble,{content:this.props.folderName,position:u.TitleBubble.POSITIONS.BOTTOM,className:"list-label__title-bubble"},e):e},t.defaultProps={isOnlyCrumb:!1,isDraggingInternalFiles:!1,isHighlightedDropTarget:!1,disableDragging:!1},t})(n.default.Component),T=(function(e){function t(t){var r=e.call(this,t)||this;return r.onDragEnter=function(e){e.preventDefault(),
e.target!==r.lastEnteredElement&&(r.props.disableDragging||(r.lastEnteredElement=e.target,r.dragEnterCount+=1,r.setState({isDraggedOver:!0}),r.props.setFileUploaderPath({path:r.props.path})))},r.onDragLeave=function(e){e.preventDefault(),r.props.disableDragging||(r.lastEnteredElement=null,r.dragEnterCount-=1,r.dragEnterCount<1&&(r.dragEnterCount=0,r.state.isDraggedOver&&(r.props.setFileUploaderPath({path:r.props.currentPath}),r.setState({isDraggedOver:!1}))))},r.onDrop=function(e){r.setState({isDraggedOver:!1}),r.dragEnterCount=0,r.props.closeFunc()},r.onDragOver=function(e){e.preventDefault(),e.stopPropagation()},r.handleMouseEnter=function(){r.props.isDraggingInternalFiles&&r.setState({isDraggedOver:!0})},r.handleMouseLeave=function(){r.state.isDraggedOver&&(r.setState({isDraggedOver:!1}),r.props.closeFunc())},r.handleMouseUp=function(){r.state.isDraggedOver&&r.setState({isDraggedOver:!1}),r.props.isDraggingInternalFiles&&!r.props.isLastCrumb&&r.props.closeFunc()},r.state={isDraggedOver:!1},r}return r.__extends(t,e),t.prototype.componentDidMount=function(){this.dragEnterCount=0,this.lastEnteredElement=null},t.prototype.render=function(){var e=this.props,t=e.icon,i=e.alt,l=e.folderName,c={"breadcrumb-menu-item":!0,"breadcrumb-menu-item--is-drop-target":this.props.isHighlightedDropTarget,"breadcrumb-menu-item--file-dragged-over":this.state.isDraggedOver},d=n.default.createElement("span",{title:l,className:"breadcrumb-menu-item-wrapper"},n.default.createElement("span",{className:"breadcrumb-menu-item-icon"},n.default.createElement(s.IconContent,{name:t,"aria-label":i,role:"img"})),n.default.createElement("span",{className:"breadcrumb-menu-item-text"},l));return n.default.createElement(a.PopoverContentItem,r.__assign({value:this.props.path,className:o.default(c)},{onDragEnter:this.onDragEnter,onDragLeave:this.onDragLeave,onDrop:this.onDrop,onDragOver:this.onDragOver,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,onMouseUp:this.handleMouseUp}),d)},t.defaultProps={isHighlightedDropTarget:!1,closeFunc:function(){},alt:"",isDraggingInternalFiles:!1,disableDragging:!1},t})(n.default.Component),F=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={menuVisible:!1},t.onDragEnter=function(e){t.props.disableDragging||(e.preventDefault(),t.setState({menuVisible:!0}))},t.onInnerDragEnter=function(e){e.preventDefault(),t.dragEnterCount++},t.onDragLeave=function(e){e.preventDefault(),t.dragEnterCount--,t.dragEnterCount<1&&(t.dragEnterCount=0,t.state.menuVisible&&t.setState({menuVisible:!1}))},t.onMouseEnter=function(e){t.props.disableDragging||t.props.isDraggingInternalFiles&&!t.props.disableDragging&&(e.preventDefault(),t.setState({menuVisible:!0}))},t.onCrumbSelected=function(e){t.props.setUrl({path:e})},t.onPopoverToggle=function(e){var r=e.isOpen;t.setState({menuVisible:r})},t.onClose=function(){t.dragEnterCount=0,t.onPopoverToggle({isOpen:!1})},t}return r.__extends(t,e),t.prototype.componentDidMount=function(){this.dragEnterCount=0},t.prototype.render=function(){var e=this,t=this.props.crumbs.slice().reverse(),r=this.props,o=r.currentPath,l=r.shouldHighlightDropTargets,c=r.isDraggingInternalFiles,d=r.setFileUploaderPath,u=r.size,p=r.disableDragging,f=m._("Show parent folders (descending)"),_=n.default.createElement(s.IconContent,{name:"folder_dropdown-small","aria-label":f,role:"img",className:"breadcrumb-menu-icon"}),h=v(u);return n.default.createElement(a.Popover,{onSelection:this.onCrumbSelected,onMenuToggle:this.onPopoverToggle,className:"breadcrumb-dropdown-container"},n.default.createElement(a.PopoverTrigger,{onDragOver:this.onDragEnter,onMouseEnter:this.onMouseEnter,tag:"button"},n.default.createElement("span",{className:"u-unbutton breadcrumb-overflow-button u-l-fl"},_)),n.default.createElement(a.PopoverContent,{isRevealed:this.state.menuVisible,onDragEnter:this.onInnerDragEnter,onDragLeave:this.onDragLeave},t.map(function(t){return n.default.createElement(T,{key:encodeURI(t.path),path:t.path,icon:t.icon,alt:t.alt,folderName:t.folderName,currentPath:o,isHighlightedDropTarget:l,isDraggingInternalFiles:c,setFileUploaderPath:d,closeFunc:e.onClose,disableDragging:p})})),n.default.createElement(i.IconArrow,{name:h,className:"breadcrumb__spacer"}))},t.defaultProps={shouldHighlightDropTargets:!1,isDraggingInternalFiles:!1,disableDragging:!1},t})(n.default.Component)}),define("modules/clean/react/share_download/api",["require","exports","tslib","modules/clean/ajax_as_promised"],function(e,t,r,o){"use strict";function n(e){return r.__awaiter(this,void 0,void 0,function(){var t,n;return r.__generator(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,o.SilentBackgroundRequest({url:e})];case 1:return t=r.sent(),[3,3];case 2:throw n=r.sent(),new a;case 3:if("OK"!==t)throw 0===t.indexOf("err:")?new l:new a;return[2]}})})}function i(e){return o.SilentBackgroundRequest({url:"/sharing/fetch_user_content_link",data:{url:e}})}Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o);var s=(function(){function e(e){this.message=e}return e})(),a=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t})(s);t.DownloadError=a;var l=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t})(a);t.TooLargeError=l,t.testDownload=n,t.fetchDownloadUrl=i}),define("modules/clean/react/snackbar_manager",["require","exports","tslib","react","external/lodash","modules/clean/react/portal","modules/clean/react/snackbar","modules/core/accessible_announce","modules/core/exception","modules/clean/analytics"],function(e,t,r,o,n,i,s,a,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),n=r.__importStar(n),l=r.__importStar(l);var d=(function(e){function t(t){var r=e.call(this,t)||this;return r.handleActionClick=function(){var e=r.state,t=e.displayedSnackbar,o=e.queue;if(t){var n=o[0].onActionClick;n&&n()}},r.handleCloseClick=function(){var e=r.dequeue();e&&(e.richSnackBarProps&&c.TeamsWebActionsLogger.log("edu_rich_confirmation_clk_close",e.richSnackBarProps.extraLogInfo),e.onCloseClick&&e.onCloseClick())},r.handleTimeout=function(){var e=r.dequeue();e&&e.onTimeout&&e.onTimeout()},r.getAccessibleAnnouncement=function(e){return e.accessibleAnnouncement?e.accessibleAnnouncement:"string"==typeof e.title?e.title:null},r.state={queue:[],displayedSnackbar:null,isVisible:!0},r}return r.__extends(t,e),t.prototype.showContainer=function(){this.setState({isVisible:!0})},t.prototype.hideContainer=function(){this.setState({isVisible:!1})},t.prototype.show=function(e){e.id||l.reportStack("Missing `id` in Snackbar.show",{severity:l.SEVERITY.NONCRITICAL}),this.update(e)},t.prototype.update=function(e){e.id||l.reportStack("Missing `id` in Snackbar.update",{severity:l.SEVERITY.NONCRITICAL});var t=this.state.queue,r=n.findIndex(t,function(t){return t.id===e.id});if(r===-1)return void this.enqueue(e);0===r&&this.displayNewSnackbar(e);var o=t.slice();o[r]=e,this.setState({queue:o})},t.prototype.close=function(e){e||l.reportStack("Missing `id` in Snackbar.close",{severity:l.SEVERITY.NONCRITICAL}),this.dequeue(e)},t.prototype.displayNewSnackbar=function(e){var t=o.default.createElement(s.ControlledSnackbar,r.__assign({},e,{onActionClick:this.handleActionClick,onCloseClick:this.handleCloseClick,onTimeout:this.handleTimeout,key:e.id})),n=this.getAccessibleAnnouncement(e);if(n)if(this.state.displayedSnackbar){var i=this.getAccessibleAnnouncement(this.state.displayedSnackbar.props);n!==i&&a.AccessibleAnnounce.polite(n)}else a.AccessibleAnnounce.polite(n);this.setState({displayedSnackbar:t})},t.prototype.enqueue=function(e){var t=this.state.queue,o=r.__assign({id:Date.now().toString()},e);if(t.length||this.displayNewSnackbar(o),o.isLowPriority)return void this.setState({queue:t.concat([o])});var i=n.findIndex(t,function(e){return!!e.isLowPriority});i===-1?this.setState({queue:t.concat([o])}):0===i?(this.setState({queue:[o].concat(t)}),this.displayNewSnackbar(o)):this.setState({queue:t.slice(0,i).concat([o],t.slice(i))})},t.prototype.dequeue=function(e){var t=this.state.queue,r=e?n.findIndex(t,function(t){return t.id===e}):0,o=t[r];if(o)return t.length>1?(this.setState({queue:t.slice(0,r).concat(t.slice(r+1))}),0===r&&this.displayNewSnackbar(t[1])):this.setState({queue:[],displayedSnackbar:null}),o},t.prototype.render=function(){var e=this.state,t=e.displayedSnackbar,r=e.isVisible;if(!t||!r)return null;var n=this.props.getParentElement?this.props.getParentElement():void 0;return o.default.createElement(i.Portal,{className:"snackbar-container",parentElement:n},t)},t})(o.default.PureComponent);t.SnackbarManager=d}),define("modules/clean/redux/tests/store",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mockExtraArguments=function(){return{}}}),define("modules/clean/search/api",["require","exports","tslib","modules/clean/ajax","modules/clean/analytics","modules/clean/react/browse/models","modules/clean/search/api_helpers","modules/clean/search/constants","modules/clean/search/models","modules/clean/search/search_helpers","modules/clean/search/types"],function(e,t,r,o,n,i,s,a,l,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),a=r.__importStar(a),c=r.__importStar(c);var u=(function(){function e(){this._activeRequest=null,this._activeSuggestionRequest=null}return e.prototype.abortPreviousLoading=function(){null!=this._activeRequest&&this._activeRequest.abort()},e.prototype.loadResults=function(e){var t=e.user,r=e.path,o=e.query,n=e.start,i=e.maxResults,l=e.searchSessionId,d=e.nsId,u=e.fileNameOnly,p=e.loadDeleted,f=e.showPaperResults,_=e.isDropdown,m=e.isAdminConsole,h=e.webTimer,S=e.onSuccess,g=e.onError,v=e.overrideUrl,E=e.searchResultsExperiments,w=s.getCurrentTimezoneOffset(),b={query:o,search_token:c.getSearchCsrfToken(),fq_path:r,ns_id:d,filename_only:!!u,max_results:i,deleted:!!p,start:n,show_paper_results:!!f,is_dropdown:!!_,is_admin_console:!!m,show_unmounted_results:!0,timezone_offset:w,include_browse_context:!0,calculate_folder_size:!!E.expFolderCalcSize,include_shared_docs:!0,include_snippets:!!E.expSnippets},T=v?v:a.SEARCH_FRONTEND_SERVICE_ENDPOINT;this._fetchResults({requestData:b,user:t,searchSessionId:l,url:T,onSuccess:S,onError:g,webTimer:h})},e.prototype._extractSearchResultsList=function(e){for(var t=[],r=0,o=e;r<o.length;r++){var n=o[r];switch(n.search_result_type){case d.SearchResultTypes.FILE:t.push(i.File.fromServerObject(n));break;case d.SearchResultTypes.FILE_SHARED_WITH_ME:t.push(i.FileSharedWithMe.fromServerObject(n));break;case d.SearchResultTypes.PAPER:t.push(i.Paper.fromServerObject(n));break;case d.SearchResultTypes.PAPER_FOLDER:t.push(i.PaperFolder.fromServerObject(n))}}return t},e.prototype._getSearchType=function(e){return e.is_image_content_search?"image_search":e.is_dropdown?"dropdown":e.deleted?"full_page_deleted":"full_page"},e.prototype.loadPartialResults=function(e){var t=this,o=e.user,n=e.maxResults,i=e.start,s=e.path,l=e.query,d=e.fileCategories,u=e.isPaperEnabled,p=void 0===u||u,f=e.searchSessionId,_=e.includeBrowseContext,m=e.webTimer,h=e.sortOrder,S=e.searchType,g=e.getSuggestion,v=e.onSuccess,E=e.onError,w=e.searchResultsExperiments,b=e.skipLogging,T=e.deleted,F=e.filteredAccountId,y=e.artificialLatency;S===a.SearchType.IMAGE&&(d=void 0);var C=d&&!c.allCategoriesChecked(d,p)?c.fileCategoriesToString(d):"",I=h?c.sortFieldToOrderBy(h.sortField):"",O=h?c.sortDirectionToReverseOrder(h.sortDirection):"",R=r.__assign({query:l,search_token:c.getSearchCsrfToken(),fq_path:s,start:i,max_results:n,deleted:T,show_paper_results:S!==a.SearchType.IMAGE,include_browse_context:_,search_session_id:f,calculate_folder_size:!!w.expFolderCalcSize},C&&{file_categories:C},{is_image_content_search:S===a.SearchType.IMAGE,is_prompt_request:g,order_by:I,reverse_order:O,include_shared_docs:!0,include_snippets:!!w.expSnippets&&S===a.SearchType.ALL,user_filter_account_id:F}),P=function(){t._fetchResults({requestData:R,user:o,searchSessionId:f,url:a.SEARCH_FRONTEND_SERVICE_ENDPOINT,onSuccess:v,onError:E,webTimer:m,skipLogging:b,getSuggestion:g})};y?setTimeout(function(){P()},y):P()},e.prototype._fetchResults=function(e){var t=this,r=e.requestData,i=e.user,s=e.searchSessionId,a=e.url,d=e.onSuccess,u=e.onError,p=e.webTimer,f=e.skipLogging,_=e.getSuggestion;if(_?null!==this._activeSuggestionRequest&&this._activeSuggestionRequest.abort():null!=this._activeRequest&&this._activeRequest.abort(),""!==r.query||r.user_filter_account_id){var m=c.fileCategoryStringToLogValue(r.file_categories),h={path_scoped:"/"!==r.fq_path,search_type:this._getSearchType(r),query_string:r.query,start:r.start,search_session_id:s,timezone_offset:r.timezone_offset,file_type_filters:m,user_filter_account_id:r.user_filter_account_id};f||n.SearchClientActivityLogger.log("query_started",i.id,h);var S=(new Date).getTime(),g=o.WebRequest({url:a,data:r,dataType:"json",subject_user:i,success:function(e,o,a){var c;r.include_browse_context&&(c=l.extractBrowseContext(e));var u=e.search_results,_=a.getResponseHeader("x-dropbox-request-id");u.forEach(function(e){return e.request_id=_});var m={results:t._extractSearchResultsList(u),hasMore:!!e.more,nextPageOffset:+e.next_offset||0};if(d({context:c,searchResults:m,deleted:!!r.deleted,requestId:_}),!f){var g=n.SearchClientActivityLogger.create_search_log_dict(h,_,S,r.query,m.results.length,null,s);n.SearchClientActivityLogger.log("query_completed",i.id,g)}p&&p.end(_?_:void 0)},error:function(e,t,o){var a=e.getResponseHeader("x-dropbox-request-id");if("abort"!==t&&"function"==typeof u&&u(o,a),!f){var l=n.SearchClientActivityLogger.create_search_log_dict(h,a,S,r.query,null,t,s);n.SearchClientActivityLogger.log("query_failed",i.id,l)}p&&p.abort()},complete:function(){_?this._activeSuggestionRequest=null:this._activeRequest=null}});_?this._activeSuggestionRequest=g:this._activeRequest=g}},e.prototype.fetchAdditionalFileMetadata=function(e){var t=e.searchResults,r=e.user,n=e.onSuccess,s=e.onError,l=t.filter(function(e){return e instanceof i.File}),c=l.map(function(e){return[e.ns_id,e.sjid,e.fq_path.substr(0,e.fq_path.length-e.ns_path.length)]});c.length>0&&o.WebRequest({url:a.FILE_INFO_ENDPOINT,data:{nsid_sjid_fq_mount_point_tuples:JSON.stringify(c)},dataType:"json",subject_user:r,success:function(e,t,r){for(var o=e.file_results,i=[],s=0,a=o;s<a.length;s++){var l=a[s];i.push(l)}n(i)},error:function(e,t,r){"abort"!==t&&"function"==typeof s&&s(r,e.getResponseHeader("x-dropbox-request-id"))}})},e})();t.SearchApiClient=u,t.searchApiClient=new u}),define("modules/clean/search/single_page/data/types",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e.SET_USER="SEARCH/SET_USER",e.SET_EXPERIMENTS="SEARCH/SET_EXPERIMENTS",e.SET_PATH="SEARCH/SET_PATH",e.SET_QUERY="SEARCH/SET_QUERY",e.SET_FILE_CATEGORIES="SEARCH/SET_FILE_CATEGORIES",e.SET_RESULTS="SEARCH/SET_RESULTS",e.CLEAR_RESULTS="SEARCH/CLEAR_RESULTS",e.APPEND_RESULTS="SEARCH/APPEND_RESULTS",e.SET_LOADING_STATE="SEARCH/SET_LOADING_STATE",e.SET_SESSION_ID="SEARCH/SET_SESSION_ID",e.SET_REQUEST_ID="SEARCH/SET_REQUEST_ID",e.SET_SELECTION="SEARCH/SET_SELECTION",e.SET_PREVIEW_FILE_ID="SEARCH/SET_PREVIEW_FILE",e.SET_SORT_ORDER="SEARCH/SET_SORT_ORDER",e.SET_CACHED_FULL_RESULTS="SEARCH/SET_CACHED_FULL_RESULTS",e.SET_CACHED_FULL_RESULTS_SORT_FIELD="SEARCH/SET_CACHED_FULL_RESULTS_SORT_FIELD",e.ADD_TTI_COMPONENT="SEARCH/ADD_TTI_COMPONENT",e.CLEAR_TTI_COMPONENTS="SEARCH/CLEAR_TTI_COMPONENTS",e.SET_LOADING_DELETED_RESULTS="SEARCH/SET_LOADING_DELETED_RESULTS",e.SET_SEARCH_TYPE="SEARCH/SET_SEARCH_TYPE",e.SET_IMAGE_SUGGESTION="SEARCH/SET_IMAGE_SUGGESTION",e.UPDATE_FILE_IN_RESULTS="SEARCH/UPDATE_FILE_IN_RESULTS",e.UPDATE_RESULTS="SEARCH/UPDATE_RESULTS",e.REMOVE_RESULTS="SEARCH/REMOVE_RESULTS",e.RENAME_FILE="SEARCH/RENAME_FILE",e.DELETE_FILES="SEARCH/DELETE_FILES",e.PURGE_FILES="SEARCH/PURGE_FILES",e.RESTORE_FILES="SEARCH/RESTORE_FILES",e.SET_QUERY_HISTORY="SEARCH/SET_QUERY_HISTORY",e.SET_SUGGESTION_HIGHLIGHT_ROW="SEARCH/SET_SUGGESTION_HIGHLIGHT_ROW",e.UPDATE_QUERY_SUGGESTIONS_CACHE="SEARCH/UPDATE_QUERY_SUGGESTIONS_CACHE",e.SET_LAST_QUERY_WITH_QUERY_SUGGESTIONS_LOADED="SEARCH/SET_LAST_QUERY_WITH_QUERY_SUGGESTIONS_LOADED",e.SET_FILTERED_ACCOUNT_ID="SEARCH/SET_FILTERED_ACCOUNT_ID",e.UPDATE_PEOPLE_SUGGESTIONS_CACHE="SEARCH/UPDATE_PEOPLE_SUGGESTIONS_CACHE",e.SET_LAST_QUERY_WITH_PEOPLE_SUGGESTIONS_LOADED="SEARCH/SET_LAST_QUERY_WITH_PEOPLE_SUGGESTIONS_LOADED",e.SET_DWELL_TIME="SEARCH/SET_DWELL_TIME"})(t.ActionTypes||(t.ActionTypes={}))}),define("modules/clean/sharing/shared_folder_invite/shared_folder_invite_async",["require","exports","tslib","modules/clean/react/async/loadable","modules/clean/web_timing_logger"],function(e,t,r,o,n){"use strict";var i=this;Object.defineProperty(t,"__esModule",{value:!0}),t.AsyncSharedFolderInvite=o.Loadable({loader:function(){return r.__awaiter(i,void 0,void 0,function(){var t;return r.__generator(this,function(o){switch(o.label){case 0:return[4,n.waitForTTI()];case 1:return o.sent(),[4,new Promise(function(t,r){e(["modules/clean/sharing/shared_folder_invite/shared_folder_invite"],t,r)}).then(r.__importStar)];case 2:return t=o.sent().SharedFolderInvite,[2,t]}})})}})}),define("modules/clean/upsell/top_notification_listener",["require","exports","modules/clean/upsell/prompt_event_emitter"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createTopNotificationListener=function(e){var t=function(t){return function(r){"TOP_NOTIFICATION"===r&&e(t)}},o=t(!0),n=t(!1);return r.promptBufferedEventEmitter.on(r.Events.ON_PROMPT_SHOWN,o),r.promptBufferedEventEmitter.on(r.Events.ON_PROMPT_DISMISSED,n),{unsubscribe:function(){r.promptBufferedEventEmitter.off(r.Events.ON_PROMPT_SHOWN,o),r.promptBufferedEventEmitter.off(r.Events.ON_PROMPT_DISMISSED,n)}}}}),define("modules/clean/web_upload_action_logger",["require","exports","tslib","modules/clean/ajax"],function(e,t,r,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),t.MAX_ERRORS=3;var n=(function(){function e(){this.errorCount=0,this.lastError=Date.now(),this.shouldReport=!0}return e.prototype.log=function(e,r,n){var i=this;return this.shouldReport&&(this.errorCount<t.MAX_ERRORS||Date.now()-this.lastError>6e5)?new Promise(function(s,a){o.SilentBackgroundRequest({url:"/log/web_upload_action",data:{_subject_uid:e,event_type:r,extra_params:JSON.stringify(n)},error:function(e){429===e.status?i.errorCount=t.MAX_ERRORS:i.errorCount++,i.lastError=Date.now(),a(e)},success:function(e){try{var t=JSON.parse(e);t&&!t.continue_sending&&(i.shouldReport=!1),i.errorCount=0,s(e)}catch(e){throw i.errorCount++,i.lastError=Date.now(),a(e),e}}})}):Promise.resolve({})},e})();t.WebUploadActionLog=new n,t.WebUploadActionLogClass=n}),define("premium-growth/checklist-banner-item",["require","exports","tslib","react","spectrum/button","premium-growth/classnames","premium-growth/user-education-icons","premium-growth/loading-placeholder"],function(e,t,r,o,n,i,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),i=r.__importDefault(i),t.ChecklistBannerItem=function(e){var t=e.onClick,r=e.status,l=e.title,c=e.loaded,d=void 0===c?!!r||!!l:c,u="complete"===r?s.CheckInCircleSvg:s.ArrowInCircleSvg;return o.default.createElement("div",{className:"checklist-banner-item"},d?o.default.createElement(n.Button,{className:i.default("checklist-banner-item__button","checklist-banner-item__button--"+r),onClick:t,variant:"styleless"},o.default.createElement("div",{className:"checklist-banner-item__body"},o.default.createElement("div",{className:i.default("checklist-banner-item__text ","checklist-banner-item__text--"+r)},l),o.default.createElement("div",{className:"checklist-banner-item__spacer"}),o.default.createElement(u,{className:"checklist-banner-item__icon"}))):o.default.createElement(a.LoadingPlaceholder,null))}}),define("premium-growth/checklist-banner",["require","exports","tslib","react","premium-growth/classnames","premium-growth/loading-placeholder"],function(e,t,r,o,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),n=r.__importDefault(n),t.ChecklistBanner=function(e){var t=e.children,r=e.subtitle,s=e.title,a=e.loaded,l=void 0===a?!!s||!!r:a,c=e.dimmed,d=n.default("checklist-banner",{"is-dimmed":c});return o.default.createElement("div",{className:d},o.default.createElement("div",{className:"checklist-banner__copy"},l?o.default.createElement("div",{className:"checklist-banner__title"},s):o.default.createElement(i.LoadingPlaceholder,{className:"checklist-banner__title-loading"}),l?o.default.createElement("div",{className:"checklist-banner__subtitle"},r):o.default.createElement(i.LoadingPlaceholder,{className:"checklist-banner__subtitle-loading"})),o.default.createElement("div",{className:"checklist-banner__items"},t))}}),define("premium-growth/classnames",["require","exports"],function(e,t){"use strict";function r(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=[],i=0;i<e.length;i++){var s=e[i];if(s)if("string"==typeof s||"number"==typeof s)n.push(s);else if(Array.isArray(s)&&s.length){var a=r.apply(null,s);a&&n.push(a)}else if("object"==typeof s)for(var l in s)o.call(s,l)&&s[l]&&n.push(l)}return n.join(" ")}Object.defineProperty(t,"__esModule",{value:!0});var o={}.hasOwnProperty;t.default=r}),define("premium-growth/loading-placeholder",["require","exports","tslib","react","premium-growth/classnames"],function(e,t,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),n=r.__importDefault(n),t.LoadingPlaceholder=function(e){var t=e.className;return o.default.createElement("div",{className:n.default("loading-placeholder",t)})}}),define("premium-growth/user-education-icons",["require","exports","tslib","react","premium-growth/classnames"],function(e,t,r,o,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),n=r.__importDefault(n),t.ArrowInCircleSvg=function(e){var t=e.className;return o.default.createElement("svg",{className:n.default("icon","icon__arrow",t),viewBox:"0 0 35 35"},o.default.createElement("path",{d:"M21.6270544,16.4260476 L9.125,16.4260476 C8.50367966,16.4260476 8,16.9658974\n                8,17.6318359 C8,18.2977745 8.50367966,18.8376243 9.125,18.8376243\n                L21.6270544,18.8376243 L18.0498997,22.2052624 C17.5497138,22.676152\n                17.5497138,23.439615 18.0498997,23.9105046 C18.5500856,24.3813943\n                19.3610472,24.3813943 19.8612331,23.9105046 L25.3936666,18.7021098\n                C25.753622,18.5013092 25.9995453,18.0980226 25.9999994,17.6331258\n                C26.0000002,17.6322659 26.0000002,17.631406 25.9999993,17.630546\n                C25.9995453,17.1656493 25.753622,16.7623627 25.3936666,16.561562\n                L19.8612331,11.3531672 C19.3610472,10.8822776 18.5500856,10.8822776\n                18.0498997,11.3531672 C17.5497138,11.8240569 17.5497138,12.5875198\n                18.0498997,13.0584095 L21.6270544,16.4260476 Z M17.5,35 C7.83501688,35\n                0,27.1649831 0,17.5 C0,7.83501688 7.83501688,0 17.5,0 C27.1649831,0\n                35,7.83501688 35,17.5 C35,27.1649831 27.1649831,35 17.5,35 Z"}))},t.CheckInCircleSvg=function(e){var t=e.className;return o.default.createElement("svg",{className:n.default("icon","icon__check-circle",t),viewBox:"0 0 35 35"},o.default.createElement("path",{d:"M15.75,20.1286797 L13.2928932,17.6715729 C12.7071068,17.0857864\n                11.7573593,17.0857864 11.1715729,17.6715729 C10.5857864,18.2573593\n                10.5857864,19.2071068 11.1715729,19.7928932 L14.7071068,23.3284271\n                C15.2928932,23.9142136 16.2426407,23.9142136 16.8284271,23.3284271\n                C16.9289209,23.2279334 17.0121746,23.116728 17.0781882,22.9984862\n                C17.1630264,22.9429118 17.2434703,22.87785 17.3180195,22.8033009\n                L25.8033009,14.3180195 C26.3890873,13.732233 26.3890873,12.7824856\n                25.8033009,12.1966991 C25.2175144,11.6109127 24.267767,11.6109127\n                23.6819805,12.1966991 L15.75,20.1286797 Z M17.5,35 C7.83501688,35\n                0,27.1649831 0,17.5 C0,7.83501688 7.83501688,0 17.5,0 C27.1649831,0\n                35,7.83501688 35,17.5 C35,27.1649831 27.1649831,35 17.5,35 Z"}))}}),define("retrieval-components/collapsable-section",["require","exports","tslib","react","classnames","spectrum/button"],function(e,t,r,o,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),n=r.__importDefault(n),t.CollapsableSection=function(e){var t=e.title,r=e.isOpen,s=e.onHeaderClick,a=e.children,l=e.top,c=e.strings,d=e.containerClassName;return o.default.createElement("div",{className:n.default({"rc-collapsable-section":!0,"rc-collapsable-section--closed":!r}),style:{top:l}},o.default.createElement("h2",{className:"rc-collapsable-section__header"},o.default.createElement("span",null,t),o.default.createElement(i.Button,{onClick:s,className:"rc-collapsable-section__toggle",variant:"styleless"},r?c.buttonClose:c.buttonOpen)),o.default.createElement("div",{className:d,style:{display:r?void 0:"none"}},a))}}),define("retrieval-components/highlighted-truncated-string/em-string",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=(function(){function e(t){if(!(this instanceof e))return new e(t);this.s=t,this.info=this.widthInfo(),this.length=t.length?this.info[this.s.length-1]:0}return e.initClass=function(){this.ACCURACY=2,this.CODEPOINT_TO_WIDTH={32:38,33:25,34:42,35:67,36:58,37:92,38:75,39:25,40:33,41:33,42:58,43:58,44:25,45:33,46:25,47:42,48:58,49:58,50:58,51:58,52:58,53:58,54:58,55:58,56:58,57:58,58:25,59:25,60:58,61:58,62:58,63:50,64:100,65:67,66:67,67:67,68:75,69:58,70:58,71:75,72:83,73:33,74:25,75:67,76:58,77:100,78:83,79:83,80:67,81:83,82:67,83:58,84:58,85:75,86:67,87:100,88:67,89:58,90:58,91:33,92:42,93:33,94:58,95:50,96:67,97:58,98:67,99:50,100:67,101:58,102:33,103:58,104:67,105:25,106:25,107:58,108:25,109:100,110:67,111:67,112:67,113:67,114:42,115:50,116:42,117:67,118:58,119:83,120:58,121:58,122:50,123:42,124:58,125:42,126:58,161:25,162:58,163:58,164:58,165:58,166:58,167:58,168:67,169:92,170:42,171:50,172:58,174:92,175:58,176:50,177:58,178:42,179:42,180:67,181:67,182:75,183:25,184:25,185:42,186:42,187:50,188:83,189:83,190:83,191:50,192:67,193:67,194:67,195:67,196:67,197:67,198:92,199:67,200:58,201:58,202:58,203:58,204:33,205:33,206:33,207:33,208:75,209:83,210:83,211:83,212:83,213:83,214:83,215:58,216:83,217:75,218:75,219:75,220:75,221:58,222:67,223:67,224:58,225:58,226:58,227:58,228:58,229:58,230:92,231:50,232:58,233:58,234:58,235:58,236:25,237:25,238:25,239:25,240:67,241:67,242:67,243:67,244:67,245:67,246:67,247:58,248:67,249:67,250:67,251:67,252:67,253:58,254:67,255:58,256:75,257:67,258:75,259:67,260:75,261:67,262:75,263:58,264:75,265:58,266:75,267:58,268:75,269:58,270:83,271:83,272:83,273:75,274:67,275:67,276:67,277:67,278:67,279:67,280:67,281:67,282:67,283:67,284:83,285:75,286:83,287:75,288:83,289:75,290:83,291:75,292:83,293:75,294:92,295:75,296:33,297:33,298:33,299:33,300:33,301:33,302:33,303:33,304:33,305:25,306:67,307:67,308:42,309:33,310:75,311:67,312:67,313:58,314:33,315:58,316:33,317:58,318:42,319:58,320:50,321:67,322:42,323:83,324:75,325:83,326:75,327:83,328:75,329:83,330:83,331:75,332:92,333:67,334:92,335:67,336:92,337:67,338:100,339:100,340:75,341:50,342:75,343:50,344:75,345:50,346:67,347:58,348:67,349:58,350:67,351:58,352:67,353:58,354:75,355:42,356:75,357:42,358:75,359:42,360:83,361:75,362:83,363:75,364:83,365:75,366:83,367:75,368:83,369:75,370:83,371:75,372:100,373:92,374:75,375:58,376:75,377:67,378:67,379:67,380:67,381:67,382:67,383:42,384:75,385:83,386:67,387:75,388:75,389:67,390:75,391:83,392:58,393:83,394:100,395:67,396:75,397:67,398:67,399:75,400:58,401:58,402:75,403:83,404:75,405:100,406:50,407:50,408:75,409:67,410:50,411:67,412:117,413:83,414:75,415:92,416:92,417:75,418:117,419:100,420:75,421:75,422:75,423:67,424:58,425:67,426:58,427:42,428:75,429:42,430:75,431:83,432:75,433:92,434:83,435:75,436:75,437:67,438:67,439:67,440:67,441:58,442:58,443:75,444:75,445:58,446:50,447:67,448:33,449:50,450:50,451:33,452:142,453:142,454:133,455:100,456:92,457:67,458:117,459:117,460:100,461:75,462:67,463:33,464:33,465:92,466:67,467:83,468:75,469:83,470:75,471:83,472:75,473:83,474:75,475:83,476:75,477:67,478:75,479:67,480:75,481:67,482:100,483:100,484:92,485:75,486:83,487:75,488:75,489:67,490:92,491:67,492:92,493:67,494:67,495:58,496:33,497:142,498:142,499:133,500:83,501:75,502:117,503:67,504:83,505:75,506:75,507:67,508:100,509:100,510:92,511:67,512:75,513:67,514:75,515:67,516:67,517:67,518:67,519:67,520:33,521:33,522:33,523:33,524:92,525:67,526:92,527:67,528:75,529:50,530:75,531:50,532:83,533:75,534:83,535:75,536:67,537:58,538:75,539:42,540:58,541:58,542:83,543:75,544:83,545:100,546:92,547:67,548:67,549:67,550:75,551:67,552:67,553:67,554:92,555:67,556:92,557:67,558:92,559:67,560:92,561:67,562:75,563:58,564:67,565:100,566:67,567:33,568:100,569:100,570:75,571:75,572:58,573:58,574:67,575:58,576:58,577:67,578:50,579:75,580:75,581:75,582:75,583:58,584:58,585:25,586:83,587:58,588:75,589:33,590:75,591:58,880:67,881:50,882:67,883:50,884:33,885:33,886:75,887:67,888:108,889:108,890:67,891:58,892:58,893:58,894:42,895:108,896:108,897:108,898:108,899:108,900:67,901:67,902:75,903:42,904:83,905:100,906:58,907:108,908:100,909:108,910:100,911:100,912:42,913:75,914:67,915:58,916:83,917:67,918:67,919:83,920:92,921:33,922:75,923:75,924:100,925:83,926:75,927:92,928:83,929:67,930:108,931:67,932:75,933:75,934:83,935:75,936:83,937:92,938:33,939:75,940:83,941:58,942:75,943:42,944:67,945:83,946:67,947:67,948:67,949:58,950:75,951:75,952:67,953:42,954:67,955:67,956:75,957:67,958:67,959:67,960:92,961:67,962:67,963:75,964:67,965:67,966:92,967:67,968:92,969:100,970:42,971:67,972:67,973:67,974:100,975:108,976:58,977:75,978:75,979:100,980:75,981:92,982:100,983:67,984:92,985:67,986:75,987:58,988:58,989:58,990:67,991:58,992:75,993:92,994:100,995:92,996:75,997:58,998:75,999:58,1e3:75,1001:75,1002:67,1003:67,1004:83,1005:58,1006:50,1007:42,1008:67,1009:67,1010:58,1011:33,1012:92,1013:58,1014:58,1015:67,1016:67,1017:75,1018:100,1019:83,1020:58,1021:75,1022:75,1023:75,1024:67,1025:67,1026:92,1027:58,1028:75,1029:67,1030:33,1031:33,1032:42,1033:108,1034:108,1035:83,1036:75,1037:83,1038:75,1039:83,1040:75,1041:67,1042:67,1043:58,1044:83,1045:67,1046:92,1047:67,1048:83,1049:83,1050:75,1051:83,1052:100,1053:83,1054:92,1055:83,1056:67,1057:75,1058:75,1059:75,1060:83,1061:75,1062:83,1063:75,1064:108,1065:108,1066:75,1067:92,1068:67,1069:75,1070:108,1071:75,1072:67,1073:67,1074:58,1075:58,1076:75,1077:67,1078:83,1079:58,1080:75,1081:75,1082:67,1083:67,1084:83,1085:75,1086:67,1087:75,1088:75,1089:58,1090:58,1091:58,1092:92,1093:67,1094:75,1095:58,1096:92,1097:100,1098:67,1099:83,1100:58,1101:58,1102:92,1103:58,1104:67,1105:67,1106:75,1107:58,1108:58,1109:58,1110:33,1111:33,1112:42,1113:92,1114:92,1115:75,1116:67,1117:75,1118:58,1119:75,1120:100,1121:75,1122:75,1123:67,1124:83,1125:83,1126:75,1127:67,1128:100,1129:92,1130:92,1131:83,1132:117,1133:108,1134:67,1135:67,1136:83,1137:83,1138:92,1139:67,1140:83,1141:67,1142:83,1143:67,1144:133,1145:125,1146:92,1147:67,1148:100,1149:75,1150:100,1151:75,1152:75,1153:58,1154:75,1155:0,1156:0,1157:0,1158:0,1159:108,1160:0,1161:0,1162:83,1163:75,1164:67,1165:58,1166:67,1167:75,1168:58,1169:58,1170:67,1171:58,1172:75,1173:67,1174:100,1175:92,1176:67,1177:58,1178:75,1179:67,1180:83,1181:75,1182:75,1183:67,1184:83,1185:75,1186:83,1187:75,1188:100,1189:83,1190:117,1191:100,1192:92,1193:75,1194:75,1195:58,1196:75,1197:58,1198:75,1199:58,1200:75,1201:58,1202:75,1203:75,1204:100,1205:83,1206:75,1207:67,1208:75,1209:67,1210:75,1211:58,1212:92,1213:75,1214:92,1215:75,
1216:33,1217:92,1218:83,1219:75,1220:67,1221:83,1222:67,1223:83,1224:75,1225:83,1226:75,1227:75,1228:58,1229:100,1230:83,1231:25,1232:75,1233:67,1234:75,1235:67,1236:100,1237:100,1238:67,1239:67,1240:75,1241:67,1242:75,1243:67,1244:92,1245:83,1246:67,1247:58,1248:67,1249:58,1250:83,1251:75,1252:83,1253:75,1254:92,1255:67,1256:92,1257:67,1258:92,1259:67,1260:75,1261:58,1262:75,1263:58,1264:75,1265:58,1266:75,1267:58,1268:75,1269:58,1270:58,1271:42,1272:92,1273:83,1274:58,1275:42,1276:75,1277:58,1278:75,1279:58,2026:67,19977:108,65403:58},this._ELLIPSIS_LENGTH=new e("…").length,this._DOT_LENGTH=new e(".").length},e.em_snippet=function(t,r,o,n){void 0===n&&(n="HIGHLIGHTED_TRUNCATED_STRING_MIDDLE"),null==r&&(r=50),null==o&&(o=.75);var i=new e(t.toString());switch(n){case"HIGHLIGHTED_TRUNCATED_STRING_END":return i.snippet_end(r).toString();case"HIGHLIGHTED_TRUNCATED_STRING_START":return i.snippet_start(r).toString();case"HIGHLIGHTED_TRUNCATED_STRING_LAST_WORD":return i.snippet_last_word(r).toString();case"HIGHLIGHTED_TRUNCATED_STRING_FILE_EXTENSION":return i.snippet_file_extension(r).toString();case"HIGHLIGHTED_TRUNCATED_STRING_MIDDLE":default:return i.snippet(r,o).toString()}},e.prototype.widthInfo=function(){var e={};e[-1]=0;for(var t=0,r=this.s.length,o=0<=r;o?t<r:t>r;o?t++:t--)e[t]=e[t-1]+this.ems(this.s.charAt(t));return e},e.prototype.findSpot=function(e){var t;if(!e)return 0;for(var r=0,o=this.s.length;r<=o;){t=Math.floor(r/2+o/2);var n=this.info[t-1];if(n>e)o=t-1;else{if(!(n<e))return t;r=t+1}}return r>t?r:t},e.prototype.ems=function(t){var r=t.charCodeAt(0),o=e.CODEPOINT_TO_WIDTH[r];return o?o/Math.pow(10,e.ACCURACY):768<=r&&r<=879?0:65377<=r&&r<=65500?.58:11904<=r&&r<=40911||44032<=r&&r<=55215||4352<=r&&r<=4607||63744<=r&&r<=64255||65280<=r&&r<=65535||131072<=r&&r<=196607?1.08:.65},e.prototype.substr=function(t,r){var o=this.findSpot(t);if(null!=r){var n=this.findSpot(t+r);if(n-o<this.s.length){var i=this.s.charCodeAt(n-o);65024<=i&&i<=65039&&n--}return new e(this.s.substr(o,n-o))}return new e(this.s.substr(o))},e.prototype.toString=function(){return this.s},e.prototype.snippet=function(t,r){if(void 0===t&&(t=50),void 0===r&&(r=.75),this.length<=t)return this;t-=e._ELLIPSIS_LENGTH;var o=t*r,n=t-o,i=this.length-n,s=this.substr(0,o),a=this.substr(i);return new e(s.toString()+"…"+a.toString())},e.prototype.snippet_end=function(t){return void 0===t&&(t=50),this.length<=t?this:(t-=e._ELLIPSIS_LENGTH,new e(this.substr(0,t).toString()+"…"))},e.prototype.snippet_start=function(t){return void 0===t&&(t=50),this.length<=t?this:(t-=e._ELLIPSIS_LENGTH,new e("…"+this.substr(this.length-t,t).toString()))},e.prototype.snippet_last_word=function(t){if(void 0===t&&(t=50),this.length<=t)return this;var r=this.toString().trim().split(" "),o=r.pop(),n=new e(o).length;if(n>=t)return this.snippet(t);t-=e._ELLIPSIS_LENGTH;var i=t-n;return new e(this.substr(0,i).toString()+"…"+o)},e.prototype.snippet_file_extension=function(t){if(void 0===t&&(t=50),this.length<=t)return this;var r=this.toString().trim().split("."),o=r.pop(),n=new e(o).length;if(n>=t)return this.snippet(t);t-=e._ELLIPSIS_LENGTH;var i=t-n-e._DOT_LENGTH;return new e(this.substr(0,i).toString()+"…."+o)},e})();t.Emstring=r,r.initClass()}),define("retrieval-components/highlighted-truncated-string",["require","exports","tslib","tslib","classnames","react","spectrum/tooltip","retrieval-components/highlighted-truncated-string/em-string","retrieval-components/highlighted-truncated-string/text-highlights"],function(e,t,r,o,n,i,s,a,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),n=r.__importDefault(n),i=r.__importStar(i);var c=(function(e){function t(t){var r=e.call(this,t)||this;return r.setRef=function(e){r.textContainerSpan=e},r.updateDisplayTextIfNecessary=function(e){if(r.textContainerSpan){var t=e.fontSize,o=e.text,n=e.availableWidth,i=e.cellBuffer,s=e.variant,l=r.textContainerSpan,c=n?n:l.getBoundingClientRect().width;if(r.props.text!==o||r.state.cellWidth!==c||r.props.fontSize!==t||r.props.variant!==s){r.setState({cellWidth:c});var d=c/t-i,u=a.Emstring.em_snippet(o,d,.5,s);u!==r.state.truncatedText&&r.setState({truncatedText:u}),r.updateTooltip(u,o)}}},r.updateTooltip=function(e,t){e&&t&&r.setState({showTooltip:e!==t})},r.state={truncatedText:t.text,showTooltip:!1},r}return o.__extends(t,e),t.prototype.componentDidMount=function(){this.updateDisplayTextIfNecessary(this.props)},t.prototype.componentWillReceiveProps=function(e){this.updateDisplayTextIfNecessary(e)},t.prototype.render=function(){var e=this.props,t=e.className,r=e.ariaLabel,o=e.highlightSpans,a=e.text,c=e.tooltipPosition,d=e.tooltipId,u=this.state,p=u.truncatedText,f=u.showTooltip;return i.createElement(s.Tooltip,{id:d,positioning:c,tooltipContent:o?l.generateHighlightedTooltipSpans(l.highlightSectionsFromHighlightSpans(a,o)):a,showOnMouseMove:f,wrapperClassName:"rc-truncated-string__tooltip"},i.createElement("span",{className:n.default(t,"rc-hl-truncated-string__container"),"aria-label":r,ref:this.setRef,style:{display:"block"}},o?this.getHighlightedSpan(p,a,o):p))},t.prototype.splitTruncatedParts=function(e,t){for(var r=0;r<e.length&&e.charAt(r)===t.charAt(r);)++r;return r===e.length||"…"!==e.charAt(r)?[e]:[e.substring(0,r),e.substring(r+1)]},t.prototype.getHighlightedSpan=function(e,t,r){var o=this.splitTruncatedParts(e,t);if(1===o.length)return l.highlightReactFromHighlightSpans(e,r);var n=l.highlightReactFromHighlightSpans(t,r,0,o[0].length),s=l.highlightReactFromHighlightSpans(t,r,t.lastIndexOf(o[1])),a=l.highlightEllipsisFromHighlightSpans(o[0].length+1,t.lastIndexOf(o[1])-1,r);return i.createElement("span",null,n,a,s)},t.defaultProps={tooltipPosition:"above",cellBuffer:1,variant:"HIGHLIGHTED_TRUNCATED_STRING_MIDDLE"},t})(i.PureComponent);t.HighlightedTruncatedString=c}),define("retrieval-components/highlighted-truncated-string/text-highlights",["require","exports","tslib","classnames","react"],function(e,t,r,o,n){"use strict";function i(e,t,r,o){if(r||(r=0),void 0===o&&(o=e.length),!t||!c(e,t))return[{isHighlighted:!1,text:e.substring(r,o)}];for(var n=[],i=0,s=0,a=t;s<a.length;s++){var l=a[s],d=e.indexOf(l.string,i),u=d+l.string.length;if(i=u,!(d<r&&u<=r||d>=o)){var p=l.string;d<r&&(p=p.slice(r-d)),o<u&&(p=p.slice(0,-(u-o))),n.push({text:p,isHighlighted:l.isHighlighted})}}return n}function s(e,t,r,o){return d(i(e,t,r,o))}function a(e,t,r){return n.createElement("span",{className:o.default({"rc-hl-truncated-string__highlight":l(e,t,r)})},"…")}function l(e,t,r){if(!r)return!1;for(var o=0,n=0,i=r;n<i.length;n++){var s=i[n],a=o+s.string.length-1;if(s.isHighlighted&&a>=e&&o<=t)return!0;o=a+1}return!1}function c(e,t){return e===t.map(function(e){return e.string}).join("")}function d(e){return n.createElement("span",null,e.map(function(e,t){return n.createElement("span",{className:o.default({"rc-hl-truncated-string__highlight":e.isHighlighted}),key:t},e.text)}))}function u(e){return n.createElement("span",null,e.map(function(e,t){return n.createElement("span",{className:o.default({"rc-hl-truncated-string__tooltip-highlight":e.isHighlighted}),key:t},e.text)}))}Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importDefault(o),n=r.__importStar(n);t.highlightSectionsFromHighlightSpans=i,t.highlightReactFromHighlightSpans=s,t.highlightEllipsisFromHighlightSpans=a,t.generateHighlightedTooltipSpans=u}),define("spectrum/icon_mode/bundle",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ICONS={grid:{attrs:{width:"24",height:"24",viewBox:"0 0 24 24"},dangerouslySetInnerIconHtml:'<g fill="#637282" fill-rule="evenodd"><path d="M7 7h2v2H7zM11 7h2v2h-2zM15 7h2v2h-2zM7 11h2v2H7zM11 11h2v2h-2zM15 11h2v2h-2zM7 15h2v2H7zM11 15h2v2h-2zM15 15h2v2h-2z"></path></g>'},list:{attrs:{width:"24",height:"24",viewBox:"0 0 24 24"},dangerouslySetInnerIconHtml:'<g fill="#637282" fill-rule="evenodd"><path d="M6 15h2v2H6zM10 15h8v2h-8zM6 11h2v2H6zM10 11h8v2h-8zM6 7h2v2H6zM10 7h8v2h-8z"></path></g>'},tiles:{attrs:{width:"24",height:"24",viewBox:"0 0 24 24"},dangerouslySetInnerIconHtml:'<g fill="#637282" fill-rule="evenodd"><path d="M7 7h4v4H7zM13 7h4v4h-4zM13 13h4v4h-4zM7 13h4v4H7z"></path></g>'}}}),define("spectrum/icon_mode",["require","exports","tslib","tslib","react","spectrum/icon_templates/stateless","spectrum/svg_icon_bundle","spectrum/icon_mode/bundle"],function(e,t,r,o,n,i,s,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o=r.__importStar(o),n=r.__importStar(n),t.ICONS=a.ICONS,t.IconMode=function(e){var t=e.name,r=n.createElement(s.SvgIconBundle,{focusable:"false",icon:a.ICONS[t]});return n.createElement(i.Component,o.__assign({icon:r},e))},t.IconMode.displayName="IconMode"});
//# sourceMappingURL=pkg-browse.min.js-vfl1fTQ1F.map